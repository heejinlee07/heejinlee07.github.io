<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"heejinlee07.github.io","root":"/","scheme":"Muse","version":"7.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Today I Learned">
<meta property="og:type" content="website">
<meta property="og:title" content="Heejin">
<meta property="og:url" content="https://heejinlee07.github.io/page/3/index.html">
<meta property="og:site_name" content="Heejin">
<meta property="og:description" content="Today I Learned">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Heejin Lee">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://heejinlee07.github.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>Heejin</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Heejin</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Front-end Developer</p>
  </div>

  <div class="site-nav-right"></div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/12/19/211220_mui/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/19/211220_mui/" class="post-title-link" itemprop="url">MUI v4에서 v5로 마이그레이션 하기</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-20 00:00:00" itemprop="dateCreated datePublished" datetime="2021-12-20T00:00:00+09:00">2021-12-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-16 15:45:41" itemprop="dateModified" datetime="2022-05-16T15:45:41+09:00">2022-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문 링크: <a href="https://mui.com/guides/migration-v4/" target="_blank" rel="noopener">https://mui.com/guides/migration-v4/</a></p>
</blockquote>
<h2 id="v4-에서-v5로-마이그레이션하기"><a href="#v4-에서-v5로-마이그레이션하기" class="headerlink" title="v4 에서 v5로 마이그레이션하기"></a>v4 에서 v5로 마이그레이션하기</h2><aside>
💡 왜 마이그레이션 해야할까 ? ➡️   [https://mui.com/blog/mui-core-v5/](https://mui.com/blog/mui-core-v5/)

</aside>

<aside>
💡 문제 발생시 여기로  ➡️  [https://mui.com/guides/migration-v4/#troubleshooting](https://mui.com/guides/migration-v4/#troubleshooting)

</aside>

<hr>
<h2 id="마이그레이션-해야-하는-이유"><a href="#마이그레이션-해야-하는-이유" class="headerlink" title="마이그레이션 해야 하는 이유"></a>마이그레이션 해야 하는 이유</h2><p>버그 수정 및 새로운 스타일링 엔진과 같은 여러 개선사항의 이점을 얻으려면 마이그레이션 해야한다.</p>
<h2 id="마이그레이션-단계"><a href="#마이그레이션-단계" class="headerlink" title="마이그레이션 단계"></a>마이그레이션 단계</h2><h2 id="React-또는-TypeScript-버전-업데이트"><a href="#React-또는-TypeScript-버전-업데이트" class="headerlink" title="React 또는 TypeScript 버전 업데이트"></a>React 또는 TypeScript 버전 업데이트</h2><ul>
<li>React 최소지원버전: v16.8.0 to v17.0.0.</li>
<li>TypeScript 최소지원버전: v3.2 to v3.5.</li>
</ul>
<h2 id="ThemeProvider-setup"><a href="#ThemeProvider-setup" class="headerlink" title="ThemeProvider setup"></a>ThemeProvider setup</h2><p>v5로 업그레이드 전에 <code>ThemeProvider</code> 가 당신의 어플리케이션의 root에 정의되어 있고(default theme를 사용한다고 하더라도) <code>useStyles</code> 가 <code>&lt;ThemeProvider&gt;</code> 전에 호출되진 않았는지 확인해 본다. 그 이유는 임시로 <code>@mui/styles</code> (JSS style-engine)을 사용해야 하는데, 이것이 <code>ThemeProvider</code> 를 요구한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  ThemeProvider,</span><br><span class="line">  createMuiTheme,</span><br><span class="line">  makeStyles</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'@material-ui/core/styles'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> theme = createMuiTheme()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useStyles = makeStyles(<span class="function"><span class="params">theme</span> =&gt;</span> &#123;</span><br><span class="line">  root: &#123;</span><br><span class="line">    <span class="comment">// some CSS that access to theme</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> classes = useStyles() <span class="comment">// ❌ If you have this, consider moving it inside a component that wrapped with &lt;ThemeProvider&gt;</span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ThemeProvider</span> <span class="attr">theme</span>=<span class="string">&#123;theme&#125;</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">ThemeProvider</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="MUI-버전-업데이트"><a href="#MUI-버전-업데이트" class="headerlink" title="MUI 버전 업데이트"></a>MUI 버전 업데이트</h2><p>v5 버전의 MUI core를 사용하려면 먼저 패키지 네임을 업데이트해야 한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install @mui/material @mui/styles</span><br><span class="line"></span><br><span class="line"><span class="comment">// or with `yarn`</span></span><br><span class="line">yarn add @mui/material @mui/styles</span><br></pre></td></tr></table></figure>
<p>만약 아래와 같은 패키지가 이미 있는 경우 새 패키지를 별도로 설치해라</p>
<ul>
<li><code>@material-ui/lab</code> →  <code>@mui/lab</code></li>
<li><p><code>@material-ui/icons</code> → <code>@mui/icons-material</code></p>
</li>
<li><p>모든 변경된 패키지 리스트 보기</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@material-ui/core -&gt; @mui/material</span><br><span class="line">@material-ui/system -&gt; @mui/system</span><br><span class="line">@material-ui/unstyled -&gt; @mui/base</span><br><span class="line">@material-ui/styles -&gt; @mui/styles</span><br><span class="line">@material-ui/icons -&gt; @mui/icons-material</span><br><span class="line">@material-ui/lab -&gt; @mui/lab</span><br><span class="line">@material-ui/types -&gt; @mui/types</span><br><span class="line">@material-ui/styled-engine -&gt; @mui/styled-engine</span><br><span class="line">@material-ui/styled-engine-sc -&gt;@mui/styled-engine-sc</span><br><span class="line">@material-ui/private-theming -&gt; @mui/private-theming</span><br><span class="line">@material-ui/codemod -&gt; @mui/codemod</span><br><span class="line">@material-ui/docs -&gt; @mui/docs</span><br><span class="line">@material-ui/envinfo -&gt; @mui/envinfo</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>org 또는 패키지 이름이 <code>@material-ui</code>에서 <code>@mui</code>로 변경된 것은 리브랜딩의 일환이다. 자세한 내용은 <a href="https://mui.com/blog/material-ui-is-now-mui/" target="_blank" rel="noopener">블로그</a> 포스트 또는 <a href="https://github.com/mui-org/material-ui/discussions/27803" target="_blank" rel="noopener">#27803</a>을 확인한다.</p>
<p>그 다음으로는 새로운 종속 디펜던시인 이모션 패키지를 설치해야 한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm install @emotion/react @emotion/styled</span><br><span class="line"></span><br><span class="line"><span class="comment">// or with `yarn`</span></span><br><span class="line">yarn add @emotion/react @emotion/styled</span><br></pre></td></tr></table></figure>
<p>만약 MUI Core v5를 emotion 대신 styled-components와 함께 사용하고 싶다면 <a href="https://mui.com/getting-started/installation/#npm" target="_blank" rel="noopener">설치 가이드</a>를 확인한다.</p>
<p>만약 <code>@material-ui/pickers</code>를 사용중이라면 이것은 <code>@mui/lab</code>으로 이동했다. <a href="https://mui.com/guides/migration-v4/#material-ui-pickers" target="_blank" rel="noopener">이 링크</a>를 통해 <code>@mui/lab</code>으로 마이그레이션 하는 다음 단계를 확인할 수 있다.</p>
<p>지금쯤 <code>@mui/styles</code>를 설치했어야 한다. 여기에는 emotion을 복제하는 JSS를 포함하고 있다. 이는 v5로의 점진적인 마이그레이션을 허용하기 위한 것이다. <a href="https://mui.com/guides/migration-v4/#migrate-from-jss" target="_blank" rel="noopener">다음 단계</a>에 따라 종속성을 제거할 수 있도록 한다.</p>
<blockquote>
<p>어플리케이션이 에러없이 잘 실행되고 있는지 확인하고, 다음 단계를 이어가기 전에 변경 사항을 커밋하도록 한다.</p>
</blockquote>
<p>어플리케이션이 완전히 MUI v5로 마이그레이션 되면 이전의 <code>@material-ui/*</code> 패키지를 <code>yarn remove</code> 또는 <code>npm install</code>로 제거할 수 있다.</p>
<hr>
<h2 id="codemod-실행"><a href="#codemod-실행" class="headerlink" title="codemod 실행"></a>codemod 실행</h2><p>마이그레이션을 쉽게 할 수 있도록 codemod를 준비했다.</p>
<h3 id="preset-safe"><a href="#preset-safe" class="headerlink" title="preset-safe"></a>preset-safe</h3><p>이 codemod에는 마이그레이션에 유용한 대부분의 transformer가 포함되어 있다. (이 codemod는 폴더당 한 번만 적용될 수 있도록 한다.)</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx @mui/codemod v5<span class="number">.0</span><span class="number">.0</span>/preset-safe &lt;path&gt;</span><br></pre></td></tr></table></figure>
<p>이 codemode를 일대일로 하나씩 실행하려면 <a href="https://github.com/mui-org/material-ui/blob/master/packages/mui-codemod/README.md#-preset-safe" target="_blank" rel="noopener">preset-safe codemod</a>에서 상세 내용을 확인한다.</p>
<h3 id="variant-prop"><a href="#variant-prop" class="headerlink" title="variant-prop"></a>variant-prop</h3><p>어떠한 variant도 정의되지 않았다면 (default variant는 v4 standard에서 v5 outlined로 변경되었다.)<code>&lt;TextField/&gt;</code>, <code>&lt;FormControl/&gt;</code>, <code>&lt;Select/&gt;</code> 등의 컴포넌트에 variant=”standard”를 적용하여 변환할 수 있다.</p>
<aside>
💡 이미 default로 variant:”outlined”를 theme에 사용했다면 이 codemode를 사용해서는 안된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// if you have theme setup like this, ❌ don't run this codemod.</span></span><br><span class="line"><span class="comment">// these default props can be removed later because `outlined` is the default value in v5</span></span><br><span class="line">createMuiTheme(&#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    MuiTextField: &#123;</span><br><span class="line">      defaultProps: &#123;</span><br><span class="line">        variant: <span class="string">'outlined'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>만약 variant=”standard” 를 컴포넌트에서 유지하고 싶다면, 이 codemod를 실행하거나 theme default props를 구성한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx @mui/codemod v5<span class="number">.0</span><span class="number">.0</span>/variant-prop &lt;path&gt;</span><br></pre></td></tr></table></figure>
<p>자세한 내용은 <a href="https://github.com/mui-org/material-ui/blob/master/packages/mui-codemod/README.md#variant-prop" target="_blank" rel="noopener">variant-prop codemod</a>를 확인한다.</p>
<h3 id="link-underline-hover"><a href="#link-underline-hover" class="headerlink" title="link-underline-hover"></a>link-underline-hover</h3><p>underliner prop이 정의되지 않았다면 <Link/> 컴포넌트에 underline=”hover”를 적용하면 변환할 수 있다. (default underline은 v4 “hover”에서 v5 “always”로 변경되었다.)</p>
<aside>
💡 이미 default로 underline:”always”를 theme에 사용했다면 이 codemode를 사용해서는 안된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// if you have theme setup like this, ❌ don't run this codemod.</span></span><br><span class="line"><span class="comment">// this default props can be removed later because `always` is the default value in v5</span></span><br><span class="line">createMuiTheme(&#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    MuiLink: &#123;</span><br><span class="line">      defaultProps: &#123;</span><br><span class="line">        underline: <span class="string">'always'</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>만약 variant=”hover” 를 컴포넌트에서 유지하고 싶다면, 이 codemod를 실행하거나 theme default props를 구성한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx @mui/codemod v5<span class="number">.0</span><span class="number">.0</span>/link-underline-hover &lt;path&gt;</span><br></pre></td></tr></table></figure>
<p>자세한 내용은 <a href="https://github.com/mui-org/material-ui/blob/master/packages/mui-codemod/README.md#link-underline-hover" target="_blank" rel="noopener">link-underline-hover codemod</a>에서 확인한다.</p>
<p>codemod 단계를 일단 완료했다면 어플리케이션을 다시 실행해본다. 이때 에러없이 실행되어야 한다. 그렇지 않을 경우 <a href="https://mui.com/guides/migration-v4/#troubleshooting" target="_blank" rel="noopener">troubleshooting</a> 섹션을 확인해본다. 다음 단계는 각 컴포넌트의 주요 변경사항을 처리하는 것이다.</p>
<hr>
<h2 id="Handling-breaking-changes"><a href="#Handling-breaking-changes" class="headerlink" title="Handling breaking changes"></a>Handling breaking changes</h2><h3 id="지원되는-브라우저-및-노드-버전"><a href="#지원되는-브라우저-및-노드-버전" class="headerlink" title="지원되는 브라우저 및 노드 버전"></a>지원되는 브라우저 및 노드 버전</h3><p>default 번들의 타겟이 변경되었다. 정확한 버전은 browserslist query가 릴리즈 될 때 고정된다.</p>
<p><code>&quot;&gt; 0.5%, last 2 versions, Firefox ESR, not dead, not IE 11, maintained node versions&quot;</code></p>
<p>기존 번들은 아래와 같은 최소 버전을 지원한다.</p>
<ul>
<li>Node 12 (up from 8)</li>
<li>Chrome 90 (up from 49)</li>
<li>Edge 91 (up from 14)</li>
<li>Firefox 78 (up from 52)</li>
<li>Safari 14 (macOS) and 12.5 (iOS) (up from 10)</li>
<li>and more (see <a href="https://github.com/mui-org/material-ui/blob/HEAD/.browserslistrc#L11" target="_blank" rel="noopener">.browserslistrc (<code>stable</code> entry)</a>)</li>
</ul>
<p>더이상 IE 11을 지원하지 않기 때문에 IE 11을 지원해야 하는 경우는 <a href="https://mui.com/guides/minimizing-bundle-size/#legacy-bundle" target="_blank" rel="noopener">lagacy bundle</a>를 확인한다.</p>
<h3 id="non-ref-forwarding-class-components"><a href="#non-ref-forwarding-class-components" class="headerlink" title="non-ref-forwarding class components"></a>non-ref-forwarding class components</h3><p>component prop의 non-ref-forwarding class components 또는 immediate children의 지원이 중단되었다. 만약 unstable_createStrictModeTheme를 사용하고 있거나 React.StrictMode의 <code>findDOMNode</code> 과 관련된 어떠한 경고도 표시되지 않았다면 아무런 작업도 수행할 필요가 없다. 그렇지 않다면 <a href="https://mui.com/guides/composition/#caveat-with-refs" target="_blank" rel="noopener">Caveat with refs</a> 섹션에서 어떻게 마이그레이션 해야하는지 알아볼 필요가 있다. 이 변경 사항은 component prop를 사용하는 곳이나 children을 element로 필요로 하기 때문에 children을 components에 전달해야 하는 거의 모든 components에 영향을 미친다. (예를 들어, <MenuList><CustomMenuItem /></MenuList>)</p>
<h3 id="style-library"><a href="#style-library" class="headerlink" title="style library"></a>style library</h3><p>v5에서 default로 사용하는 스타일 라이브러리는 <code>[emotion](https://github.com/emotion-js/emotion)</code>이다. JSS에서 emotion으로 마이그레이션 하는 동안 components에 JSS style을 사용하여 override하는 경우 (예를 들자면 makeStyles 통해 override하는 경우) CSS 삽입 순서 (CSS injection order)를 신경써야 한다. 이렇게 하려면 <code>StyledEngineProvider</code> 와 <code>injectFirst</code> 옵션이 <strong>컴포넌트 tree의 가장 최상단에 위치해야 한다.</strong></p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//예시</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; StyledEngineProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">GlobalCssPriority</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &#123;<span class="comment">/* Inject emotion before JSS */</span>&#125;</span><br><span class="line">    &lt;StyledEngineProvider injectFirst&gt;</span><br><span class="line">      &#123;<span class="comment">/* Your component tree. Now you can override MUI's styles. */</span>&#125;</span><br><span class="line">    &lt;<span class="regexp">/StyledEngineProvider&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<aside>
💡 emotion을 통해 app에 스타일을 지정하고, 커스텀 캐시가 있는 경우에 MUI에 의해 제공되는 캐시는 무시된다. injection order를 올바르게 하려면 `prepend` 옵션을 `createCache`에 추가해야 한다.  
이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//예시</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"> <span class="keyword">import</span> &#123; CacheProvider &#125; <span class="keyword">from</span> <span class="string">'@emotion/react'</span>;</span><br><span class="line"> <span class="keyword">import</span> createCache <span class="keyword">from</span> <span class="string">'@emotion/cache'</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">const</span> cache = createCache(&#123;</span><br><span class="line">   key: <span class="string">'css'</span>,</span><br><span class="line">+  prepend: <span class="literal">true</span>,</span><br><span class="line"> &#125;);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">PlainCssPriority</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> (</span><br><span class="line">     &lt;CacheProvider value=&#123;cache&#125;&gt;</span><br><span class="line">       &#123;<span class="comment">/* Your component tree. Now you can override MUI's styles. */</span>&#125;</span><br><span class="line">     &lt;<span class="regexp">/CacheProvider&gt;</span></span><br><span class="line"><span class="regexp">   );</span></span><br><span class="line"><span class="regexp"> &#125;</span></span><br></pre></td></tr></table></figure>
<p>styled-components를 사용 중이고, 커스텀 타겟이 있는 StyleSheetManager를 사용중이라면 타겟이 HTML <head> 엘리먼트의 첫번 째 요소인지 확인한다. 어떻게 이것을 수행하는지 확인하려면 <code>@mui/styled-engine-sc</code> package에 있는 <code>[StyledEngineProvider</code> implementation](<a href="https://github.com/mui-org/material-ui/blob/master/packages/mui-styled-engine-sc/src/StyledEngineProvider/StyledEngineProvider.js)을" target="_blank" rel="noopener">https://github.com/mui-org/material-ui/blob/master/packages/mui-styled-engine-sc/src/StyledEngineProvider/StyledEngineProvider.js)을</a> 살펴본다.</p>
<h3 id="Theme-structure"><a href="#Theme-structure" class="headerlink" title="Theme structure"></a>Theme structure</h3><p>theme 구조는 v5에서 변경되었기 때문에 변경된 형태로 업데이트 해야 한다. 원활한 전환을 위해서 <code>adaptV4Theme</code>를 사용해서 일부 테마의 변경된 사항을 새로운 테마 구조로 반복적으로 업그레이드 할 수 있다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; createMuiTheme &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; createTheme, adaptV4Theme &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line">-<span class="keyword">const</span> theme = createMuiTheme(&#123;</span><br><span class="line">+<span class="keyword">const</span> theme = createTheme(adaptV4Theme(&#123;</span><br><span class="line">   <span class="comment">// v4 theme</span></span><br><span class="line">-&#125;);</span><br><span class="line">+&#125;));</span><br></pre></td></tr></table></figure>
<aside>
💡 이 adapter는 creatTheme의 input arguements만 처리하기 때문에 테마 생성 후 구조를 수정하고자 할 때는 수동으로 업데이트 해야한다.

</aside>

<p>adapther는 다음의 변경 사항을 지원한다.</p>
<ul>
<li>“gutters” abstraction은 가치가 있다고 생각될 만큼 자주 사용되지 않는다고 입증되었다.</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-theme.mixins.gutters(),</span><br><span class="line">+paddingLeft: theme.spacing(<span class="number">2</span>),</span><br><span class="line">+paddingRight: theme.spacing(<span class="number">2</span>),</span><br><span class="line">+[theme.breakpoints.up(<span class="string">'sm'</span>)]: &#123;</span><br><span class="line">+  paddingLeft: theme.spacing(<span class="number">3</span>),</span><br><span class="line">+  paddingRight: theme.spacing(<span class="number">3</span>),</span><br><span class="line">+&#125;,</span><br></pre></td></tr></table></figure>
<ul>
<li><code>theme.spacing</code> 은 이제 default로 px 유닛과 단일 값을 반환한다. 이는 styled-compontnts와 emotion의 통합을 개선한다.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">이는 &#96;theme.spacing&#96;이 template string로 호출되던 것으로부터 &#39;px&#39; 접미사를 제거해서</span><br><span class="line">[preset-safe codemod](https:&#x2F;&#x2F;mui.com&#x2F;guides&#x2F;migration-v4&#x2F;#preset-safe)에서 처리된다.</span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//before</span></span><br><span class="line">theme.spacing(<span class="number">2</span>) =&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//after</span></span><br><span class="line">theme.spacing(<span class="number">2</span>) =&gt; <span class="string">'16px'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>이 기능을 설명하는 데 일반적으로 사용되는 “dark mode”라는 용어를 더 잘 따르기 위해서 <code>theme.palette.type</code> 키는 <code>theme.palette.mode</code> 로 이름이 변경되었다.</li>
</ul>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createTheme &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">-<span class="keyword">const</span> theme = createTheme(&#123;<span class="attr">palette</span>: &#123; <span class="attr">type</span>: <span class="string">'dark'</span> &#125;&#125;),</span><br><span class="line">+<span class="keyword">const</span> theme = createTheme(&#123;<span class="attr">palette</span>: &#123; <span class="attr">mode</span>: <span class="string">'dark'</span> &#125;&#125;),</span><br></pre></td></tr></table></figure>
<ul>
<li>default <code>[theme.palette.info](http://theme.palette.info)</code> 색상은 라이트, 다크 모드 모두에서 AA 표준 명암비를 통과하도록 변경되었다.</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">info = &#123;</span><br><span class="line">-  main: cyan[<span class="number">500</span>],</span><br><span class="line">+  main: lightBlue[<span class="number">700</span>], <span class="comment">// lightBlue[400] in "dark" mode</span></span><br><span class="line"></span><br><span class="line">-  light: cyan[<span class="number">300</span>],</span><br><span class="line">+  light: lightBlue[<span class="number">500</span>], <span class="comment">// lightBlue[300] in "dark" mode</span></span><br><span class="line"></span><br><span class="line">-  dark: cyan[<span class="number">700</span>],</span><br><span class="line">+  dark: lightBlue[<span class="number">900</span>], <span class="comment">// lightBlue[700] in "dark" mode</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>default <code>theme.palette.succeess</code> 색상은 색상은 라이트, 다크 모드 모두에서 AA 표준 명암비를 통과하도록 변경되었다.</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">success = &#123;</span><br><span class="line">-  main: green[<span class="number">500</span>],</span><br><span class="line">+  main: green[<span class="number">800</span>], <span class="comment">// green[400] in "dark" mode</span></span><br><span class="line"></span><br><span class="line">-  light: green[<span class="number">300</span>],</span><br><span class="line">+  light: green[<span class="number">500</span>], <span class="comment">// green[300] in "dark" mode</span></span><br><span class="line"></span><br><span class="line">-  dark: green[<span class="number">700</span>],</span><br><span class="line">+  dark: green[<span class="number">900</span>], <span class="comment">// green[700] in "dark" mode</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>default <code>theme.palette.warning</code> 색상은 색상은 라이트, 다크 모드 모두에서 AA 표준 명암비를 통과하도록 변경되었다.</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">warning = &#123;</span><br><span class="line">-  main: orange[<span class="number">500</span>],</span><br><span class="line">+  main: <span class="string">"#ED6C02"</span>, <span class="comment">// orange[400] in "dark" mode</span></span><br><span class="line"></span><br><span class="line">-  light: orange[<span class="number">300</span>],</span><br><span class="line">+  light: orange[<span class="number">500</span>], <span class="comment">// orange[300] in "dark" mode</span></span><br><span class="line"></span><br><span class="line">-  dark: orange[<span class="number">700</span>],</span><br><span class="line">+  dark: orange[<span class="number">900</span>], <span class="comment">// orange[700] in "dark" mode</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>default <code>theme.palette.text.hint</code> 키는 MUI components에서는 사용되지 않기 때문에 제거되었다. 만약 dependency를 가지고 있다면 뒤에 아래 예시와 같은 내용을 덧붙이도록 한다.</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createTheme &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line">-<span class="keyword">const</span> theme = createTheme(),</span><br><span class="line">+<span class="keyword">const</span> theme = createTheme(&#123;</span><br><span class="line">+  palette: &#123; <span class="attr">text</span>: &#123; <span class="attr">hint</span>: <span class="string">'rgba(0, 0, 0, 0.38)'</span> &#125; &#125;,</span><br><span class="line">+&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>theme의 components 정의는 어떠한 관련된 component에서도 정의를 쉽게 찾아볼 수 있도록 compontns key 아래에 새롭게 구성되었다.</li>
</ul>
<ol>
<li><code>prop</code></li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createTheme &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">const</span> theme = createTheme(&#123;</span><br><span class="line">-  props: &#123;</span><br><span class="line">-    MuiButton: &#123;</span><br><span class="line">-      disableRipple: <span class="literal">true</span>,</span><br><span class="line">-    &#125;,</span><br><span class="line">-  &#125;,</span><br><span class="line">+  components: &#123;</span><br><span class="line">+    MuiButton: &#123;</span><br><span class="line">+      defaultProps: &#123;</span><br><span class="line">+        disableRipple: <span class="literal">true</span>,</span><br><span class="line">+      &#125;,</span><br><span class="line">+    &#125;,</span><br><span class="line">+  &#125;,</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure>
<ol>
<li><code>overrides</code></li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createTheme &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">const</span> theme = createTheme(&#123;</span><br><span class="line">-  overrides: &#123;</span><br><span class="line">-    MuiButton: &#123;</span><br><span class="line">-      root: &#123; <span class="attr">padding</span>: <span class="number">0</span> &#125;,</span><br><span class="line">-    &#125;,</span><br><span class="line">-  &#125;,</span><br><span class="line">+  components: &#123;</span><br><span class="line">+    MuiButton: &#123;</span><br><span class="line">+      styleOverrides: &#123;</span><br><span class="line">+        root: &#123; <span class="attr">padding</span>: <span class="number">0</span> &#125;,</span><br><span class="line">+      &#125;,</span><br><span class="line">+    &#125;,</span><br><span class="line">+  &#125;,</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Styles"><a href="#Styles" class="headerlink" title="Styles"></a>Styles</h3><ul>
<li>기능을 더 잘 나타내기 위해 <code>fade</code> 에서 <code>alpha</code> 로 이름이 변경되었다. 이전의 이름은 입력 색상 값에 이미 alpha값이 있을 때 혼동을 야기했다. helper는 색상의 alpha 값을 override 한다.</li>
</ul>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- <span class="keyword">import</span> &#123; fade &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+ <span class="keyword">import</span> &#123; alpha &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> classes = makeStyles(<span class="function"><span class="params">theme</span> =&gt;</span> (&#123;</span><br><span class="line">-  backgroundColor: fade(theme.palette.primary.main, theme.palette.action.selectedOpacity),</span><br><span class="line">+  backgroundColor: alpha(theme.palette.primary.main, theme.palette.action.selectedOpacity),</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<ul>
<li><code>createStyles</code> 함수는 <code>@mui/material/styles</code> 에서 export 되는 것에서 <code>@mui/styles</code> 에서 export되는 것으로 변경되었다. 디펜던시를 core 패키지의 <code>@mui/styles</code> 로 이동시키는 것이 필요하다.</li>
</ul>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; createStyles &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; createStyles &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="mui-styles"><a href="#mui-styles" class="headerlink" title="@mui/styles"></a>@mui/styles</h3><h3 id="ThemeProvider"><a href="#ThemeProvider" class="headerlink" title="ThemeProvider"></a>ThemeProvider</h3><p><code>@mui/styles</code> 와 <code>@mui/material</code>를 함께 사용한다면, <code>ThemeProvider</code> 를 <code>@mui/material/styles</code>에서 export 되던 것을 <code>@mui/styles</code>에서 export 되도록 변경해야 한다. 이 방법은 <code>@mui/styles</code>에서 export된 스타일링 유틸리티인 makeStyles, withStyles 등과 MUI component에서 context에서 제공되는 theme가 모두 사용되도록 할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; ThemeProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; ThemeProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="Default-Theme-TypeScript"><a href="#Default-Theme-TypeScript" class="headerlink" title="Default Theme (TypeScript)"></a>Default Theme (TypeScript)</h3><p><code>@mui/styles</code> 패키지는 더이상 <code>@mui/material/styles</code> 의 일부가 아니다. <code>@mui/styles</code>를 <code>@mui/material</code> 과 함께 사용하는 경우에 DefaultTheme에 대해 모듈을 추가하여 적용해야 한다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in the file where you are creating the theme (invoking the function `createTheme()`)</span></span><br><span class="line"><span class="keyword">import</span> &#123; Theme &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line">declare <span class="built_in">module</span> <span class="string">'@mui/styles'</span> &#123;</span><br><span class="line">  interface DefaultTheme extends Theme &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="mui-material-colors"><a href="#mui-material-colors" class="headerlink" title="@mui/material/colors"></a>@mui/material/colors</h3><ul>
<li>1 레벨 이상의 중첩된 import는 private이다. <code>@mui/material/colors/red</code> 에서 색상을 가져올 수 없다.</li>
</ul>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> red <span class="keyword">from</span> <span class="string">'@mui/material/colors/red'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; red &#125; <span class="keyword">from</span> <span class="string">'@mui/material/colors'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="mui-material-styles"><a href="#mui-material-styles" class="headerlink" title="@mui/material/styles"></a>@mui/material/styles</h3><h3 id="createGenerateClassName"><a href="#createGenerateClassName" class="headerlink" title="createGenerateClassName"></a>createGenerateClassName</h3><p><code>createGenerateClassName</code> 함수는 더이상 <code>@mui/material/styles</code>에서 export되지 않는다. <code>@mui/styles</code>에서 직접 import해야 한다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; createGenerateClassName &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; createGenerateClassName &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br></pre></td></tr></table></figure>
<p>@mui/styles를 사용하지 않고 커스텀 클래스네임을 생성하려면 <a href="https://mui.com/guides/classname-generator/" target="_blank" rel="noopener">ClassNameGenerator</a>에서 세부내용을 확인한다.</p>
<h3 id="createMuiTheme"><a href="#createMuiTheme" class="headerlink" title="createMuiTheme"></a>createMuiTheme</h3><p><code>createMuiTheme</code> 함수는 <code>ThemeProvider</code>를 좀더 직관적으로 사용할 수 있도록 하기 위해서 <code>createTheme</code>로 이름이 변경되었다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; createMuiTheme &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; createTheme &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line">-<span class="keyword">const</span> theme = createMuiTheme(&#123;</span><br><span class="line">+<span class="keyword">const</span> theme = createTheme(&#123;</span><br></pre></td></tr></table></figure>
<h3 id="jssPreset"><a href="#jssPreset" class="headerlink" title="jssPreset"></a>jssPreset</h3><ul>
<li><code>jssPreset</code> 객체는 더이상 <code>@mui/material/styles</code> 에서 export되지 않는다. <code>@mui/styles</code>에서 바로 import해서 사용해야 한다.</li>
</ul>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; jssPreset &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; jssPreset &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="makeStyles"><a href="#makeStyles" class="headerlink" title="makeStyles"></a>makeStyles</h3><ul>
<li><code>makeStyles</code> JSS 유틸리티는 더이상 <code>@mui/material/styles</code> 에서 export되지 않기 때문에 대신 <code>@mui/styles/makeStyles</code>를 사용해야 한다. <code>defaultTheme</code> 를 더이상 사용할 수 없기 때문에 <code>ThemeProvider</code>를 어플리케이션의 루트에 추가하도록 한다. 만약 <code>@mui/material</code>와 함께 사용하고 있다면 <code>@mui/material/styles</code>에 있는 ThemeProvider 컴포넌트를 사용하는 것을 추천한다.</li>
</ul>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; makeStyles &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; makeStyles &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; createTheme, ThemeProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line">+<span class="keyword">const</span> theme = createTheme();</span><br><span class="line"> <span class="keyword">const</span> useStyles = makeStyles(<span class="function">(<span class="params">theme</span>) =&gt;</span> (&#123;</span><br><span class="line">   background: theme.palette.primary.main,</span><br><span class="line"> &#125;));</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">Component</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">const</span> classes = useStyles();</span><br><span class="line">   <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;classes.root&#125;</span> /&gt;</span></span></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// In the root of your app</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">-  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span> /&gt;</span></span>;</span><br><span class="line">+  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ThemeProvider</span> <span class="attr">theme</span>=<span class="string">&#123;theme&#125;</span>&gt;</span><span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span><span class="tag">&lt;/<span class="name">ThemeProvider</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="MuiThemeProvider"><a href="#MuiThemeProvider" class="headerlink" title="MuiThemeProvider"></a>MuiThemeProvider</h3><p><code>MuiThemeProvider</code> 컴포넌트는 더이상 <code>@mui/material/styles</code>에서 export되지 않으므로 <code>ThemeProvider</code>를 대신 사용한다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; MuiThemeProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; ThemeProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="serverStyleSheets"><a href="#serverStyleSheets" class="headerlink" title="serverStyleSheets"></a>serverStyleSheets</h3><p><code>ServerStyleSheets</code> 컴포넌트는 더이상 <code>@mui/material/styles</code>에서 export되지 않으므로 <code>@mui/styles</code>에서 직접 import하도록 한다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; ServerStyleSheets &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; ServerStyleSheets &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="Styles-1"><a href="#Styles-1" class="headerlink" title="Styles"></a>Styles</h3><p><code>styled</code> JSS utility는 더이상 <code>@mui/material/styles</code>에서 export되지 않으므로 대신 <code>@mui/styles</code>에서 export된 것을 사용하도록 한다. <code>defaultTheme</code> 를 더이상 사용할 수 없기 때문에 <code>ThemeProvider</code>를 어플리케이션의 루트에 추가하도록 한다. 만약 <code>@mui/material</code>와 함께 사용하고 있다면 <code>@mui/material/styles</code>에 있는 ThemeProvider 컴포넌트를 사용하는 것을 추천한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; styled &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; styled &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; createTheme, ThemeProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line">+<span class="keyword">const</span> theme = createTheme();</span><br><span class="line"> <span class="keyword">const</span> MyComponent = styled(<span class="string">'div'</span>)(<span class="function">(<span class="params">&#123; theme &#125;</span>) =&gt;</span> (&#123; <span class="attr">background</span>: theme.palette.primary.main &#125;));</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">-  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">MyComponent</span> /&gt;</span></span>;</span><br><span class="line">+  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ThemeProvider</span> <span class="attr">theme</span>=<span class="string">&#123;theme&#125;</span>&gt;</span><span class="tag">&lt;<span class="name">MyComponent</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span><span class="tag">&lt;/<span class="name">ThemeProvider</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="StylesProvider"><a href="#StylesProvider" class="headerlink" title="StylesProvider"></a>StylesProvider</h3><ul>
<li><code>StylesProvider</code> 컴포넌트는 더이상 <code>@mui/material/styles</code>에서 export되지 않으므로 <code>@mui/styles</code>에서 바로 export하여 사용하도록 한다.</li>
</ul>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; StylesProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; StylesProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="useThemeVariants"><a href="#useThemeVariants" class="headerlink" title="useThemeVariants"></a>useThemeVariants</h3><ul>
<li><code>useThemeVariants</code> hook은 더이상 <code>@mui/material/styles</code> 에서 export 되지 않기 때문에 <code>@mui/styles</code> 에서 즉시 import하여 사용하도록 한다.</li>
</ul>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; useThemeVariants &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; useThemeVariants &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="withStyles"><a href="#withStyles" class="headerlink" title="withStyles"></a>withStyles</h3><p><code>innerRef</code> prop은 <code>ref</code> prop으로 교체한다. Refs는 이제 자동으로 inner 컴포넌트에 전달된다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"> <span class="keyword">import</span> &#123; withStyles &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">const</span> MyComponent = withStyles(&#123;</span><br><span class="line">   root: &#123;</span><br><span class="line">     backgroundColor: <span class="string">'red'</span>,</span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;)(<span class="function">(<span class="params">&#123; classes &#125;</span>) =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;classes.root&#125;</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">MyOtherComponent</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">   <span class="keyword">const</span> ref = React.useRef();</span><br><span class="line">-  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">MyComponent</span> <span class="attr">innerRef</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">+  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">MyComponent</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><code>withStyles</code> JSS utility는 더이상 <code>@mui/material/styles</code> 에서 export 되지 않기 때문에 <code>@mui/styles/withStyles</code> 를 대신 쓰도록 한다. <code>defaultTheme</code> 를 더이상 사용할 수 없기 때문에 <code>ThemeProvider</code>를 어플리케이션의 루트에 추가하도록 한다. 만약 <code>@mui/material</code>와 함께 사용하고 있다면 <code>@mui/material/styles</code>에 있는 ThemeProvider 컴포넌트를 사용하는 것을 추천한다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; withStyles &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; withStyles &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; createTheme, ThemeProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line">+<span class="keyword">const</span> defaultTheme = createTheme();</span><br><span class="line"> <span class="keyword">const</span> MyComponent = withStyles(<span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">const</span> &#123; classes, className, ...other &#125; = props;</span><br><span class="line">   <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;clsx(className,</span> <span class="attr">classes.root</span>)&#125; &#123;<span class="attr">...other</span>&#125; /&gt;</span></span></span><br><span class="line"> &#125;)(<span class="function">(<span class="params">&#123; theme &#125;</span>) =&gt;</span> (&#123; <span class="attr">root</span>: &#123; <span class="attr">background</span>: theme.palette.primary.main &#125;&#125;));</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">-  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">MyComponent</span> /&gt;</span></span>;</span><br><span class="line">+  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ThemeProvider</span> <span class="attr">theme</span>=<span class="string">&#123;defaultTheme&#125;</span>&gt;</span><span class="tag">&lt;<span class="name">MyComponent</span> /&gt;</span><span class="tag">&lt;/<span class="name">ThemeProvider</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="withTheme"><a href="#withTheme" class="headerlink" title="withTheme"></a>withTheme</h3><p><code>withTheme</code> HOC utility는 <code>@mui/material/styles</code> 패키지에서 제거되었기 때문에 대신 <code>@mui/styles/withTheme</code>를 사용할 수 있다. <code>defaultTheme</code> 를 더이상 사용할 수 없기 때문에 <code>ThemeProvider</code>를 어플리케이션의 루트에 추가하도록 한다. 만약 <code>@mui/material</code>와 함께 사용하고 있다면 <code>@mui/material/styles</code>에 있는 ThemeProvider 컴포넌트를 사용하는 것을 추천한다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-<span class="keyword">import</span> &#123; withTheme &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; withTheme &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; createTheme, ThemeProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/material/styles'</span>;</span><br><span class="line"></span><br><span class="line">+<span class="keyword">const</span> theme = createTheme();</span><br><span class="line"> <span class="keyword">const</span> MyComponent = withTheme(<span class="function">(<span class="params">&#123; theme &#125;</span>) =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;props.theme.direction&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">-  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">MyComponent</span> /&gt;</span></span>;</span><br><span class="line">+  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ThemeProvider</span> <span class="attr">theme</span>=<span class="string">&#123;theme&#125;</span>&gt;</span><span class="tag">&lt;<span class="name">MyComponent</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span><span class="tag">&lt;/<span class="name">ThemeProvider</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><code>innerRef</code> prop를 ref prop으로 바꾼다. Ref는 이제 자동으로 내부 컴포넌트에 전달된다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withTheme &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MyComponent = withTheme(<span class="function">(<span class="params">&#123; theme &#125;</span>) =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;props.theme.direction&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyOtherComponent</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> ref = React.useRef();</span><br><span class="line">- <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">MyComponent</span> <span class="attr">innerRef</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">+ <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">MyComponent</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="withWidth"><a href="#withWidth" class="headerlink" title="withWidth"></a>withWidth</h3><p>이 HOC는 제거되었고, 대안으로 <code>[useMediaQuery</code> hook](<a href="https://mui.com/components/use-media-query/#migrating-from-withwidth)을" target="_blank" rel="noopener">https://mui.com/components/use-media-query/#migrating-from-withwidth)을</a> 쓸 수 있다.</p>
<aside>
💡 이는 응용 프로그램이 충돌하는 것을 방지하기 위해 하드 코딩된 기능을 적용하여 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<h3 id="mui-icons-matetial"><a href="#mui-icons-matetial" class="headerlink" title="mui/icons-matetial"></a>mui/icons-matetial</h3><h3 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h3><p>Github icon은 24px에서 22px로 크기가 감소되었다.</p>
<h3 id="material-ui-pickers"><a href="#material-ui-pickers" class="headerlink" title="@material-ui/pickers"></a><strong>@material-ui/pickers</strong></h3><p><code>@material-ui/pickers</code>를 마이그레이션 하는 방법은 <a href="https://mui.com/guides/pickers-migration/" target="_blank" rel="noopener">다음 페이지</a>를 참조하도록 한다.</p>
<hr>
<h2 id="System"><a href="#System" class="headerlink" title="System"></a>System</h2><p>다음의 system function 및 속성은 사용되지 않는 css로 간주되어 이름이 변경되었다.</p>
<ul>
<li><code>gridGap</code> to <code>gap</code></li>
<li><code>gridRowGap</code> to <code>rowGap</code></li>
<li><code>gridColumnGap</code> to <code>columnGap</code></li>
</ul>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<p>간격을 조정하는 unit인 <code>gap</code>, <code>rowGap</code>, <code>columnGap</code> 등을 사용할 때, 이전에 숫자로 사용하고 있었다면 theme.spacing과 더불어 새롭게 변환되기 위해 px를 덧붙여서 사용해야 한다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Box</span><br><span class="line">-  gap=&#123;<span class="number">2</span>&#125;</span><br><span class="line">+  gap=<span class="string">"2px"</span></span><br><span class="line"> &gt;</span><br></pre></td></tr></table></figure>
<p>css prop은 styled-components와 emotion의 css prop이 충돌되는 것을 막기 위해 <code>sx</code>로 변경한다.</p>
<aside>
💡 이는 [preset-safe codemod](https://mui.com/guides/migration-v4/#preset-safe)에서 처리된다.

</aside>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">;-(<span class="xml"><span class="tag">&lt;<span class="name">Box</span> <span class="attr">css</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> '<span class="attr">primary.main</span>' &#125;&#125; /&gt;</span></span>) +</span><br><span class="line">&lt;Box sx=&#123;&#123; <span class="attr">color</span>: <span class="string">'primary.main'</span> &#125;&#125; /&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Core-components"><a href="#Core-components" class="headerlink" title="Core components"></a>Core components</h3><p>core components는 스타일 엔진으로 emotion을 사용하기 때문에 emotion에 의해 사용되는 props들은 전파되지 않는다. 아래의 코드 스니펫처럼 props <code>as</code>는 <code>SomeOtherComponent</code>로 전파되지 않는다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;MuiComponent component=&#123;SomeOtherComponent&#125; <span class="keyword">as</span>=<span class="string">'button'</span> /&gt;</span><br></pre></td></tr></table></figure>
<hr>
<p><em>References</em><br><a href="https://mui.com/guides/migration-v4/" target="_blank" rel="noopener">Migration from v4 to v5 - MUI</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/10/03/211004_tsOmitExclude/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/03/211004_tsOmitExclude/" class="post-title-link" itemprop="url">A difference between TypeScript Omit and exclude</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-10-04 00:00:00" itemprop="dateCreated datePublished" datetime="2021-10-04T00:00:00+09:00">2021-10-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-16 15:45:41" itemprop="dateModified" datetime="2022-05-16T15:45:41+09:00">2022-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Keyof-Type-Operator"><a href="#Keyof-Type-Operator" class="headerlink" title="Keyof Type Operator"></a>Keyof Type Operator</h2><p>Keyof Type Operator는 객체타입을 취하여 key인 stirng 또는 numeric 리터럴 유니언을 생성한다. 아래 예시에서 <code>type P</code>는 <code>“x” | “y”</code>인 타입과 같다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Point = &#123; x: <span class="built_in">number</span>; y: <span class="built_in">number</span> &#125;;</span><br><span class="line"><span class="keyword">type</span> P = keyof Point;</span><br><span class="line"><span class="comment">//type P = “x” | “y”</span></span><br></pre></td></tr></table></figure>
<p>type이 string, 또는 number 인덱스 시그니처가 있으면 keyof가 이 types를 대신 반환한다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Arrayish = &#123; [n: <span class="built_in">number</span>]: unknown &#125;;</span><br><span class="line"><span class="keyword">type</span> A = keyof Arrayish;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> A = <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Mapish = &#123; [k: <span class="built_in">string</span>]: <span class="built_in">boolean</span> &#125;;</span><br><span class="line"><span class="keyword">type</span> M = keyof Mapish;</span><br></pre></td></tr></table></figure>
<p>이 예시에서 <code>M</code>은 <code>string | number</code>이다. 이는 JavaScript object keys가 언제나 string로 강제전환되기 때문이다. <strong>그래서 <code>obj[0]</code>은 언제나 <code>obj[&quot;0&quot;]</code>과 같다.</strong> <code>keyof</code>타입은 <code>mapped types</code>와 결합해서 사용할 때 특히 유용하다.</p>
<hr>
<h2 id="Omit-lt-Type-Keys-gt"><a href="#Omit-lt-Type-Keys-gt" class="headerlink" title="Omit&lt;Type, Keys&gt;"></a><code>Omit&lt;Type, Keys&gt;</code></h2><p><code>Type</code>에서 type을 구성하는 모든 속성을 선택하여 <code>keys</code>에 의해 제거될 수 있도록 한다. (key는 string 리터럴이거나 string 리터럴의 유니언이다.)</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Todo &#123;</span><br><span class="line">  title: <span class="built_in">string</span>;</span><br><span class="line">  description: <span class="built_in">string</span>;</span><br><span class="line">  completed: <span class="built_in">boolean</span>;</span><br><span class="line">  createdAt: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> TodoPreview = Omit&lt;Todo, <span class="string">'description'</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> todo: TodoPreview = &#123;</span><br><span class="line">  title: <span class="string">'Clean room'</span>,</span><br><span class="line">  completed: <span class="literal">false</span>,</span><br><span class="line">  createdAt: <span class="number">1615544252770</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">todo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> todo: TodoPreview;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> TodoInfo = Omit&lt;Todo, <span class="string">'completed'</span> | <span class="string">'createdAt'</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> todoInfo: TodoInfo = &#123;</span><br><span class="line">  title: <span class="string">'Pick up kids'</span>,</span><br><span class="line">  description: <span class="string">'Kindergarten closes at 5pm'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">todoInfo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> todoInfo: TodoInfo;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Exclude-lt-Type-ExcludedUnion-gt"><a href="#Exclude-lt-Type-ExcludedUnion-gt" class="headerlink" title="Exclude&lt;Type, ExcludedUnion&gt;"></a><code>Exclude&lt;Type, ExcludedUnion&gt;</code></h2><p><code>Type</code>으로부터 type을 제외하고 모든 union 멤버가 <code>ExcludedUnion</code>으로 할당될 수 있도록 한다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> T0 = Exclude&lt;<span class="string">'a'</span> | <span class="string">'b'</span> | <span class="string">'c'</span>, <span class="string">'a'</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> T0 = <span class="string">'b'</span> | <span class="string">'c'</span>;</span><br><span class="line"><span class="keyword">type</span> T1 = Exclude&lt;<span class="string">'a'</span> | <span class="string">'b'</span> | <span class="string">'c'</span>, <span class="string">'a'</span> | <span class="string">'b'</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> T1 = <span class="string">'c'</span>;</span><br><span class="line"><span class="keyword">type</span> T2 = Exclude&lt;<span class="built_in">string</span> | <span class="built_in">number</span> | <span class="function">(<span class="params">(<span class="params"></span>) =&gt; <span class="built_in">void</span></span>), <span class="params">Function</span>&gt;;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="params">type</span> <span class="params">T2</span> = <span class="params">string</span> | <span class="params">number</span>;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Omit-vs-Exclude"><a href="#Omit-vs-Exclude" class="headerlink" title="Omit vs Exclude"></a>Omit vs Exclude</h2><p>아래 <code>StudentInfo</code>에 대해 Omit과 Exclude를 사용해보면 어떻게 될까?</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> StudentInfo &#123;</span><br><span class="line">  isStudent: <span class="built_in">boolean</span>;</span><br><span class="line">  firstName?: <span class="built_in">string</span>;</span><br><span class="line">  lastName?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="StudentInfo라는-type에-Omit을-사용해보면-다음과-같다"><a href="#StudentInfo라는-type에-Omit을-사용해보면-다음과-같다" class="headerlink" title="StudentInfo라는 type에 Omit을 사용해보면 다음과 같다."></a>StudentInfo라는 type에 Omit을 사용해보면 다음과 같다.</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> OmitStudentData &#123;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">  studentName: keyof Omit&lt;StudentInfo, <span class="string">'lastName'</span>&gt;;</span><br><span class="line">  memo: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>type Omit&lt;T, K extends string | number | symbol&gt; = { [P in Exclude&lt;keyof T, K&gt;]: T[P];}</code></p>
</blockquote>
<p>Omit은 object type인 <code>StudentInfo</code>를 취해서 type 중 특정한 타입을 제거한다. 여기서 StudentInfo의 속성 <code>{ isStudent: boolean, firstName?: string, lastName?: string }</code>중 key가 ‘lastName’인 속성을 제거하고자 했다. 따라서 결과는 아래와 같다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> StudentInfo &#123;</span><br><span class="line">  isStudent: <span class="built_in">boolean</span>;</span><br><span class="line">  firstName?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="StudentInfo라는-type에-Exclude를-사용해보면-다음과-같다"><a href="#StudentInfo라는-type에-Exclude를-사용해보면-다음과-같다" class="headerlink" title="StudentInfo라는 type에 Exclude를 사용해보면 다음과 같다."></a>StudentInfo라는 type에 Exclude를 사용해보면 다음과 같다.</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> ExcludeStudentData &#123;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">  studentName: Exclude&lt;keyof StudentInfo, <span class="string">'lastName'</span>&gt;;</span><br><span class="line">  memo: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>type Exclude&lt;T, U&gt; = T extends U ? never : T</code></p>
</blockquote>
<p>Exclude는 union 멤버의 구성요소를 제거한다. 여기서 Exclude는 Union Type을 취해서 StudentInfo의 Union Type은 <code>Exclude&lt;&#39;isStudent&#39; | &#39;firstName&#39; | &#39;lastName&#39; | &#39;lastName&#39;&gt;</code>와 같은 형태가 되는데, <code>&#39;lastName&#39;</code>을 제외한 나머지 <code>&lt;&#39;isStudent&#39; | &#39;firstName&#39;&gt;</code>이 union 멤버가 된다. 따라서 결과는 아래와 같다.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> StudentInfo &#123;</span><br><span class="line">  isStudent: <span class="built_in">boolean</span>;</span><br><span class="line">  firstName?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong><em>Omit, Exclude를 쓴 결과는 동일하지만 과정상 Omit은 특정 속성을 제거한 결과를 제공한다는 점, Exclude는 속성을 제거하는 것이 아니라 특정 Union Type을 제외한 나머지 Union Type을 제거한다는 차이가 있다.</em></strong></p>
<hr>
<p><em>References</em><br><a href="https://www.typescriptlang.org/docs/handbook/2/keyof-types.html#the-keyof-type-operator" target="_blank" rel="noopener">The keyof type operator</a><br><a href="https://www.typescriptlang.org/docs/handbook/utility-types.html#omittype-keys" target="_blank" rel="noopener">Omit<Type, Keys></a><br><a href="https://www.typescriptlang.org/docs/handbook/utility-types.html#excludetype-excludedunion" target="_blank" rel="noopener">Exclude<Type, ExcludedUnion></a><br><a href="https://stackoverflow.com/questions/56916532/difference-b-w-only-exclude-and-omit-pick-exclude-typescript" target="_blank" rel="noopener">Difference b/w only Exclude and Omit (Pick &amp; Exclude) Typescript</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/09/25/210926_muiCssInjectionOrder/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/25/210926_muiCssInjectionOrder/" class="post-title-link" itemprop="url">MUI CSS injection order 원문 축약</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-26 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-26T00:00:00+09:00">2021-09-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-16 15:45:41" itemprop="dateModified" datetime="2022-05-16T15:45:41+09:00">2022-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문 링크: <a href="https://mui.com/styles/advanced/#string-templates" target="_blank" rel="noopener">https://mui.com/styles/advanced/#string-templates</a></p>
</blockquote>
<h2 id="CSS-injection-order"><a href="#CSS-injection-order" class="headerlink" title="CSS injection order"></a>CSS injection order</h2><blockquote>
<p>CSS가 어떻게 브라우저에 의해 계산되는지 이해하는 것은 언제 스타일 오버라이딩이 되는지 알기 위한 키포인트이기 때문에 매우 중요하다. 이와 관련하여 MDN의 <a href="https://developer.mozilla.org/ko/docs/Web/CSS/Specificity" target="_blank" rel="noopener">어떻게 계산되는가?</a>를 읽어보는 것을 추천한다.</p>
</blockquote>
<p>기본적으로 style 태그는 페이지의 <code>&lt;head&gt;</code> 엘리먼트의 가장 마지막에 주입된다. 이 style 태그는 페이지의 다른 어떤 style 태그 (e.g. CSS module, styled components) 보다도 특수함을 가진다.</p>
<h2 id="injectFirst"><a href="#injectFirst" class="headerlink" title="injectFirst"></a>injectFirst</h2><p><code>StylesProvider</code> 컴포넌트는 <code>injectFirst</code> prop를 가지고 있어서 head(낮은 우선순위)에서 가장 먼저 주입되는 style tag이다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; StylesProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span></span><br><span class="line"></span><br><span class="line">;<span class="xml"><span class="tag">&lt;<span class="name">StylesProvider</span> <span class="attr">injectFirst</span>&gt;</span></span></span><br><span class="line"><span class="xml">  &#123;/* Your component tree.</span></span><br><span class="line"><span class="xml">      Styled components can override MUI's styles. */&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">StylesProvider</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h2 id="makeStyles-withStyles-styled"><a href="#makeStyles-withStyles-styled" class="headerlink" title="makeStyles / withStyles / styled"></a>makeStyles / withStyles / styled</h2><p>주입되는 style tag는 makeStyles / withStyles / styled가 발생하는 같은 순위에서 발생한다. 예를 들어 color red가 아래 예시에서 우세하다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> clsx <span class="keyword">from</span> <span class="string">'clsx'</span></span><br><span class="line"><span class="keyword">import</span> &#123; makeStyles &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useStylesBase = makeStyles(&#123;</span><br><span class="line">  root: &#123;</span><br><span class="line">    color: <span class="string">'blue'</span> <span class="comment">// 🔵</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useStyles = makeStyles(&#123;</span><br><span class="line">  root: &#123;</span><br><span class="line">    color: <span class="string">'red'</span> <span class="comment">// 🔴</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Order doesn't matter</span></span><br><span class="line">  <span class="keyword">const</span> classes = useStyles()</span><br><span class="line">  <span class="keyword">const</span> classesBase = useStylesBase()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Order doesn't matter</span></span><br><span class="line">  <span class="keyword">const</span> className = clsx(classes.root, classesBase.root)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// color: red 🔴 wins.</span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;className&#125;</span> /&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>hook의 호출 순서와 class name의 연속적인 순서는 상관 없다.</p>
<h2 id="insertionPoint"><a href="#insertionPoint" class="headerlink" title="insertionPoint"></a>insertionPoint</h2><p>JSS는 이러한 상황을 해결할 수 있는 <a href="https://github.com/cssinjs/jss/blob/master/docs/setup.md#specify-the-dom-insertion-point" target="_blank" rel="noopener">매커니즘</a>을 제공한다. HTML내에 삽입점을 추가하는 것으로 CSS 규칙이 components에 <a href="https://cssinjs.org/jss-api/?v=v10.8.0#attach-style-sheets-in-a-specific-order" target="_blank" rel="noopener">적용되는 순서를 제어할 수 있다.</a></p>
<hr>
<p><em>References</em><br><a href="https://mui.com/styles/advanced/#string-templates" target="_blank" rel="noopener">CSS injection order</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/09/24/210925_nextjsTypescript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/24/210925_nextjsTypescript/" class="post-title-link" itemprop="url">Next.js와 TypeScript 원문 번역</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-25 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-25T00:00:00+09:00">2021-09-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-16 15:45:41" itemprop="dateModified" datetime="2022-05-16T15:45:41+09:00">2022-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문링크: <a href="https://nextjs.org/docs/basic-features/typescript#incremental-type-checking" target="_blank" rel="noopener">https://nextjs.org/docs/basic-features/typescript#incremental-type-checking</a></p>
</blockquote>
<h2 id="create-next-app-support"><a href="#create-next-app-support" class="headerlink" title="create-next-app support"></a>create-next-app support</h2><p>TypeScript project를 <code>create-next-app</code>과 함께 <code>--ts</code>, <code>--typescript</code> 를 사용하여 아래와 같이 생성할 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npx create-next-app --ts</span><br><span class="line"># or</span><br><span class="line">yarn create next-app --typescript</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Existing-projects"><a href="#Existing-projects" class="headerlink" title="Existing projects"></a>Existing projects</h2><p>이미 존재하는 project에 적용하려면 root folder에 빈 <code>tsconfig.json</code> file을 생성한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch tsconfig.json</span><br></pre></td></tr></table></figure>
<p>Next.js는 자동으로 이 파일 안에 default values를 설정한다. custom <a href="https://www.typescriptlang.org/docs/handbook/compiler-options.html" target="_blank" rel="noopener">complier options</a>로 <code>tsconfig.json</code>을 작성하는 것 또한 지원된다.</p>
<blockquote>
<p>Next.js는 TypeScript를 핸들링하기 위해 Babel을 사용하는데 몇가지 <a href="https://babeljs.io/docs/en/babel-plugin-transform-typescript#caveats" target="_blank" rel="noopener">주의사항</a>이 있고 <a href="https://babeljs.io/docs/en/babel-plugin-transform-typescript#typescript-compiler-options" target="_blank" rel="noopener">일부 컴파일러 옵션은 다르게 처리된다.</a></p>
</blockquote>
<p><code>next(npm run dev or yarn dev)</code>를 실행하면, Next.js가 setup을 완료하기 위해 설치가 필요한 패키지를 안내한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br><span class="line"></span><br><span class="line"># You&#39;ll see instructions like these:</span><br><span class="line">#</span><br><span class="line"># Please install typescript, @types&#x2F;react, and @types&#x2F;node by running:</span><br><span class="line">#</span><br><span class="line">#         yarn add --dev typescript @types&#x2F;react @types&#x2F;node</span><br><span class="line">#</span><br><span class="line"># ...</span><br></pre></td></tr></table></figure>
<p>이렇게 하면 <code>.js</code> 파일을 <code>.tsx</code>로 전환할 준비가 완료되었고, TypeScript를 사용할 수 있게 된다.</p>
<hr>
<blockquote>
<p><code>next-env.d.ts</code>라는 이름의 파일이 프로젝트의 root에 생성된다. 이 파일은 TypeScript complier가 Next.js의 type을 선택하도록 한다. 이는 매번 변경되므로 <strong>임의로 삭제하거나 편집하지 않도록 한다.</strong></p>
<p>TypeScript <code>strict</code> 모드는 기본적으로 꺼져있다. TypeScript를 편하게 사용하려면 <code>tsconfig.json</code>파일 내에 이 모드를 켜도록 한다.</p>
<p><code>next-env.d.ts</code>를 편집하는 대신 <code>additional.d.ts</code>와 같은 새 파일을 추가한 다음, <code>tsconfig.json</code> 의 <a href="https://www.typescriptlang.org/tsconfig#include" target="_blank" rel="noopener">include</a> 배열에서 참조하여 새로운 타입 유형을 추가할 수 있다.</p>
</blockquote>
<p>기본적으로 Next.js는 <code>next build</code>의 일부로 type checking를 수행한다. 개발하는 동안에는 code editior를 이용하여 type checking을 할 것을 추천한다.</p>
<p>만약 error report를 무시하고 싶다면, <a href="https://nextjs.org/docs/api-reference/next.config.js/ignoring-typescript-errors" target="_blank" rel="noopener">Ignoring TypeScript errors</a>와 관련된 문서를 확인하도록 한다.</p>
<hr>
<h2 id="Static-Generation-and-Server-side-Rendering"><a href="#Static-Generation-and-Server-side-Rendering" class="headerlink" title="Static Generation and Server-side Rendering"></a>Static Generation and Server-side Rendering</h2><p><code>getStaticProps</code>, <code>getStaticPaths</code>, <code>getServerSideProps</code>을 위해 각각 <code>getStaticProps</code>, <code>getStaticPaths</code>, <code>getServerSideProps</code> type을 사용할 수 있다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; GetStaticProps, GetStaticPaths, GetServerSideProps &#125; <span class="keyword">from</span> <span class="string">'next'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getStaticProps: GetStaticProps = <span class="keyword">async</span> (context) =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getStaticPaths: GetStaticPaths = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getServerSideProps: GetServerSideProps = <span class="keyword">async</span> (context) =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>만약 <code>getInitialProps</code>를 사용하려면 <a href="https://nextjs.org/docs/api-reference/data-fetching/getInitialProps#typescript" target="_blank" rel="noopener">이 링크</a>를 참조한다.</p>
</blockquote>
<hr>
<h2 id="API-Routes"><a href="#API-Routes" class="headerlink" title="API Routes"></a>API Routes</h2><p>아래 예제는 API routes의 빌트인 타입을 사용하는 방법이다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> type &#123; NextApiRequest, NextApiResponse &#125; <span class="keyword">from</span> <span class="string">'next'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (req: NextApiRequest, <span class="attr">res</span>: NextApiResponse) =&gt; &#123;</span><br><span class="line">  res.status(<span class="number">200</span>).json(&#123; <span class="attr">name</span>: <span class="string">'John Doe'</span> &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>reponse data에 type을 사용할 수도 있다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> type &#123; NextApiRequest, NextApiResponse &#125; <span class="keyword">from</span> <span class="string">'next'</span>;</span><br><span class="line"></span><br><span class="line">type Data = &#123;</span><br><span class="line">  name: string,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (req: NextApiRequest, <span class="attr">res</span>: NextApiResponse&lt;Data&gt;) =&gt; &#123;</span><br><span class="line">  res.status(<span class="number">200</span>).json(&#123; <span class="attr">name</span>: <span class="string">'John Doe'</span> &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Custom-App"><a href="#Custom-App" class="headerlink" title="Custom App"></a>Custom App</h2><p>만약 <a href="https://nextjs.org/docs/advanced-features/custom-app" target="_blank" rel="noopener">custom App</a>을 사용한다면 빌트인 타입인 <code>AppProps</code>를 사용할 수 있고 파일 이름을 <code>./pages/_app.tsx</code>와 같이 변경할 수 있다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// import App from "next/app";</span></span><br><span class="line"><span class="keyword">import</span> type &#123; AppProps <span class="comment">/*, AppContext */</span> &#125; <span class="keyword">from</span> <span class="string">'next/app'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyApp</span>(<span class="params">&#123; Component, pageProps &#125;: AppProps</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...pageProps</span>&#125; /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Only uncomment this method if you have blocking data requirements for</span></span><br><span class="line"><span class="comment">// every single page in your application. This disables the ability to</span></span><br><span class="line"><span class="comment">// perform automatic static optimization, causing every page in your app to</span></span><br><span class="line"><span class="comment">// be server-side rendered.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// MyApp.getInitialProps = async (appContext: AppContext) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   // calls page's `getInitialProps` and fills `appProps.pageProps`</span></span><br><span class="line"><span class="comment">//   const appProps = await App.getInitialProps(appContext);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   return &#123; ...appProps &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> MyApp;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Path-aliases-and-baseUrl"><a href="#Path-aliases-and-baseUrl" class="headerlink" title="Path aliases and baseUrl"></a>Path aliases and baseUrl</h2><p>Next.js는 자동으로 tsconfig.json <code>paths</code>와 <code>baseUrl</code> 옵션을 제공한다. Module Path aliases와 관련된 특징을 더 알아보고 싶다면 <a href="https://nextjs.org/docs/advanced-features/module-path-aliases" target="_blank" rel="noopener">이 링크</a>를 참조한다.</p>
<h2 id="Type-checking-next-config-js"><a href="#Type-checking-next-config-js" class="headerlink" title="Type checking next.config.js"></a>Type checking next.config.js</h2><p><code>next.config.js</code> 파일은 반드시 JavaScript 파일이어야 하고, Babel이나 TypeScript로 parse되어서는 안된다.하지만 아래와 같이 JSDoc를 이용해서 IDE에서의 몇 가지 type checking를 추가할 수는 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; @ts-check</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @type &#123;import(&#39;next&#39;).NextConfig&#125;</span><br><span class="line"> **&#x2F;</span><br><span class="line">const nextConfig &#x3D; &#123;</span><br><span class="line">  &#x2F;* config options here *&#x2F;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; nextConfig</span><br></pre></td></tr></table></figure>
<h2 id="Incremental-type-checking"><a href="#Incremental-type-checking" class="headerlink" title="Incremental type checking"></a>Incremental type checking</h2><p><code>v10.2.1</code>부터 Next.js는 <a href="https://www.typescriptlang.org/tsconfig#incremental" target="_blank" rel="noopener">incremental type checking</a>를 <code>tsconfig.json</code>에서 사용할 수 있도록 지원한다. 이는 대규모 application에서 type checking을 빠르게 할 수 있도록 돕는다. 최소한 <code>v4.3.2</code>이상의 TypeScript를 사용하고 있다면 최고의 성능을 경험하기 위해 이를 사용하는 것이 추천된다.</p>
<hr>
<p><em>References</em><br><a href="https://nextjs.org/docs/basic-features/typescript#incremental-type-checking" target="_blank" rel="noopener">Next.js - TypeScript</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/09/01/210902_axios/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/01/210902_axios/" class="post-title-link" itemprop="url">Axios</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-02 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-02T00:00:00+09:00">2021-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-16 15:45:41" itemprop="dateModified" datetime="2022-05-16T15:45:41+09:00">2022-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문링크: <a href="https://axios-http.com/" target="_blank" rel="noopener">https://axios-http.com/</a></p>
</blockquote>
<h2 id="Axios란"><a href="#Axios란" class="headerlink" title="Axios란"></a>Axios란</h2><p>node.js와 브라우저를 위한 promise 기반의 HTTP Client. 브라우저와 nodejs에서 동일한 코드가 동일하게 동작한다. server-side에서는 native 기반의 node.js httop 모듈을 사용하고, client(브라우저)에서는 XMLHttpRequests를 사용한다.</p>
<h2 id="특징"><a href="#특징" class="headerlink" title="특징"></a>특징</h2><ul>
<li>브라우저로부터 XMLHttpRequests를 만든다.</li>
<li>node.js로부터 http 요청을 만든다.</li>
<li>Promise API를 보조한다.</li>
<li>request와 response를 중간에서 가로채어 관리한다.</li>
<li>request와 response 데이터를 전송한다.</li>
<li>request를 취소한다.</li>
<li>JSON data에 대한 자동 변환.</li>
<li>XSRF로부터 보호하기 위해 client side를 보조한다.</li>
</ul>
<h2 id="설치"><a href="#설치" class="headerlink" title="설치"></a>설치</h2><p><strong>1. using npm</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install axios</span><br></pre></td></tr></table></figure>
<p><strong>2. using bower</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bower install axios</span><br></pre></td></tr></table></figure>
<p><strong>3. using yarn</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn add axios</span><br></pre></td></tr></table></figure>
<p><strong>4. using jsDelivr CDN</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>5. Using unpkg CDN</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/axios/dist/axios.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="예시"><a href="#예시" class="headerlink" title="예시"></a>예시</h2><h3 id="CommonJS-usage"><a href="#CommonJS-usage" class="headerlink" title="CommonJS usage"></a>CommonJS usage</h3><p>TypeScript typings (for intellisense / autocomplete)이 가능하게 하기 위해 CommonJS를 사용할 때는 아래 예시처럼 <code>require()</code>를 import한다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">'axios'</span>).default;</span><br><span class="line"></span><br><span class="line"><span class="comment">// axios.&lt;method&gt;를 쓰게 되면 autocomplete과 parameter typings의 사용이 가능해진다.</span></span><br></pre></td></tr></table></figure>
<h3 id="GET-request를-수행하는-예제"><a href="#GET-request를-수행하는-예제" class="headerlink" title="GET request를 수행하는 예제"></a>GET request를 수행하는 예제</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">'axios'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Make a request for a user with a given ID</span></span><br><span class="line">axios</span><br><span class="line">  .get(<span class="string">'/user?ID=12345'</span>)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// handle success</span></span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// handle error</span></span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 항상 실행된다.</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 선택적으로 위의 요청을 아래와 같이 수행할 수 있다.</span></span><br><span class="line">axios</span><br><span class="line">  .get(<span class="string">'/user'</span>, &#123;</span><br><span class="line">    params: &#123;</span><br><span class="line">      ID: <span class="number">12345</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 항상 실행된다.</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// async/await를 쓰고 싶다면 'async' 키워드를 function/method의 바깥쪽에 붙여준다.</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getUser</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.get(<span class="string">'/user?ID=12345'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="POST-Requests"><a href="#POST-Requests" class="headerlink" title="POST Requests"></a>POST Requests</h2><p>Axios를 가지고 POST request를 요청하는 방법</p>
<h3 id="POST-request를-수행하는-예제"><a href="#POST-request를-수행하는-예제" class="headerlink" title="POST request를 수행하는 예제"></a>POST request를 수행하는 예제</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">axios</span><br><span class="line">  .post(<span class="string">'/user'</span>, &#123;</span><br><span class="line">    firstName: <span class="string">'Fred'</span>,</span><br><span class="line">    lastName: <span class="string">'Flintstone'</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="여러-요청을-동시에-수행하는-예제"><a href="#여러-요청을-동시에-수행하는-예제" class="headerlink" title="여러 요청을 동시에 수행하는 예제"></a>여러 요청을 동시에 수행하는 예제</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserAccount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/12345'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserPermissions</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/12345/permissions'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all([getUserAccount(), getUserPermissions()]).then(<span class="function"><span class="keyword">function</span> (<span class="params">results</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> acct = results[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">const</span> perm = results[<span class="number">1</span>];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Axios-API"><a href="#Axios-API" class="headerlink" title="Axios API"></a>Axios API</h2><p>request는 관련된 config를 통해 axios로 전달된다.</p>
<h3 id="axios-config"><a href="#axios-config" class="headerlink" title="axios(config)"></a>axios(config)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// POST request를 보낸다.</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  method: <span class="string">'post'</span>,</span><br><span class="line">  url: <span class="string">'/user/12345'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    firstName: <span class="string">'Fred'</span>,</span><br><span class="line">    lastName: <span class="string">'Flintstone'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// node.js remote image에 대한 GET request</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  method: <span class="string">'get'</span>,</span><br><span class="line">  url: <span class="string">'http://bit.ly/2mTM3nY'</span>,</span><br><span class="line">  responseType: <span class="string">'stream'</span>,</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">  response.data.pipe(fs.createWriteStream(<span class="string">'ada_lovelace.jpg'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="axios-url-config"><a href="#axios-url-config" class="headerlink" title="axios(url[, config])"></a>axios(url[, config])</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Send a GET request (default method)</span></span><br><span class="line">axios(<span class="string">'/user/12345'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Request-method-aliases"><a href="#Request-method-aliases" class="headerlink" title="Request method aliases"></a>Request method aliases</h3><p>편의를 위해 지원되는 모든 요청 메서드에 대한 alias가 제공된다. alias method인 url, method, data 속성을 쓸 때는 config에 작성할 필요없다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">axios.request(config)</span><br><span class="line">axios.get(url[, config])</span><br><span class="line">axios.delete(url[, config])</span><br><span class="line">axios.head(url[, config])</span><br><span class="line">axios.options(url[, config])</span><br><span class="line">axios.post(url[, data[, config]])</span><br><span class="line">axios.put(url[, data[, config]])</span><br><span class="line">axios.patch(url[, data[, config]])</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="The-Axios-Instance"><a href="#The-Axios-Instance" class="headerlink" title="The Axios Instance"></a>The Axios Instance</h2><h3 id="Creating-an-instance"><a href="#Creating-an-instance" class="headerlink" title="Creating an instance"></a>Creating an instance</h3><p>custom config를 통해 axios의 새로운 인스턴스를 생성할 수 있다.</p>
<h3 id="axios-create-config"><a href="#axios-create-config" class="headerlink" title="axios.create([config])"></a>axios.create([config])</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">  baseURL: <span class="string">'https://some-domain.com/api/'</span>,</span><br><span class="line">  timeout: <span class="number">1000</span>,</span><br><span class="line">  headers: &#123; <span class="string">'X-Custom-Header'</span>: <span class="string">'foobar'</span> &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Instance-methods"><a href="#Instance-methods" class="headerlink" title="Instance methods"></a>Instance methods</h3><p>사용 가능한 인스턴스 메소드는 아래와 같다. 명시된 config는 instance config와 병합된다.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">axios#request(config)</span><br><span class="line">axios#get(url[, config])</span><br><span class="line">axios#delete(url[, config])</span><br><span class="line">axios#head(url[, config])</span><br><span class="line">axios#options(url[, config])</span><br><span class="line">axios#post(url[, data[, config]])</span><br><span class="line">axios#put(url[, data[, config]])</span><br><span class="line">axios#patch(url[, data[, config]])</span><br><span class="line">axios#getUri([config])</span><br></pre></td></tr></table></figure>
<hr>
<p><em>References</em><br><a href="https://axios-http.com/" target="_blank" rel="noopener">Axios</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/08/25/210826_rtk-mutation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/25/210826_rtk-mutation/" class="post-title-link" itemprop="url">RTK Query Mutation 원문 번역</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-08-26 00:00:00" itemprop="dateCreated datePublished" datetime="2021-08-26T00:00:00+09:00">2021-08-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-16 15:45:41" itemprop="dateModified" datetime="2022-05-16T15:45:41+09:00">2022-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문링크: <a href="https://redux-toolkit.js.org/rtk-query/usage/mutations" target="_blank" rel="noopener">https://redux-toolkit.js.org/rtk-query/usage/mutations</a></p>
</blockquote>
<h1 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h1><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>mutation은 서버에 데이터 업데이트를 보낼 때 사용하고, 이를 로컬 캐시에 적용하도록 한다. 또 유효하지 않은 데이터를 걸러내고, 강제로 re-fetch할 수 있도록 한다.</p>
<h2 id="Defining-Mutation-Endpoints"><a href="#Defining-Mutation-Endpoints" class="headerlink" title="Defining Mutation Endpoints"></a>Defining Mutation Endpoints</h2><p>Mutation Endpoints는 createApi의 endpoints 섹션에 return 되는 객체로 정의된다. 정의되는 곳에서는 builder.mutation() 메소드를 통해 정의한다.</p>
<p>Mutation Endpoints는 URL(URL query params를 포함하는)의 구조의 query 콜백이나 queryFn 콜백에 정의해야 되는데, queryFn callback은 임의로 async 로직을 구성하고 결과를 반환한다. query 콜백은 URL, request 메소드에 사용하는 HTTP 메소드를 포함한 객체를 반환한다.</p>
<p>query 콜백이 URL을 생성하기 위한 추가 데이터가 필요한 경우에는 단일 인수로 작성되어야 하고, 만약 여러 파라미터를 전달할 예정이라면 단일 옵션 개체(option object)의 형태로 전달되어야 한다.</p>
<p>Mutation endpoints는 결과가 캐시되기 전에 response 내용을 수정하고, tags를 정의하여 캐시 무효화를 식별하고, 캐시 항목이 추가 및 제거될 때까지 전체 라이프 사이클 콜백을 제공한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Example of all mutation endpoint options</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Post &#125; <span class="keyword">from</span> <span class="string">'./types'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> api = createApi(&#123;</span><br><span class="line">  baseQuery: fetchBaseQuery(&#123;</span><br><span class="line">    baseUrl: <span class="string">'/'</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  tagTypes: [<span class="string">'Post'</span>],</span><br><span class="line">  endpoints: <span class="function">(<span class="params">build</span>) =&gt;</span> (&#123;</span><br><span class="line">    updatePost: build.mutation&lt;Post, Partial&lt;Post&gt; &amp; Pick&lt;Post, <span class="string">'id'</span>&gt;&gt;(&#123;</span><br><span class="line">      <span class="comment">// note: an optional `queryFn` may be used in place of `query`</span></span><br><span class="line">      query: <span class="function">(<span class="params">&#123; id, ...patch &#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">        url: <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">        method: <span class="string">'PATCH'</span>,</span><br><span class="line">        body: patch,</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="comment">// Pick out data and prevent nested properties in a hook or selector</span></span><br><span class="line">      transformResponse: <span class="function">(<span class="params">response: &#123; data: Post &#125;</span>) =&gt;</span> response.data,</span><br><span class="line">      invalidatesTags: [<span class="string">'Post'</span>],</span><br><span class="line">      <span class="comment">// onQueryStarted is useful for optimistic updates</span></span><br><span class="line">      <span class="comment">// The 2nd parameter is the destructured `MutationLifecycleApi`</span></span><br><span class="line">      <span class="keyword">async</span> onQueryStarted(</span><br><span class="line">        arg,</span><br><span class="line">        &#123; dispatch, getState, queryFulfilled, requestId, extra, getCacheEntry &#125;</span><br><span class="line">      ) &#123;&#125;,</span><br><span class="line">      <span class="comment">// The 2nd parameter is the destructured `MutationCacheLifecycleApi`</span></span><br><span class="line">      <span class="keyword">async</span> onCacheEntryAdded(</span><br><span class="line">        arg,</span><br><span class="line">        &#123;</span><br><span class="line">          dispatch,</span><br><span class="line">          getState,</span><br><span class="line">          extra,</span><br><span class="line">          requestId,</span><br><span class="line">          cacheEntryRemoved,</span><br><span class="line">          cacheDataLoaded,</span><br><span class="line">          getCacheEntry,</span><br><span class="line">        &#125;</span><br><span class="line">      ) &#123;&#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>onQueryStarted는 <a href="https://redux-toolkit.js.org/rtk-query/usage/optimistic-updates" target="_blank" rel="noopener">optimistic update</a>에 사용할 수 있다.</p>
<hr>
<h2 id="Performing-Mutations-with-React-Hooks"><a href="#Performing-Mutations-with-React-Hooks" class="headerlink" title="Performing Mutations with React Hooks"></a>Performing Mutations with React Hooks</h2><h3 id="Mutation-Hook-Behavior"><a href="#Mutation-Hook-Behavior" class="headerlink" title="Mutation Hook Behavior"></a>Mutation Hook Behavior</h3><p>useQuery와 달리 useMutation는 tuple을 반환한다. tuple의 첫 번째 아이템은 ‘trigger’ 함수이고, 두 번째 아이템은 status, error, data를 포함하는 객체이다.</p>
<p>useQuery hook과 달리 useMutation은 자동으로 실행되지 않는다. mutation을 실행하기 위해서 hook의 첫 번째 tuple 값인 trigger 함수를 호출해야 한다. <a href="https://redux-toolkit.js.org/rtk-query/api/created-api/hooks#usemutation" target="_blank" rel="noopener">useMutaion</a>과 관련된 자세한 내용은 링크를 참조한다.</p>
<h3 id="Frequently-Used-Mutation-Hook-Return-Values"><a href="#Frequently-Used-Mutation-Hook-Return-Values" class="headerlink" title="Frequently Used Mutation Hook Return Values"></a>Frequently Used Mutation Hook Return Values</h3><p>useMutation hook은 mutaion trigger 함수를 포함하는 tuple과 mutation 결과와 관련된 속성을 포함하는 객체를 반환한다 하였다.</p>
<p>mutaion trigger 함수가 호출될 때 해당 엔드포인트에 대한 요청을 시작한다. mutation trigger를 호출하면 upwarp 속성이 포함된 프로미스를 반환하는데, 이 속성을 호출하는 것을 통해 mutation 호출을 풀고, raw한 reponse와 error를 제공할 수 있다. 이는 mutation의 호출되는 영역에서 성공/실패 여부를 결정하는 경우에 유용하다.</p>
<p>mutation result는 mutation 요청에 대한 가장 최신의 data와 같은 속성을 포함하는 객체인데, 이 뿐 만 아니라 현재 요청한 라이프사이클 state에 대한 boolean 속성도 포함하고 있다.</p>
<p>아래는 mutation result 객체에서 가장 자주 사용하는 속성들이다. <a href="https://redux-toolkit.js.org/rtk-query/api/created-api/hooks#usemutation" target="_blank" rel="noopener">useMutation</a>가 return하는 전체 속성에 대한 내용은 링크를 참조한다.</p>
<ul>
<li>data: 존재하는 경우에, 가장 최신의 trigger response로 부터 반환된 데이터. 만약 동일한 hook의 인스턴스에서 후속 trigger가 호출되면 새로운 데이터를 받기 전에는 undefined를 반환한다. 이전 데이터에서 새로운 데이터로의 원활한 전환을 위해서 컴포넌트 레벨의 고려해야 한다.</li>
<li>error: 존재하는 경우 에러의 결과.</li>
<li>isUninitialized: true일 때, mutation이 아직 발생하지 않았음을 나타낸다.</li>
<li>isLoading: true일 경우에 mutation이 아직 발생했고, reponse를 기다리는 중임을 나타낸다.</li>
<li>isSuccess: true일 경우에 마자믹으로 실행된 mutation에서 성공적인 요청으로 부터 얻은 데이터가 있음을 나타낸다.</li>
<li>isError: true일 때, 마지막으로 실행된 mutation에서 error 상태를 얻었음을 나타낸다.</li>
</ul>
<p>note: RTK 쿼리에서 mutation은 <a href="https://redux-toolkit.js.org/rtk-query/usage/queries#frequently-used-query-hook-return-values" target="_blank" rel="noopener">query</a>가 그런 것 처럼 ‘loading’와 ‘fetching’ 사이에 시멘틱한 구분을 포함하고 있지 않다. mutation은 후속 call이 반드시 관련이 있는 것이라고 가정하지 않기 때문에, mutation은 ‘no fetching’과 같은 컨셉이 없고, ‘loading’ 또는 ‘not loading’의 컨셉을 가진다.</p>
<hr>
<h2 id="Standard-Mutation-Example"><a href="#Standard-Mutation-Example" class="headerlink" title="Standard Mutation Example"></a>Standard Mutation Example</h2><p>페이지 하단의 updataPost mutation의 완전한 수정된 예시이다. 이 시나리오에서 post는 useQuery로 fetch되었고, post의 이름을 수정할 수 있는 EditablePostName 컴포넌트가 렌더된다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/features/posts/PostDetail.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> PostDetail = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = useParams&lt;&#123; <span class="attr">id</span>: any &#125;&gt;()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">data</span>: post &#125; = useGetPostQuery(id)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [</span><br><span class="line">    updatePost, <span class="comment">// This is the mutation trigger</span></span><br><span class="line">    &#123; <span class="attr">isLoading</span>: isUpdating &#125;, <span class="comment">// This is the destructured mutation result</span></span><br><span class="line">  ] = useUpdatePostMutation()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Box p=&#123;<span class="number">4</span>&#125;&gt;</span><br><span class="line">      &lt;EditablePostName</span><br><span class="line">        name=&#123;post.name&#125;</span><br><span class="line">        onUpdate=&#123;(name) =&gt; &#123;</span><br><span class="line">          <span class="comment">// If you want to immediately access the result of a mutation, you need to chain `.unwrap()`</span></span><br><span class="line">          <span class="comment">// if you actually want the payload or to catch the error.</span></span><br><span class="line">          <span class="comment">// Example: `updatePost().unwrap().then(fulfilled =&gt; console.log(fulfilled)).catch(rejected =&gt; console.error(rejected))</span></span><br><span class="line"></span><br><span class="line">          <span class="keyword">return</span> (</span><br><span class="line">            <span class="comment">// Execute the trigger with the `id` and updated `name`</span></span><br><span class="line">            updatePost(&#123; id, name &#125;)</span><br><span class="line">          )</span><br><span class="line">        &#125;&#125;</span><br><span class="line">        isLoading=&#123;isUpdating&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Box&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Advanced-Mutations-with-Revalidation"><a href="#Advanced-Mutations-with-Revalidation" class="headerlink" title="Advanced Mutations with Revalidation"></a>Advanced Mutations with Revalidation</h2><p>일반적으로 개발자가 mutation(revalidation)을 수행한 후 로컬 데이터 캐시를 서버와 재동기화하려는 경우가 매우 흔하다. RTK Query는 이에 대해 보다 중앙집권화 된 접근방법을 취함으로써 API 정의에서 invalidation 동작을 구성해야 한다. <a href="https://redux-toolkit.js.org/rtk-query/usage/automated-refetching#advanced-invalidation-with-abstract-tag-ids" target="_blank" rel="noopener">Advanced Invalidation with abstract tag IDs</a>를 통해 RTK Query와 Invalidation에 대한 자세한 내용을 참조하라.</p>
<h2 id="Revalidation-Example"><a href="#Revalidation-Example" class="headerlink" title="Revalidation Example"></a>Revalidation Example</h2><p>post의 <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete" target="_blank" rel="noopener">CRUD service</a> 예시이다. 이는 <a href="https://redux-toolkit.js.org/rtk-query/usage/automated-refetching#selectively-invalidating-lists" target="_blank" rel="noopener">Selectively invalidating lists</a>의 전략을 구현하고, 실제 어플리케이션을 위한 좋은 기반을 제공한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/app/services/posts.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Or from '@reduxjs/toolkit/query' if not using the auto-generated hooks</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface Post &#123;</span><br><span class="line">  id: number</span><br><span class="line">  name: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type PostsResponse = Post[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> postApi = createApi(&#123;</span><br><span class="line">  reducerPath: <span class="string">'postsApi'</span>,</span><br><span class="line">  baseQuery: fetchBaseQuery(&#123; <span class="attr">baseUrl</span>: <span class="string">'/'</span> &#125;),</span><br><span class="line">  tagTypes: [<span class="string">'Posts'</span>],</span><br><span class="line">  endpoints: <span class="function">(<span class="params">build</span>) =&gt;</span> (&#123;</span><br><span class="line">    getPosts: build.query&lt;PostsResponse, <span class="keyword">void</span>&gt;(&#123;</span><br><span class="line">      query: <span class="function"><span class="params">()</span> =&gt;</span> <span class="string">'posts'</span>,</span><br><span class="line">      <span class="comment">// Provides a list of `Posts` by `id`.</span></span><br><span class="line">      <span class="comment">// If any mutation is executed that `invalidate`s any of these tags, this query will re-run to be always up-to-date.</span></span><br><span class="line">      <span class="comment">// The `LIST` id is a "virtual id" we just made up to be able to invalidate this query specifically if a new `Posts` element was added.</span></span><br><span class="line">      providesTags: <span class="function">(<span class="params">result</span>) =&gt;</span></span><br><span class="line">        <span class="comment">// is result available?</span></span><br><span class="line">        result</span><br><span class="line">          ? <span class="comment">// successful query</span></span><br><span class="line">            [</span><br><span class="line">              ...result.map(<span class="function">(<span class="params">&#123; id &#125;</span>) =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, id &#125; <span class="keyword">as</span> <span class="keyword">const</span>)),</span><br><span class="line">              &#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, <span class="attr">id</span>: <span class="string">'LIST'</span> &#125;,</span><br><span class="line">            ]</span><br><span class="line">          : <span class="comment">// an error occurred, but we still want to refetch this query when `&#123; type: 'Posts', id: 'LIST' &#125;` is invalidated</span></span><br><span class="line">            [&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, <span class="attr">id</span>: <span class="string">'LIST'</span> &#125;],</span><br><span class="line">    &#125;),</span><br><span class="line">    addPost: build.mutation&lt;Post, Partial&lt;Post&gt;&gt;(&#123;</span><br><span class="line">      query(body) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          url: <span class="string">`post`</span>,</span><br><span class="line">          method: <span class="string">'POST'</span>,</span><br><span class="line">          body,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// Invalidates all Post-type queries providing the `LIST` id - after all, depending of the sort order,</span></span><br><span class="line">      <span class="comment">// that newly created post could show up in any lists.</span></span><br><span class="line">      invalidatesTags: [&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, <span class="attr">id</span>: <span class="string">'LIST'</span> &#125;],</span><br><span class="line">    &#125;),</span><br><span class="line">    getPost: build.query&lt;Post, number&gt;(&#123;</span><br><span class="line">      query: <span class="function">(<span class="params">id</span>) =&gt;</span> <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">      providesTags: <span class="function">(<span class="params">result, error, id</span>) =&gt;</span> [&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, id &#125;],</span><br><span class="line">    &#125;),</span><br><span class="line">    updatePost: build.mutation&lt;Post, Partial&lt;Post&gt;&gt;(&#123;</span><br><span class="line">      query(data) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; id, ...body &#125; = data</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          url: <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">          method: <span class="string">'PUT'</span>,</span><br><span class="line">          body,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// Invalidates all queries that subscribe to this Post `id` only.</span></span><br><span class="line">      <span class="comment">// In this case, `getPost` will be re-run. `getPosts` *might*  rerun, if this id was under its results.</span></span><br><span class="line">      invalidatesTags: <span class="function">(<span class="params">result, error, &#123; id &#125;</span>) =&gt;</span> [&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, id &#125;],</span><br><span class="line">    &#125;),</span><br><span class="line">    deletePost: build.mutation&lt;&#123; <span class="attr">success</span>: boolean; id: number &#125;, number&gt;(&#123;</span><br><span class="line">      query(id) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          url: <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">          method: <span class="string">'DELETE'</span>,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// Invalidates all queries that subscribe to this Post `id` only.</span></span><br><span class="line">      invalidatesTags: <span class="function">(<span class="params">result, error, id</span>) =&gt;</span> [&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, id &#125;],</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123;</span><br><span class="line">  useGetPostsQuery,</span><br><span class="line">  useAddPostMutation,</span><br><span class="line">  useGetPostQuery,</span><br><span class="line">  useUpdatePostMutation,</span><br><span class="line">  useDeletePostMutation,</span><br><span class="line">&#125; = postApi</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Optimistic-Updates"><a href="#Optimistic-Updates" class="headerlink" title="Optimistic Updates"></a>Optimistic Updates</h1><p><a href="https://redux-toolkit.js.org/rtk-query/usage/optimistic-updates" target="_blank" rel="noopener">https://redux-toolkit.js.org/rtk-query/usage/optimistic-updates</a></p>
<p>useMutation을 통해 이미 존재하고 있는 일부 데이터에 대한 업데이트를 수행하고자 할 때 RTK Query는 optimistic 업데이트를 실행하기 위한 몇가지 tool을 제공한다. 이는 사용자에게 변경사항이 즉시 적용된다는 인상을 주고 싶을 때 유용한 패턴이다.</p>
<p>핵심 개념은 다음과 같다:</p>
<ul>
<li>quey 또는 mutation이 시작 될 때 , onQueryStarted가 실행된다.</li>
<li><code>api.util.updateQueryData</code> 를 통해 캐시된 데이터를 수동으로 업데이트한다.</li>
<li>promiseResult가 reject일 때 <code>.undo</code> 를 통해 이전 디스패치에서 반환된 객체의 속성으로 롤백한다.</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Optimistic update mutation example (async await)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Post &#125; <span class="keyword">from</span> <span class="string">'./types'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> api = createApi(&#123;</span><br><span class="line">  baseQuery: fetchBaseQuery(&#123;</span><br><span class="line">    baseUrl: <span class="string">'/'</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  tagTypes: [<span class="string">'Post'</span>],</span><br><span class="line">  endpoints: <span class="function">(<span class="params">build</span>) =&gt;</span> (&#123;</span><br><span class="line">    getPost: build.query&lt;Post, number&gt;(&#123;</span><br><span class="line">      query: <span class="function">(<span class="params">id</span>) =&gt;</span> <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">      providesTags: [<span class="string">'Post'</span>],</span><br><span class="line">    &#125;),</span><br><span class="line">    updatePost: build.mutation&lt;<span class="keyword">void</span>, Pick&lt;Post, <span class="string">'id'</span>&gt; &amp; Partial&lt;Post&gt;&gt;(&#123;</span><br><span class="line">      query: <span class="function">(<span class="params">&#123; id, ...patch &#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">        url: <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">        method: <span class="string">'PATCH'</span>,</span><br><span class="line">        body: patch,</span><br><span class="line">      &#125;),</span><br><span class="line">      invalidatesTags: [<span class="string">'Post'</span>],</span><br><span class="line">      <span class="keyword">async</span> onQueryStarted(&#123; id, ...patch &#125;, &#123; dispatch, queryFulfilled &#125;) &#123;</span><br><span class="line">        <span class="keyword">const</span> patchResult = dispatch(</span><br><span class="line">          api.util.updateQueryData(<span class="string">'getPost'</span>, id, (draft) =&gt; &#123;</span><br><span class="line">            <span class="built_in">Object</span>.assign(draft, patch)</span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">await</span> queryFulfilled</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">          patchResult.undo()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<p><em>References</em><br><a href="https://redux-toolkit.js.org/rtk-query/usage/mutations" target="_blank" rel="noopener">RTK Query Mutations</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/08/18/210819_rtkQuery/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/18/210819_rtkQuery/" class="post-title-link" itemprop="url">RTK Query Overview 원문 번역</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-08-19 00:00:00" itemprop="dateCreated datePublished" datetime="2021-08-19T00:00:00+09:00">2021-08-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-16 15:45:41" itemprop="dateModified" datetime="2022-05-16T15:45:41+09:00">2022-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문링크: <a href="https://redux-toolkit.js.org/rtk-query/overview" target="_blank" rel="noopener">https://redux-toolkit.js.org/rtk-query/overview</a></p>
</blockquote>
<p>RTK Query는 강력한 data fetching과 caching 툴이다. 웹 어플리케이션 내에서 데이터를 로딩할 때 사용되는 common case들을 단순화 하기 위해 고안되었기 때문에 data fetching과 캐싱 로직을 직접 작성할 필요가 없다. Redux Tookit 패키지에서 선택적 옵션으로 포함되어 있고, Redux Tookit 기능적으로 다른 api위에 구축된다.</p>
<h1 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h1><p>웹 어플리케이션은 보통 data를 화면에 그리기 위해 서버로부터 data를 fetch해서 가져와야 한다. 또 이 data를 업데이트 하거나 업데이트할 내용을 서버에 보내고, 서버의 데이터와 싱크를 맞추기 위해 client측에서 데이터를 캐시해서 가지고 있기도 한다. 오늘날을 어플리케이션 내에서 아래와 같은 다양한 행동이 실행되기 때문에 이 과정이 더욱 복잡하다.</p>
<ul>
<li>UI spinners를 보여주기 위해 loading 상태일 때를 추적한다.</li>
<li>같은 데이터를 사용할 때 중복 요청을 막는다</li>
<li>UI가 보다 빠르게 느끼도록 하는 updates</li>
<li>UI와 유저 인터페이스의 상호작용을 위한 캐시 수명(사이클) 매니징</li>
</ul>
<p>Redux 코어는 늘 최소화되어 왔기 때문에 실제 로직을 작성하는 것은 개발자에게 달려있다. 이는 리덕스가 위와 같은 사용 사례를 해결하기 위한 어떠한 것도 내부에 포함하고 있지 않다는 의미이다. 리덕스 도큐먼트에서는 로딩 스테이트와 요청 결과를 트래킹하기 위한 요청 수명(사이클)이 몇 가지 일반적인 패턴이 있다고 가르쳐왔다. 그리고 Redux Toolkit의 createAsyncThunk는 이러한 전형적인 패턴을 추상화하여 고안된 것이다. 그러나 유저는 아직도 상당한 리듀서 로직을 로딩 스테이트와 데이터 캐시를 위해 사용해야 한다.</p>
<p>지난 몇 년간, 리액트 커뮤니티는 “data fetching과 캐싱’이 state management와 완전히 다른 관심사라는 것을 깨달았다. Redux와 같은 상태관리 라이브러리를 사용해서 데이터를 캐시할 수 있자만, 데이터 fetching과 같은 상황에서 쓸 목적으로 만들어진 별도의 툴을 사용해도 될 만큼 의미있다.</p>
<p>RTK Query는 Apollo Client, React Query, Urql 및 SWR과 같이 data fetching을 위한 선구적인 솔루션 툴들로부터 영감을 받았지만, API 디자인에 고유한 접근 방식을 추가했다.</p>
<ul>
<li>data fetching과 캐싱 로직은 Redux toolkit의 createSlice와 createAsyncThunk api를 기반으로 구축된다.</li>
<li>왜냐하면 redux toolkit은 UI에 구애받지 않는 UI-agnostic이기 때문에, RTK 쿼리는 모든 UI layer에서 사용할 수 있다.</li>
<li>api endpoint는 인수를 통해 어떻케 쿼리 파라미터를 생성할 것인지와 캐싱을 위해 어떻게 응답을 변환할 것인지를 포함하여 미리 정의된다.</li>
<li>RTK Query는 react hook을 생성하여 전체 data fetching과정을 캡슐화하고, 컴포넌트에 data와 isLoading필드를 제공하고, 컴포넌트가 마운트되거나 언마운트될 때 캐시된 데이터의 수명을 관리한다.</li>
<li>RTK Query는 “cache entry lifecycle”옵션을 제공하는데, 이 옵션을 사용하면 초기 데이터를 fetching한 후에 웹소켓 메세지를 통해 스트리밍 캐시 업데이트 등과 같은 경우에 사용할 수 있도록 활성화 된다.</li>
<li>openAPI 또는 GraphQL 스키마에서 API slice의 코드 생성에 대한 예를 찾을 수 있다.</li>
<li>RTK Query는 완전히 TypeScript로 쓰여져 있기 때문에 TS 사용에 대한 좋은 경험을 제공할 수 있다.</li>
</ul>
<hr>
<h1 id="포함된-것"><a href="#포함된-것" class="headerlink" title="포함된 것"></a>포함된 것</h1><h2 id="APIs"><a href="#APIs" class="headerlink" title="APIs"></a>APIs</h2><p>RTK Query는 Redux Toolkit 패키지의 코어를 설치하면 그곳에 포함되어 있다. 아래 두 엔트리 포인트 중 한 가지로 사용할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* React-specific entry point that automatically generates</span></span><br><span class="line"><span class="comment">   hooks corresponding to the defined endpoints */</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span>;</span><br></pre></td></tr></table></figure>
<p>RTK Query에는 다음의 API가 포함된다.</p>
<ul>
<li>createApi(): RTK Query의 핵심기능이다. 여러 엔드포인트들로부터 데이터를 어떻게 회수할 것인지가 작성된 여러 엔드포인트들을 정의하고, 여기에는 데이터를 어떻게 fetch하거나 변환할 것인지에 대한 내용이 담긴다. 대부분의 경우 app에서 “하나의 base URL 당 하나의 API 슬라이스”를 사용하여 한 번만 작성되어야 한다.</li>
<li>fetchBaseQuery(): 요청을 단순화하는 것을 목표로 하는 fetch를 감싸는 작은 Wrapper이다. 대부분의 사용자에게는 createApi에서 baseQuery로 사용할 것이 권장된다.</li>
<li><ApiProvider/>: Redux 스토어가 없는 경우에도 Provider로써 사용할 수 있다.</li>
<li>setupListeners(): refetchOnMounte와 refetchOnReconnect를 사용할 수 있게 하는 유틸리티이다.</li>
</ul>
<h3 id="번들-크기"><a href="#번들-크기" class="headerlink" title="번들 크기"></a>번들 크기</h3><p>RTK 쿼리는 앱의 번들 사이즈에 고정된 일회성 사이즈로 추가된다. RTK Query는 Redux Toolkit과 React-Redux의 가장 상단에서 빌드되기 때문에 이렇게 추가된 사이즈는 이미 사용자가 app에서 이것을 쓰고 있는지 아닌지에 따라 다르다. 예상되는 min+gzip 번들 크기는 다음과 같다.</p>
<ul>
<li>RTK를 이미 사용하고 있는 경우: RTK 쿼리의 경우 ~9kb, hooks의 경우 ~2kb.</li>
<li>RTK를 이미 사용하지 않는 경우:<ul>
<li>React 없음: RTK+dependencies+RTK 쿼리의 경우 17kB</li>
<li>React 사용 시: 19kB + React-Redux, which is a peer dependency</li>
</ul>
</li>
</ul>
<p>endpoint들의 정의를 추가적으로 포함하고자 하면 보통 몇 바이트에 불과한 endpoints 정의 내부의 실제 코드에 근거하여 크기만 증가해야 한다</p>
<p>RTK 쿼리에 포함된 기능은 추가된 번들 크기에 대한 비용을 빠르게 지불하는 것을 포함하기 때문에 직접 작성한 data fetching 로직을 제거하면 대부분의 의미있는 응용 프로그램에서 size가 향상된다.</p>
<hr>
<h2 id="기본-사용법"><a href="#기본-사용법" class="headerlink" title="기본 사용법"></a>기본 사용법</h2><h3 id="Create-an-API-Slice"><a href="#Create-an-API-Slice" class="headerlink" title="Create an API Slice"></a>Create an API Slice</h3><p>RTK Query는 Redux Toolkit 패키지의 코어를 설치하면 그곳에 포함되어 있다. 아래 두 엔트리 포인트 중 한 가지로 사용할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* React-specific entry point that automatically generates</span></span><br><span class="line"><span class="comment">   hooks corresponding to the defined endpoints */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export hooks를 쓰려면 반드시 /react로 사용</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span>;</span><br></pre></td></tr></table></figure>
<p>React에서 일반적인 사용법은 createApi를 임포트하는 것으로 시작하여 서버의 base url을 정리하고, 접근하고자 하는 엔드포인트를 정리하기 위한 “API slice”를 정의한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Pokemon &#125; <span class="keyword">from</span> <span class="string">'./types'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Define a service using a base URL and expected endpoints</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> pokemonApi = createApi(&#123;</span><br><span class="line">  reducerPath: <span class="string">'pokemonApi'</span>,</span><br><span class="line">  baseQuery: fetchBaseQuery(&#123; <span class="attr">baseUrl</span>: <span class="string">'https://pokeapi.co/api/v2/'</span> &#125;),</span><br><span class="line">  endpoints: <span class="function">(<span class="params">builder</span>) =&gt;</span> (&#123;</span><br><span class="line">    getPokemonByName: builder.query&lt;Pokemon, string&gt;(&#123;</span><br><span class="line">      query: <span class="function">(<span class="params">name</span>) =&gt;</span> <span class="string">`pokemon/<span class="subst">$&#123;name&#125;</span>`</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Export hooks for usage in functional components, which are</span></span><br><span class="line"><span class="comment">// auto-generated based on the defined endpoints</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; useGetPokemonByNameQuery &#125; = pokemonApi</span><br></pre></td></tr></table></figure>
<h2 id="스토어-구성"><a href="#스토어-구성" class="headerlink" title="스토어 구성"></a>스토어 구성</h2><p>“API slice”에는 자동으로 생성되는 slice 리듀서와 구독 수명주기를 매니지 할 수 있는 커스텀 미들웨어를 포함하고 있다. 이 두 가지 모두 Redux 스토어에 추가해야 한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="comment">// Or from '@reduxjs/toolkit/query/react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; setupListeners &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; pokemonApi &#125; <span class="keyword">from</span> <span class="string">'./services/pokemon'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: &#123;</span><br><span class="line">    <span class="comment">// Add the generated reducer as a specific top-level slice</span></span><br><span class="line">    [pokemonApi.reducerPath]: pokemonApi.reducer,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// Adding the api middleware enables caching, invalidation, polling,</span></span><br><span class="line">  <span class="comment">// and other useful features of `rtk-query`.</span></span><br><span class="line">  middleware: <span class="function">(<span class="params">getDefaultMiddleware</span>) =&gt;</span></span><br><span class="line">    getDefaultMiddleware().concat(pokemonApi.middleware),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// optional, but required for refetchOnFocus/refetchOnReconnect behaviors</span></span><br><span class="line"><span class="comment">// see `setupListeners` docs - takes an optional callback as the 2nd arg for customization</span></span><br><span class="line">setupListeners(store.dispatch);</span><br></pre></td></tr></table></figure>
<h2 id="컴포넌트에-hooks사용"><a href="#컴포넌트에-hooks사용" class="headerlink" title="컴포넌트에 hooks사용"></a>컴포넌트에 hooks사용</h2><p>마지막으로 API slice에서 자동 생성된 react hook을 컴포넌트 파일로 임포트 하고, 컴포넌트에서 필요한 파라미터를 사용하여 hooks를 호출한다. RTK Query는 mount될 때 자동으로 data를 fetch하고, 파라미터가 변경될때 re-fetch하며, 결과에 {data, isFetching} 값을 제공한다. 그리고 이 값들이 변경되면 컴포넌트를 리렌더링한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useGetPokemonByNameQuery &#125; <span class="keyword">from</span> <span class="string">'./services/pokemon'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Using a query hook automatically fetches data and returns query values</span></span><br><span class="line">  <span class="keyword">const</span> &#123; data, error, isLoading &#125; = useGetPokemonByNameQuery(<span class="string">'bulbasaur'</span>);</span><br><span class="line">  <span class="comment">// Individual hooks are also accessible under the generated endpoints:</span></span><br><span class="line">  <span class="comment">// const &#123; data, error, isLoading &#125; = pokemonApi.endpoints.getPokemonByName.useQuery('bulbasaur')</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// render UI based on data and loading state</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="사용예시"><a href="#사용예시" class="headerlink" title="사용예시"></a>사용예시</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//dosApiSlice.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> DOGS_API_KEY = <span class="string">'4902a53c-cfda-44e4-a5d7-35b9bd5b6cb9'</span>;</span><br><span class="line"></span><br><span class="line">interface Breed &#123;</span><br><span class="line">  id: string;</span><br><span class="line">  name: string;</span><br><span class="line">  image: &#123;</span><br><span class="line">    url: string;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//api slice</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> apiSlice = createApi(&#123;</span><br><span class="line">  reducerPath: <span class="string">'api'</span>,</span><br><span class="line">  baseQuery: fetchBaseQuery(&#123;</span><br><span class="line">    baseUrl: <span class="string">'https://api.thedogapi.com/v1'</span>,</span><br><span class="line">    prepareHeaders(headers) &#123;</span><br><span class="line">      headers.set(<span class="string">'x-api-key'</span>, DOGS_API_KEY);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> headers;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="comment">//builder에 의해 엔트리 포인트 생성</span></span><br><span class="line">  endpoints(builder) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      fetchBreeds: builder.query&lt;Breed[], number | <span class="keyword">void</span>&gt;(&#123;</span><br><span class="line">        query(limit = <span class="number">10</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">`/breeds?limit=<span class="subst">$&#123;limit&#125;</span>`</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; useFetchBreedsQuery &#125; = apiSlice;</span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//store.ts</span></span><br><span class="line"><span class="comment">//configureStore: basic redux create store function의 wrapper</span></span><br><span class="line"><span class="comment">//create store</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; configureStore, getDefaultMiddleware &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="keyword">import</span> counterReducer <span class="keyword">from</span> <span class="string">'../features/counter/counter-slice'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; apiSlice &#125; <span class="keyword">from</span> <span class="string">'../features/dogs/dogsApiSlice'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//combine reducer</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: &#123;</span><br><span class="line">    counter: counterReducer,</span><br><span class="line">    [apiSlice.reducerPath]: apiSlice.reducer,</span><br><span class="line">  &#125;,</span><br><span class="line">  middleware: <span class="function">(<span class="params">getDefaultMiddleware</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> getDefaultMiddleware().concat(apiSlice.middleware);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ts thing</span></span><br><span class="line"><span class="keyword">export</span> type AppDispatch = <span class="keyword">typeof</span> store.dispatch;</span><br><span class="line"><span class="keyword">export</span> type RootState = ReturnType&lt;<span class="keyword">typeof</span> store.getState&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//사용하고자 하는 곳에서 사용</span></span><br><span class="line"><span class="keyword">import</span> &#123; useFetchBreedsQuery &#125; <span class="keyword">from</span> <span class="string">'./features/dogs/dogsApiSlice'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//take selector function</span></span><br><span class="line">  <span class="keyword">const</span> count = useAppSelector(<span class="function">(<span class="params">state</span>) =&gt;</span> state.counter.value);</span><br><span class="line">  <span class="keyword">const</span> dispatch = useAppDispatch();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [numDogs, setNumDogs] = useState(<span class="number">10</span>);</span><br><span class="line">  <span class="keyword">const</span> &#123; data = [], isFetching &#125; = useFetchBreedsQuery(numDogs);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(useFetchBreedsQuery);</span><br></pre></td></tr></table></figure>
<hr>
<p><em>References</em><br><a href="https://redux-toolkit.js.org/rtk-query/overview" target="_blank" rel="noopener">RTK Query Overview</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/07/30/210731_reduxToolkit-Ts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/30/210731_reduxToolkit-Ts/" class="post-title-link" itemprop="url">Redux-tookit-typescript 원문 번역</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-31 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-31T00:00:00+09:00">2021-07-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-16 15:45:41" itemprop="dateModified" datetime="2022-05-16T15:45:41+09:00">2022-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Redux-toolkit-typescript-원문-번역"><a href="#Redux-toolkit-typescript-원문-번역" class="headerlink" title="Redux-toolkit-typescript 원문 번역"></a>Redux-toolkit-typescript 원문 번역</h2><blockquote>
<p>원문링크: <a href="https://redux-toolkit.js.org/tutorials/typescript" target="_blank" rel="noopener">https://redux-toolkit.js.org/tutorials/typescript</a></p>
</blockquote>
<h2 id="Usage-With-TypeScript"><a href="#Usage-With-TypeScript" class="headerlink" title="Usage With TypeScript"></a>Usage With TypeScript</h2><p>Redux Toolkit은 이미 TypeScript로 작성되었으므로 TS 유형 정의가 내장되어 있다. React Redux 는 NPM 의 별도 @types/react-reduxtypedef 패키지 에 type에 대한 정의가 있다. 라이브러리 함수를 작성하는 것 외에도 type은 리덕스 스토어와 리액트 컴포넌트 사이의 인터페이스를 보다 typesage하게 작성하는 것을 쉽게 하도록 도와주는 helper를 export한다.</p>
<p>React Redux v7.2.3부터는 react-redux 패키지가 @types/react-redux에 종속되어서 type 정의는 자동으로 라이브러리와 함께 설치된다. 그렇지 않은 경우에는 직접 수동으로 설치해야 한다. (npm install @types/react-redux)</p>
<p><a href="https://github.com/reduxjs/cra-template-redux-typescript" target="_blank" rel="noopener">The Redux+TS template for Create-React-App</a> comes with a working example of these patterns already configured.</p>
<h1 id="Project-Setup"><a href="#Project-Setup" class="headerlink" title="Project Setup"></a>Project Setup</h1><p>Root State 및 Dispatch Types 정의</p>
<p>configureStore를 사용하면 추가 입력이 필요하지 않다. 하지만 추후에 필요에 따라 참조할 수 있도록 RootState type과 Dispatch type을 추출하고자 하게 된다. 스토어 자체에서 이러한 타입들을 추론한다는 것은 state slice를 추가하거나 미들웨어 세팅을 수정할 때 올바르게 업데이트 된다는 것을 의미한다.</p>
<p>이것들은 모두 type이기 때문에 app/store.ts와 같이 스토어 셋업 파일에서 직접 export하여 다른 파일로 import하는 것이 안전하다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: &#123;</span><br><span class="line">    posts: postsReducer,</span><br><span class="line">    comments: commentsReducer,</span><br><span class="line">    users: usersReducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Infer the `RootState` and `AppDispatch` types from the store itself</span></span><br><span class="line"><span class="comment">//RooteState와 AppDispatch가 스토어 자체에서 추론된다.</span></span><br><span class="line"><span class="keyword">export</span> type RootState = ReturnType&lt;<span class="keyword">typeof</span> store.getState&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 추론된 타입:</span></span><br><span class="line"><span class="comment">// Inferred type: &#123;posts: PostsState, comments: CommentsState, users: UsersState&#125;</span></span><br><span class="line"><span class="keyword">export</span> type AppDispatch = <span class="keyword">typeof</span> store.dispatch;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Define-Typed-Hooks"><a href="#Define-Typed-Hooks" class="headerlink" title="Define Typed Hooks"></a>Define Typed Hooks</h2><p>RooteState와 AppDispatch를 type들을 각각 컴포넌트로 import할 수 있지만, 어플리케이션에서 사용할 수 있도록 타입이 지정된 버전의 useDispatch, useSelector 훅을 사용하는 것이 좋다. 그 이유는 아래와 같다.</p>
<ul>
<li>useSelector를 쓰면 매번 (state:RootState)를 사용할 필요가 없다.</li>
<li>useDispatch를 쓰면 기본 dispatch 타입은 thunk에 대해 알지 못한다. thunk를 올바르게 쓰기 위해서는thunk middlewate type을 포함한 스토어의 특정하게 커스텀된 AppDispatch를 useDispatch와 함께 사용해야 한다. 미리 유형이 정의된 <strong>useDispatch 훅을 추가하고자 할 때는 사용하고자 하는 곳에 AppDispatch를 import해야 하는 것을 잊지 않도록 한다.</strong></li>
</ul>
<p>이들은 type이 아니라 실제 변수이기 때문에 store setup 파일보다는 <strong>app/hooks.ts와 같은 별도의 파일에 정의하는 것이 중요하다.</strong> 이를 통해 hook을 쓰고자 하는 어떠한 파일에서든 hook을 import할 수 있게하고, 잠재적인 import 디펜던시 이슈를 피할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/hook.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; TypedUseSelectorHook, useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"><span class="keyword">import</span> type &#123; RootState, AppDispatch &#125; <span class="keyword">from</span> <span class="string">'./store'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Use throughout your app instead of plain `useDispatch` and `useSelector`</span></span><br><span class="line"><span class="comment">// 원형의 useDispatch, useSelector 대신 아래를 사용한다.</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAppDispatch = <span class="function"><span class="params">()</span> =&gt;</span> useDispatch&lt;AppDispatch&gt;()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAppSelector: TypedUseSelectorHook&lt;RootState&gt; = useSelector</span><br></pre></td></tr></table></figure>
<h2 id="Application-Usage"><a href="#Application-Usage" class="headerlink" title="Application Usage"></a>Application Usage</h2><p><code>slice state 및 액션 타입의 정의</code></p>
<p>각각의 slice file은 초기 상태값에 대한 type을 정의해야 createSlice가 각각의 case 리듀서에 있는 state type을 올바르게 추론할 수 있다.</p>
<p>생성된 모든 액션들은 action.payload를 일반적인 인수로 사용하는 Redux Toolkit의 PayloadAction<T> 타입을 사용해서 정의해야 한다.</p>
<p>여기서 store 파일로부터 RootState를 안전하게 import 할 수 있다. circular import이긴 하지만 typsScript 컴파일러가 type을 올바르게 처리할 수 있다. 이는 selector 함수를 작성할 때 필요할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSlice, PayloadAction &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="keyword">import</span> type &#123; RootState &#125; <span class="keyword">from</span> <span class="string">'../../app/store'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Define a type for the slice state</span></span><br><span class="line">interface CounterState &#123;</span><br><span class="line">  value: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Define the initial state using that type</span></span><br><span class="line"><span class="keyword">const</span> initialState: CounterState = &#123;</span><br><span class="line">  value: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> counterSlice = createSlice(&#123;</span><br><span class="line">  name: <span class="string">'counter'</span>,</span><br><span class="line">  <span class="comment">// `createSlice` will infer the state type from the `initialState` argument</span></span><br><span class="line">  initialState,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    increment: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.value += <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    decrement: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.value -= <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// Use the PayloadAction type to declare the contents of `action.payload`</span></span><br><span class="line">    incrementByAmount: <span class="function">(<span class="params">state, action: PayloadAction&lt;number&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      state.value += action.payload;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; increment, decrement, incrementByAmount &#125; = counterSlice.actions;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Other code such as selectors can use the imported `RootState` type</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> selectCount = <span class="function">(<span class="params">state: RootState</span>) =&gt;</span> state.counter.value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> counterSlice.reducer;</span><br></pre></td></tr></table></figure>
<p>생성된 action creator는 작성자가 reducer에 제공한 PayloadAction<T>의 타입 기반으로 payload의 인수를 수락하도록 올바르게 입력됩니다. 예를 들어, 위 코드에서 incrementByAmountsms 인수로 number를 필요로 한다.</p>
<p>몇몇 케이스에선 typeScript가 초기 상태의 type을 불필요하게 tigth하게 만들 수 있다. 만약 이런 일이 발생한다면 변수의 type을 선언하는 대신 <code>as</code> 를 이용해서 초기 상태를 캐스팅하는 방법으로 해결할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Workaround: cast state instead of declaring variable type</span></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  value: <span class="number">0</span>,</span><br><span class="line">&#125; <span class="keyword">as</span> CounterState</span><br></pre></td></tr></table></figure>
<h1 id="Use-Typed-Hooks-in-Components"><a href="#Use-Typed-Hooks-in-Components" class="headerlink" title="Use Typed Hooks in Components"></a>Use Typed Hooks in Components</h1><p>컴포넌트 파일에서 React-Redux의 표준 hook 대신 미리 입력된 hook을 가져온다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector, useAppDispatch &#125; <span class="keyword">from</span> <span class="string">'app/hooks'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; decrement, increment &#125; <span class="keyword">from</span> <span class="string">'./counterSlice'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// The `state` arg is correctly typed as `RootState` already</span></span><br><span class="line">  <span class="keyword">const</span> count = useAppSelector(<span class="function">(<span class="params">state</span>) =&gt;</span> state.counter.value);</span><br><span class="line">  <span class="keyword">const</span> dispatch = useAppDispatch();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// omit rendering logic</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Usage-With-TypeScript-1"><a href="#Usage-With-TypeScript-1" class="headerlink" title="Usage With TypeScript"></a>Usage With TypeScript</h1><blockquote>
<p><a href="https://redux-toolkit.js.org/usage/usage-with-typescript" target="_blank" rel="noopener">https://redux-toolkit.js.org/usage/usage-with-typescript</a></p>
</blockquote>
<p>리덕스 툴킷은 typeScript로 작성되었으며, 해당 API는 TypeScript 응용 프로그램과의 뛰어난 통합을 가능하게 하도록 설계되었다.</p>
<h2 id="configureStore"><a href="#configureStore" class="headerlink" title="configureStore"></a>configureStore</h2><h3 id="state-type-가져오기"><a href="#state-type-가져오기" class="headerlink" title="state type 가져오기"></a>state type 가져오기</h3><p>state type을 가져오는 가장 쉬운 방법은 roote reducer를 미리 정의하고, returnType을 추출하는 것이다. 쇼type 이름인 state는 일반적으로 남용되기 깨문에 혼동을 막기 위해 RootState와 같이 type에 다른 이름을 주는 것을 추천한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="keyword">const</span> rootReducer = combineReducers(&#123;&#125;);</span><br><span class="line"><span class="keyword">export</span> type RootState = ReturnType&lt;<span class="keyword">typeof</span> rootReducer&gt;;</span><br></pre></td></tr></table></figure>
<p>혹은 rootReducer를 직접 생성하지 않고 직접 configureStore()에 slice reducer 전달 할 수 있다. 이 경우 root reducer를 올바르게 추론하기 위해 Type을 약간 수정해야 한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: &#123;</span><br><span class="line">    one: oneSlice.reducer,</span><br><span class="line">    two: twoSlice.reducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> type RootState = ReturnType&lt;<span class="keyword">typeof</span> store.getState&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>
<h3 id="Dispatch-타입-가져오기"><a href="#Dispatch-타입-가져오기" class="headerlink" title="Dispatch 타입 가져오기"></a>Dispatch 타입 가져오기</h3><p>스토어에서 Dispatch 타입을 가져오려면 store를 생성한 후에 추출해야 한다. 이 역시 Dispatch는 남용되기 때문에 혼동을 막기 위해 AppDispatch처럼 다른 type 이름을 지정할 것을 추천한다. 혹은 아래처럼 useAppDispatch hook을 추출하여 useDispatch를 호출할 때 사용하는 것이 더 편할 수 도 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span></span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"><span class="keyword">import</span> rootReducer <span class="keyword">from</span> <span class="string">'./rootReducer'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: rootReducer,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type AppDispatch = <span class="keyword">typeof</span> store.dispatch</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAppDispatch = <span class="function"><span class="params">()</span> =&gt;</span> useDispatch&lt;AppDispatch&gt;()</span><br><span class="line"><span class="comment">// Export a hook that can be reused to resolve types</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>
<h3 id="Dispatch-타입에-대한-올바른-입력"><a href="#Dispatch-타입에-대한-올바른-입력" class="headerlink" title="Dispatch 타입에 대한 올바른 입력"></a>Dispatch 타입에 대한 올바른 입력</h3><p>dispatch 함수의 typedms 미들웨어 옵션에 의해 직접 추론될 수 있다. 만약 미들웨어에 올바른 타입을 추가하고 싶다면 dispatch는 이미 올바르게 입력되어 있어야 한다.</p>
<p>typeScript는 스프레드 연산자를 사용해서 배열을 합칠 때 array type을 확장하는 경우가 많기 때문에 getDefaultMiddleware()에 의해 리턴되는 MiddlewareArray 메소드에서 .concat(…) 또는 .prepend(…)를 사용하는 것이 추천된다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span></span><br><span class="line"><span class="keyword">import</span> additionalMiddleware <span class="keyword">from</span> <span class="string">'additional-middleware'</span></span><br><span class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">'redux-logger'</span></span><br><span class="line"><span class="comment">// @ts-ignore</span></span><br><span class="line"><span class="keyword">import</span> untypedMiddleware <span class="keyword">from</span> <span class="string">'untyped-middleware'</span></span><br><span class="line"><span class="keyword">import</span> rootReducer <span class="keyword">from</span> <span class="string">'./rootReducer'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type RootState = ReturnType&lt;<span class="keyword">typeof</span> rootReducer&gt;</span><br><span class="line"><span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: rootReducer,</span><br><span class="line">  middleware: <span class="function">(<span class="params">getDefaultMiddleware</span>) =&gt;</span></span><br><span class="line">    getDefaultMiddleware()</span><br><span class="line">      .prepend(</span><br><span class="line">        <span class="comment">// correctly typed middlewares can just be used</span></span><br><span class="line">        additionalMiddleware,</span><br><span class="line">        <span class="comment">// you can also type middlewares manually</span></span><br><span class="line">        untypedMiddleware <span class="keyword">as</span> Middleware&lt;</span><br><span class="line">          (action: Action&lt;<span class="string">'specialAction'</span>&gt;) =&gt; number,</span><br><span class="line">          RootState</span><br><span class="line">        &gt;</span><br><span class="line">      )</span><br><span class="line">      <span class="comment">// prepend and concat calls can be chained</span></span><br><span class="line">      .concat(logger),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type AppDispatch = <span class="keyword">typeof</span> store.dispatch</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>
<h3 id="getDefaultMiddleware-없이-MiddlewareArray-사용"><a href="#getDefaultMiddleware-없이-MiddlewareArray-사용" class="headerlink" title="getDefaultMiddleware 없이 MiddlewareArray 사용"></a>getDefaultMiddleware 없이 MiddlewareArray 사용</h3><p>getDefaultMiddleware의 사용을 완전히 스킵할 경우, 미들웨어 배열의 안전한 타입 연결에 MiddlewareArray를 사용할 수 있다. 이 class는 .concat(…) 및 추가적인 .prepend(…) 메서드에 대한 수정된 유형만 사용하여 기본 JavaScript 배열 유형을 확장한다.</p>
<p>하지만 const로 사용하고, 스프레드 연산자를 사용하지 않는 한 배열 유형을 확장하는 문제가 발생하지 않기 때문에 일반적으로 필요하지는 않다.</p>
<p>다음의 두 가지 호출은 동일하다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore, MiddlewareArray &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span></span><br><span class="line"></span><br><span class="line">configureStore(&#123;</span><br><span class="line">  reducer: rootReducer,</span><br><span class="line">  middleware: <span class="keyword">new</span> MiddlewareArray().concat(additionalMiddleware, logger),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">configureStore(&#123;</span><br><span class="line">  reducer: rootReducer,</span><br><span class="line">  middleware: [additionalMiddleware, logger] <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="React-Redux에서-추출한-Dispatch-type-사용"><a href="#React-Redux에서-추출한-Dispatch-type-사용" class="headerlink" title="React Redux에서 추출한 Dispatch type 사용"></a>React Redux에서 추출한 Dispatch type 사용</h2><p>기본적으로 React Redux useDispatch 훅에는 미들웨어를 고려하는 type이 포함되어 있지 않다. 만약 dispatching을 할 때 dispatch 함수에 대해 더 구체적인 type이 필요한 경우에는 dispatch 함수의 type을 지정하거나, custom-type이 된 버전의 useSelector를 만들어서 사용한다. (<a href="https://react-redux.js.org/using-react-redux/usage-with-typescript#typing-the-usedispatch-hook" target="_blank" rel="noopener">자세한 내용은 이곳 참조</a>)</p>
<h3 id="createAction"><a href="#createAction" class="headerlink" title="createAction"></a>createAction</h3><p>대부분의 케이스에서 action.type에 대한 리터럴 정의는 필요하지 않기 때문에 아래와 같은 코드를 사용할 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createAction&lt;number&gt;(&#39;test&#39;);</span><br></pre></td></tr></table></figure>
<p>이렇게 하면 생성된 action이 PayloadActionCreator<number, string>의 타입이 된다.</p>
<p>일부 설정에서는 action.type에 대한 리터럴 설정이 필요할 수도 있다. 하지만 typeScript는 수동으로 정의된 타입 매개변수와 추론된 타입 매개변수의 혼합을 허용하지 않기 때문에 일반 정의와 실제 JavaScript 코드 모두에서 타입을 지정해야 합니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createAction&lt;number, &#39;test&#39;&gt;(&#39;test&#39;);</span><br></pre></td></tr></table></figure>
<p>중복 없이 이것을 작성하는 다른 방법을 찾고 있다면, callback을 준비하여 두 type 파라미터를 인수에서 추론할 수 있으므로 action type을 특정할 필요가 없다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function withPayloadType&lt;T&gt;() &#123;</span><br><span class="line">  return (t: T) &#x3D;&gt; (&#123; payload: t &#125;);</span><br><span class="line">&#125;</span><br><span class="line">createAction(&#39;test&#39;, withPayloadType&lt;string&gt;());</span><br></pre></td></tr></table></figure>
<h3 id="리터럴하게-입력된-action-type의-대안"><a href="#리터럴하게-입력된-action-type의-대안" class="headerlink" title="리터럴하게 입력된 action.type의 대안"></a>리터럴하게 입력된 action.type의 대안</h3><p>예를 들어 case문에서 payload type을 올바르게 작성하기 위해 action.type을 유니온 식별을 위한 식별자로 사용하는 경우 이 대안에 관심이 있을 수 있다.</p>
<p>생성된 action creators는 <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates" target="_blank" rel="noopener">type predicate</a>로써 match 메소드를 가진다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const increment &#x3D; createAction&lt;number&gt;(&#39;increment&#39;);</span><br><span class="line">function test(action: Action) &#123;</span><br><span class="line">  if (increment.match(action)) &#123;</span><br><span class="line">    &#x2F;&#x2F; action.payload inferred correctly here</span><br><span class="line">    action.payload;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이 match 메소드는 redux-observable과 RxJS의 filter 메소드를 조합하여 사용하는 경우에도 유용하다.</p>
<h3 id="createReducer"><a href="#createReducer" class="headerlink" title="createReducer"></a>createReducer</h3><p>createReducer의 기본 호출방법은 아래와 같이 “lookup table” / “map object”를 사용하는 것이다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">createReducer(0, &#123;</span><br><span class="line">  increment: (state, action: PayloadAction&lt;number&gt;) &#x3D;&gt; state + action.payload,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>하지만 key는 오직 문자열이기 때문에, API TypeScript를 사용할 경우 action type을 추론하거나 validate할 수 없다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  const increment &#x3D; createAction&lt;number, &#39;increment&#39;&gt;(&#39;increment&#39;);</span><br><span class="line">  const decrement &#x3D; createAction&lt;number, &#39;decrement&#39;&gt;(&#39;decrement&#39;);</span><br><span class="line">  createReducer(0, &#123;</span><br><span class="line">    [increment.type]: (state, action) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; action is any here</span><br><span class="line">    &#125;,</span><br><span class="line">    [decrement.type]: (state, action: PayloadAction&lt;string&gt;) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; even though action should actually be PayloadAction&lt;number&gt;, TypeScript can&#39;t detect that and won&#39;t give a warning here.</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>대안으로 RTK에 type-safe reducer builder API가 포함되어 있다.</p>
<hr>
<h1 id="Building-Type-Safe-Reducer-Argument-Objects"><a href="#Building-Type-Safe-Reducer-Argument-Objects" class="headerlink" title="Building Type-Safe Reducer Argument Objects"></a>Building Type-Safe Reducer Argument Objects</h1><p>createReducer에 대한 인수로 간단한 객체를 사용하는 대신, ActionReducerMapBuilder 인스턴스를 받는 콜백을 사용할 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const increment &#x3D; createAction&lt;number, &#39;increment&#39;&gt;(&#39;increment&#39;);</span><br><span class="line">const decrement &#x3D; createAction&lt;number, &#39;decrement&#39;&gt;(&#39;decrement&#39;);</span><br><span class="line">createReducer(0, (builder) &#x3D;&gt;</span><br><span class="line">  builder</span><br><span class="line">    .addCase(increment, (state, action) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; action is inferred correctly here</span><br><span class="line">    &#125;)</span><br><span class="line">    .addCase(decrement, (state, action: PayloadAction&lt;string&gt;) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; this would error out</span><br><span class="line">    &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>리듀서 인수 객체를 정의할 때 보다 엄격한 type 안정성이 필요한 경우에 사용이 추천된다.</p>
<h3 id="builder-addMatcher"><a href="#builder-addMatcher" class="headerlink" title="builder.addMatcher"></a>builder.addMatcher</h3><p>builder.addMatcher의 첫 번째 matcher에 <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates" target="_blank" rel="noopener">type predicate</a> 함수를 사용할 수 있다. 결과적으로 두번째 reducer 인수에 대한 action 인수는 typeScript에 의해 유츄될 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function isNumberValueAction(action: AnyAction): action is PayloadAction&lt;&#123; value: number &#125;&gt; &#123;</span><br><span class="line">  return typeof action.payload.value &#x3D;&#x3D;&#x3D; &#39;number&#39;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">createReducer(&#123; value: 0 &#125;, builder &#x3D;&gt;</span><br><span class="line">   builder.addMatcher(isNumberValueAction, (state, action) &#x3D;&gt; &#123;</span><br><span class="line">      state.value +&#x3D; action.payload.value</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="createSlice"><a href="#createSlice" class="headerlink" title="createSlice"></a>createSlice</h1><p>createSlice는 action 뿐만 아니라 reducer도 만드는데 여기서 type safety에 대해 걱정할 필요는 없다. action types는 인라인으로 제공될 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const slice &#x3D; createSlice(&#123;</span><br><span class="line">  name: &#39;test&#39;,</span><br><span class="line">  initialState: 0,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    increment: (state, action: PayloadAction&lt;number&gt;) &#x3D;&gt; state + action.payload,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">&#x2F;&#x2F; now available:</span><br><span class="line">slice.actions.increment(2);</span><br><span class="line">&#x2F;&#x2F; also available:</span><br><span class="line">slice.caseReducers.increment(0, &#123; type: &#39;increment&#39;, payload: 5 &#125;);</span><br></pre></td></tr></table></figure>
<p>케이스 리듀서가 너무 많아서 인라인으로 정의하는 것이 지저분하거나 슬라이스 전체에서 케이스 리듀서를 재사용하려는 경우 createSlice 외부에서 정의하여 호출하고 caseReducer처럼 입력할 수도 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">type State &#x3D; number;</span><br><span class="line">const increment: CaseReducer&lt;State, PayloadAction&lt;number&gt;&gt; &#x3D; (state, action) &#x3D;&gt;</span><br><span class="line">  state + action.payload;</span><br><span class="line"></span><br><span class="line">createSlice(&#123;</span><br><span class="line">  name: &#39;test&#39;,</span><br><span class="line">  initialState: 0,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    increment,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<hr>
<p><em>References</em></p>
<p><a href="https://redux-toolkit.js.org/introduction/getting-started#rtk-query" target="_blank" rel="noopener">Getting Started | Redux Toolkit</a><br><a href="https://youtu.be/9zySeP5vH9c" target="_blank" rel="noopener">Let’s Learn Modern Redux! (with Mark Erikson) - Learn With Jason</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/07/29/210730_reduxToolkit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/29/210730_reduxToolkit/" class="post-title-link" itemprop="url">Redux-tookit 원문 번역</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-30 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-30T00:00:00+09:00">2021-07-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-16 15:45:41" itemprop="dateModified" datetime="2022-05-16T15:45:41+09:00">2022-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Redux-toolkit-원문-번역"><a href="#Redux-toolkit-원문-번역" class="headerlink" title="Redux-toolkit 원문 번역"></a>Redux-toolkit 원문 번역</h2><blockquote>
<p>원문링크: <a href="https://redux-toolkit.js.org/introduction/getting-started#rtk-query" target="_blank" rel="noopener">https://redux-toolkit.js.org/introduction/getting-started#rtk-query</a></p>
</blockquote>
<p>Redux toolkt은 리덕스 로직을 표준화하기 위한 패키지이다. 원래는 리덕스가 가지고 있는 세가지 문제점을 지원하기 위해 만들어졌다.</p>
<ul>
<li>리덕스 스토어를 구성하는 방법이 지나치게 복잡하다.</li>
<li>리덕스를 사용하기 위해 많은 패키지를 설치해야 한다</li>
<li>리덕스는 지나치게 많은 보일러 플레이트 코드를 필요로 한다.</li>
</ul>
<p>리덕스가 가진 이러한 문제점에 대헤 모든 것을 커버할 순 없지만 create-react-app과 appllo-boost를 근간으로 하여 보다 추상화된 셋업 프로세스와 가장 많이 사용되는 use cases를 처리하기 위한 방법을 제공할 수 있을 뿐 아니라 사용자가 어플리케이션 코드를 단순화할 수 있는 유용한 유틸리티를 제공한다.</p>
<p>리덕스 툴킷은 또한 data fetching과 캐싱을 할 수 있는 ‘RTK Query’를 포함하는데, 별도의 엔트리포인트 set로 패키지 안에 포함되어 있다. 옵셔널이지만 직접 data fetching 로직을 작성하지 않아도 된다.<br>이 툴은 리덕스 유저들에게 유용하다. 만약 당신이 프로젝트에 리덕스를 처음 적용해보는 유저거나 어플리케이션 내에 존재하는 코드를 단순화 시키고자 하는 익숙한 리덕스 유저든, 리덕스 툴킷은 당신의 리덕스 코드를 훨씬 좋게 만들 것이다.</p>
<hr>
<h2 id="설치방법"><a href="#설치방법" class="headerlink" title="설치방법"></a>설치방법</h2><h3 id="Create-React-App을-이용"><a href="#Create-React-App을-이용" class="headerlink" title="Create React App을 이용"></a>Create React App을 이용</h3><p>가장 추천되는 방법으로 official Redux + JS template 또는 create React App용 Redux + Ts template을 사용하는 것이다. 이 템플릿은 redux toolkit 및 react redux 구성 요소의 통합을 활용한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Redux + Plain JS template</span><br><span class="line">npx create-react-app my-app --template redux</span><br><span class="line"></span><br><span class="line"># Redux + TypeScript template</span><br><span class="line">npx create-react-app my-app --template redux-typescript</span><br></pre></td></tr></table></figure>
<h3 id="기존-앱"><a href="#기존-앱" class="headerlink" title="기존 앱"></a>기존 앱</h3><p>redux toolkit은 모듈 번들러용 npm 패키지로 또는 노드 어플리케이션에서 사용 가능하다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># NPM</span><br><span class="line">npm install @reduxjs&#x2F;toolkit</span><br><span class="line"></span><br><span class="line"># Yarn</span><br><span class="line">yarn add @reduxjs&#x2F;toolkit</span><br></pre></td></tr></table></figure>
<p>또는 window.RTK의 전역 변수로 정의된 precompiled UMD package로 사용가능하다. UMD package는 <code>&lt;script&gt;</code>태그로 바로 사용할 수 있다.</p>
<hr>
<h2 id="Redux-toolkit에-포함된-것"><a href="#Redux-toolkit에-포함된-것" class="headerlink" title="Redux-toolkit에 포함된 것"></a>Redux-toolkit에 포함된 것</h2><ul>
<li><code>[configureStore()](https://redux-toolkit.js.org/api/configureStore)</code>: 단순화된 구성옵션과 좋은 기본값을 제공하기 위해 <code>createStore</code> 로 감싼다. 이는 자동으로 slice reducer와 결합할 수 있고, 사용자게 제공하는 리덕스 미들웨어가 무엇이든 간에 redux-thunk를 디폴트로 제공한다. 또 redux devtools extension을 사용할 수 있다.</li>
<li><code>[createReducer()](https://redux-toolkit.js.org/api/createReducer)</code>: switch 문으로 액션 타입의 목록을 작성하는 대신, case reducer funxtion들로 액션타입의 목록을 제공한다. 추가로 자동으로 immer 라이브러리를 사용하여 immutable한 업데이트를 normal mutative 코드를 통해 단순화한다. 예를 들어 state.todos[3].completed = true.처럼.</li>
<li><code>[createAction()](https://redux-toolkit.js.org/api/createAction)</code>: 주어진 액션 타입 문자열에 대한 action creator 함수를 생성한다. 이 함수는 스스로 toString()으로 정의되기 때문에 type 상수대신 사용할 수 있다.</li>
<li><code>[createSlice()](https://redux-toolkit.js.org/api/createSlice)</code>: reducer 함수의 객체, a slice name, 초기값을 받아들여서 이와 상응하는 action creators, action types을 가진 slice reducer를 자동으로 생성한다.</li>
<li><code>[createAsyncThunk](https://redux-toolkit.js.org/api/createAsyncThunk)</code>: 액션 타입 문자열을 받아들여서 promise를 return하는 함수를 반환하고, 이 promise에 근거하여 pending/fulfilled/rejected 의 액션 타입을 디스패치하는 thunk를 생성한다.</li>
<li><code>[createEntityAdapter](https://redux-toolkit.js.org/api/createEntityAdapter)</code>: 스토어에 있는 정규화된 data(normalized date)를 관리하기 위해 재사용 가능한 리듀서와 selectors set를 생성한다.</li>
<li>The <code>[createSelector</code> utility](<a href="https://redux-toolkit.js.org/api/createSelector" target="_blank" rel="noopener">https://redux-toolkit.js.org/api/createSelector</a>) from the <a href="https://github.com/reduxjs/reselect" target="_blank" rel="noopener">Reselect</a> library, re-exported for ease of use.</li>
</ul>
<hr>
<h1 id="RTK-Query"><a href="#RTK-Query" class="headerlink" title="RTK Query"></a>RTK Query</h1><p>@reduxjs/toolkit package 에 옵셔널로 포함되어 제공되는 것이다. data fetching과 캐싱의 사용 사례를 해결하기 위해 제작되었고, app의 API 인터페이스 계틍을 정의하기 위해 작지만 강력한 툴셋을 제공한다. 웹 어플리케이션에서 데이터를 로딩하는 보통의 경우를 단순화하도록 만들어졌기 때문에 직접 data fetching과 캐싱 로직을 작성할 필요가 없다.</p>
<p>RTK 쿼리는 실행을 위해 Redux Toolkit 코어 위에 구축되는데, 아키텍처 내부에서 redux를 내부적으로 사용하기 위함이다. RTK 쿼리를 쓰기 위해서 리덕스나 RTK에 대한 지식이 필요하지는 않지만 RTK 쿼리가 제공하는 모든 추가적인 global store 관리 기능을 탐색할 필요가 있고, RTK 쿼리를 완전하게 사용하여 요청 및 캐시 동작의 타임라인을 재현하고, 횡단하기 위해 Redux DevTools 브라우저 확장 프로그램을 설치해야한다.</p>
<p>RTK 쿼리는 core Redux Toolkit package 내부에 설치되어있다. 아래 두 가지 엔트리 포인트를 통해 사용할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* React-specific entry point that automatically generates</span></span><br><span class="line"><span class="comment">   hooks corresponding to the defined endpoints */</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="RTK-쿼리안에-들어-있는-것"><a href="#RTK-쿼리안에-들어-있는-것" class="headerlink" title="RTK 쿼리안에 들어 있는 것"></a>RTK 쿼리안에 들어 있는 것</h3><p>다음의 API가 포함된다.</p>
<ul>
<li><code>[createApi()](https://redux-toolkit.js.org/rtk-query/api/createApi)</code>: RTK 쿼리 기능의 핵심. 일련의 엔드포인트로부터 데이터를 어떻게 회수해오는지와 관련된 방법, 데이터를 fetch하고 transtorm하는 방법을 설명하는 엔드리 포인트 set를 정의할 수 있다. 보통 기본 URL당 하나의 API 슬라이스를 사용하여 app에서 한 번만 쓰여야 한다.</li>
<li><code>[fetchBaseQuery()](https://redux-toolkit.js.org/rtk-query/api/fetchBaseQuery)</code>: 요청을 단순화하는 목적을 가진 작은 wrapper이다. 대부분의 사용자에게 createApi에서 권장되는 baseQuery로 사용된다.</li>
<li><code>[&lt;ApiProvider /&gt;](https://redux-toolkit.js.org/rtk-query/api/ApiProvider)</code>: 리덕스 스토어가 아직 없는 상태에서 Provider로 사용할 수 있다.</li>
<li><code>[setupListeners()](https://redux-toolkit.js.org/rtk-query/api/setupListeners)</code>: refetchOnMount, refetchOnReconnect 동작을 활성화하는 데 사용되는 유틸리티이다.</li>
</ul>
<hr>
<p><em>References</em></p>
<p><a href="https://redux-toolkit.js.org/introduction/getting-started#rtk-query" target="_blank" rel="noopener">Getting Started | Redux Toolkit</a><br><a href="https://youtu.be/9zySeP5vH9c" target="_blank" rel="noopener">Let’s Learn Modern Redux! (with Mark Erikson) - Learn With Jason</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/07/20/210721_react-table/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/20/210721_react-table/" class="post-title-link" itemprop="url">React Table</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-21 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-21T00:00:00+09:00">2021-07-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-16 15:45:41" itemprop="dateModified" datetime="2022-05-16T15:45:41+09:00">2022-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="headless-UI"><a href="#headless-UI" class="headerlink" title="headless UI"></a>headless UI</h2><p>실제 UI 요소를 제공하거나 렌더하지 않지만 라이브러리가 제공하는 state와 callback hooks를 통해서 테이블 마크업을 커스텀할 수 있다.</p>
<p>headless user interface component는 아무런 인터페이스를 제공하지 않음으로써 최대의 시각적 유연성을 제공하는 컴포넌트이다. <em>유저 인터페이스가 없는 유저 인터페이스</em>라고 할 수 있다. 이는 컴포넌트의 로직과 동작을 시각적 표현에서 분리하는 것이다.</p>
<p><code>&lt;CoinFlip/&gt;</code>를 예로 들자면 이 컴포넌트를 child component의 함수로 쓰거나 prop을 렌더하는 식으로 사용한다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flip = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;</span><br><span class="line">  flipResults: <span class="built_in">Math</span>.random(),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CoinFlip</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  state = flip();</span><br><span class="line"></span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(flip);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.props.children(&#123;</span><br><span class="line">      rerun: <span class="keyword">this</span>.handleClick,</span><br><span class="line">      isHeads: <span class="keyword">this</span>.state.flipResults &lt; <span class="number">0.5</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>위 함수는 headless이다. 아무것도 렌더하지 않기 때문이다. 이 함수는 다양한 consumer들이 여러 논리적인 처리를 하면서 프레젠테이션 작업도 할 것을 기대하고 있다. 따라서 어플리케이션 코드는 다음과 같다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;CoinFlip&gt;</span><br><span class="line">  &#123;(&#123; rerun, isHeads &#125;) =&gt; (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;button onClick=&#123;rerun&#125;&gt;Reflip&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &#123;isHeads ? (</span></span><br><span class="line"><span class="regexp">        &lt;div&gt;</span></span><br><span class="line"><span class="regexp">          &lt;img src='/</span>heads.svg<span class="string">' alt='</span>Heads<span class="string">' /&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">      ) : (</span></span><br><span class="line"><span class="string">        &lt;div&gt;</span></span><br><span class="line"><span class="string">          &lt;img src='</span>/tails.svg<span class="string">' alt='</span>Tails<span class="string">' /&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">      )&#125;</span></span><br><span class="line"><span class="string">    &lt;/&gt;</span></span><br><span class="line"><span class="string">  )&#125;</span></span><br><span class="line"><span class="string">&lt;/CoinFlip&gt;</span></span><br></pre></td></tr></table></figure>
<p>여기서는 render prop을 받는 것으로 headless가 구현되었는데, HOC로 구현될 수도 있다.<br>혹은 View와 Controller, ViewModel과 View의 패턴으로 구현될 수도 있다. 여러 방법이 있겠지만 여기서 중요한 점은 동전을 뒤집는 매커니즘과 그 매커니즘의 인터페이스를 분리했다는 것이다.</p>
<h2 id="react-table"><a href="#react-table" class="headerlink" title="react-table"></a>react-table</h2><p>모든 <code>React Table</code>에서는 useTable hook과 <code>table instance 객체</code>가 리턴된다. 이 <code>table instance 객체</code>는 table을 만들고, table의 state와 상호작용할 수 있는 모든 것을 포함한다.</p>
<h3 id="getting-your-data"><a href="#getting-your-data" class="headerlink" title="getting your data"></a>getting your data</h3><p>테이블 구조를 생각해보면 보통 rows(행)과 columns(열)로 구성된 구조를 떠올린다. 그렇지만 테이블 구성이 단순히 행과 열의 조합으로 생각하기에는 중첩된 columns(열)과 행 등의 구조를 가질 수 있는 등 점점 복잡한 구조를 가지기 때문에 <strong>아래와 같은 구조로 기본 데이터 구조를 정의한다.</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = React.useMemo(</span><br><span class="line">  () =&gt; [</span><br><span class="line">    &#123;</span><br><span class="line">      col1: <span class="string">'Hello'</span>,</span><br><span class="line">      col2: <span class="string">'World'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      col1: <span class="string">'react-table'</span>,</span><br><span class="line">      col2: <span class="string">'rocks'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      col1: <span class="string">'whatever'</span>,</span><br><span class="line">      col2: <span class="string">'you want'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  []</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><u>여기서 중요한 점은 useMemo를 사용했다는 것이다.</u> 이는 데이터가 매번 렌더될 때마다 새롭게 생성되지 않음을 보장하는 것이다. 만약 useMemo를 쓰지 않는다면 table은 렌더될 때마다 새로운 데이터를 받았다고 생각하기 때문에 매번 많은 로직은 새로 계산하려고 시도하게 된다.</p>
<h3 id="Define-Columns"><a href="#Define-Columns" class="headerlink" title="Define Columns"></a>Define Columns</h3><p>useTable hook에 전달하기 위해 column에 대한 정의를 한다. 역시 마찬가지로 useMemo를 사용했기 때문에 매번 렌더될 때마다 새롭게 계산하지 않고, value를 기억해뒀다가 메모제이션된 value와 실제 value에 차이가 있을 때만 변화시킨다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> columns = React.useMemo(</span><br><span class="line">  () =&gt; [</span><br><span class="line">    &#123;</span><br><span class="line">      Header: <span class="string">'Column 1'</span>,</span><br><span class="line">      accessor: <span class="string">'col1'</span>, <span class="comment">// accessor is the "key" in the data</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      Header: <span class="string">'Column 2'</span>,</span><br><span class="line">      accessor: <span class="string">'col2'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  []</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="Using-the-useTable-hook"><a href="#Using-the-useTable-hook" class="headerlink" title="Using the useTable hook"></a>Using the useTable hook</h3><p>위에서 작성한 data와 column에 대한 정의를 가지고 useTable hook에 전달하여 새로운 table instance를 생성할 수 있다. 즉 useTable은 최소 메모제이션된 columns와 data를 포함한 객체를 제공받아야 한다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tableInstance = useTable(&#123; columns, data &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Building-a-basic-table-UI"><a href="#Building-a-basic-table-UI" class="headerlink" title="Building a basic table UI"></a>Building a basic table UI</h3><p>table instance는 만들었지만 아직 테이블 마크업과 스타일은 하지 않은 상태이므로 기본적인 테이블 구조를 작성해준다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">return (</span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="Applying-the-table-instance-to-markup"><a href="#Applying-the-table-instance-to-markup" class="headerlink" title="Applying the table instance to markup"></a>Applying the table instance to markup</h3><p>이제 기본적인 테이블 구조를 작성했으니 이를 이용해서 tableInstance를 얻을 수 있다. 이를 이용해 테이블 작성을 완료할 수 있다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tableInstance = useTable(&#123; columns, data &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; getTableProps, getTableBodyProps, headerGroups, rows, prepareRow &#125; =</span><br><span class="line">  tableInstance;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">  <span class="comment">// apply the table props</span></span><br><span class="line">  &lt;table &#123;...getTableProps()&#125;&gt;</span><br><span class="line">    &lt;thead&gt;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// Loop over the header rows</span></span><br><span class="line">        headerGroups.map(<span class="function">(<span class="params">headerGroup</span>) =&gt;</span> (</span><br><span class="line">          <span class="comment">// Apply the header row props</span></span><br><span class="line">          &lt;tr &#123;...headerGroup.getHeaderGroupProps()&#125;&gt;</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="comment">// Loop over the headers in each row</span></span><br><span class="line">              headerGroup.headers.map(<span class="function">(<span class="params">column</span>) =&gt;</span> (</span><br><span class="line">                <span class="comment">// Apply the header cell props</span></span><br><span class="line">                &lt;th &#123;...column.getHeaderProps()&#125;&gt;</span><br><span class="line">                  &#123;</span><br><span class="line">                    <span class="comment">// Render the header</span></span><br><span class="line">                    column.render(<span class="string">'Header'</span>)</span><br><span class="line">                  &#125;</span><br><span class="line">                &lt;<span class="regexp">/th&gt;</span></span><br><span class="line"><span class="regexp">              ))</span></span><br><span class="line"><span class="regexp">            &#125;</span></span><br><span class="line"><span class="regexp">          &lt;/</span>tr&gt;</span><br><span class="line">        ))</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;<span class="regexp">/thead&gt;</span></span><br><span class="line"><span class="regexp">    &#123;/</span>* Apply the table body props *<span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">    &lt;tbody &#123;...getTableBodyProps()&#125;&gt;</span></span><br><span class="line"><span class="regexp">      &#123;</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/ Loop over the table rows</span></span><br><span class="line"><span class="regexp">        rows.map((row) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">          /</span><span class="regexp">/ Prepare the row for display</span></span><br><span class="line"><span class="regexp">          prepareRow(row);</span></span><br><span class="line"><span class="regexp">          return (</span></span><br><span class="line"><span class="regexp">            /</span><span class="regexp">/ Apply the row props</span></span><br><span class="line"><span class="regexp">            &lt;tr &#123;...row.getRowProps()&#125;&gt;</span></span><br><span class="line"><span class="regexp">              &#123;</span></span><br><span class="line"><span class="regexp">                /</span><span class="regexp">/ Loop over the rows cells</span></span><br><span class="line"><span class="regexp">                row.cells.map((cell) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">                  /</span><span class="regexp">/ Apply the cell props</span></span><br><span class="line"><span class="regexp">                  return (</span></span><br><span class="line"><span class="regexp">                    &lt;td &#123;...cell.getCellProps()&#125;&gt;</span></span><br><span class="line"><span class="regexp">                      &#123;</span></span><br><span class="line"><span class="regexp">                        /</span><span class="regexp">/ Render the cell contents</span></span><br><span class="line"><span class="regexp">                        cell.render('Cell')</span></span><br><span class="line"><span class="regexp">                      &#125;</span></span><br><span class="line"><span class="regexp">                    &lt;/</span>td&gt;</span><br><span class="line">                  );</span><br><span class="line">                &#125;)</span><br><span class="line">              &#125;</span><br><span class="line">            &lt;<span class="regexp">/tr&gt;</span></span><br><span class="line"><span class="regexp">          );</span></span><br><span class="line"><span class="regexp">        &#125;)</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>tbody&gt;</span><br><span class="line">  &lt;<span class="regexp">/table&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
<h3 id="Final-Result"><a href="#Final-Result" class="headerlink" title="Final Result"></a>Final Result</h3><p>앞의 모든 과정을 한번에 표현해보면 다음과 같다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useTable &#125; <span class="keyword">from</span> <span class="string">'react-table'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> data = React.useMemo(</span><br><span class="line">    () =&gt; [</span><br><span class="line">      &#123;</span><br><span class="line">        col1: <span class="string">'Hello'</span>,</span><br><span class="line">        col2: <span class="string">'World'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        col1: <span class="string">'react-table'</span>,</span><br><span class="line">        col2: <span class="string">'rocks'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        col1: <span class="string">'whatever'</span>,</span><br><span class="line">        col2: <span class="string">'you want'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    []</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> columns = React.useMemo(</span><br><span class="line">    () =&gt; [</span><br><span class="line">      &#123;</span><br><span class="line">        Header: <span class="string">'Column 1'</span>,</span><br><span class="line">        accessor: <span class="string">'col1'</span>, <span class="comment">// accessor is the "key" in the data</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        Header: <span class="string">'Column 2'</span>,</span><br><span class="line">        accessor: <span class="string">'col2'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    []</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; getTableProps, getTableBodyProps, headerGroups, rows, prepareRow &#125; =</span><br><span class="line">    useTable(&#123; columns, data &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;table &#123;...getTableProps()&#125; style=&#123;&#123; <span class="attr">border</span>: <span class="string">'solid 1px blue'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;thead&gt;</span><br><span class="line">        &#123;headerGroups.map(<span class="function">(<span class="params">headerGroup</span>) =&gt;</span> (</span><br><span class="line">          &lt;tr &#123;...headerGroup.getHeaderGroupProps()&#125;&gt;</span><br><span class="line">            &#123;headerGroup.headers.map(<span class="function">(<span class="params">column</span>) =&gt;</span> (</span><br><span class="line">              &lt;th</span><br><span class="line">                &#123;...column.getHeaderProps()&#125;</span><br><span class="line">                style=&#123;&#123;</span><br><span class="line">                  borderBottom: <span class="string">'solid 3px red'</span>,</span><br><span class="line">                  background: <span class="string">'aliceblue'</span>,</span><br><span class="line">                  color: <span class="string">'black'</span>,</span><br><span class="line">                  fontWeight: <span class="string">'bold'</span>,</span><br><span class="line">                &#125;&#125;</span><br><span class="line">              &gt;</span><br><span class="line">                &#123;column.render(<span class="string">'Header'</span>)&#125;</span><br><span class="line">              &lt;<span class="regexp">/th&gt;</span></span><br><span class="line"><span class="regexp">            ))&#125;</span></span><br><span class="line"><span class="regexp">          &lt;/</span>tr&gt;</span><br><span class="line">        ))&#125;</span><br><span class="line">      &lt;<span class="regexp">/thead&gt;</span></span><br><span class="line"><span class="regexp">      &lt;tbody &#123;...getTableBodyProps()&#125;&gt;</span></span><br><span class="line"><span class="regexp">        &#123;rows.map((row) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">          prepareRow(row);</span></span><br><span class="line"><span class="regexp">          return (</span></span><br><span class="line"><span class="regexp">            &lt;tr &#123;...row.getRowProps()&#125;&gt;</span></span><br><span class="line"><span class="regexp">              &#123;row.cells.map((cell) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">                return (</span></span><br><span class="line"><span class="regexp">                  &lt;td</span></span><br><span class="line"><span class="regexp">                    &#123;...cell.getCellProps()&#125;</span></span><br><span class="line"><span class="regexp">                    style=&#123;&#123;</span></span><br><span class="line"><span class="regexp">                      padding: '10px',</span></span><br><span class="line"><span class="regexp">                      border: 'solid 1px gray',</span></span><br><span class="line"><span class="regexp">                      background: 'papayawhip',</span></span><br><span class="line"><span class="regexp">                    &#125;&#125;</span></span><br><span class="line"><span class="regexp">                  &gt;</span></span><br><span class="line"><span class="regexp">                    &#123;cell.render('Cell')&#125;</span></span><br><span class="line"><span class="regexp">                  &lt;/</span>td&gt;</span><br><span class="line">                );</span><br><span class="line">              &#125;)&#125;</span><br><span class="line">            &lt;<span class="regexp">/tr&gt;</span></span><br><span class="line"><span class="regexp">          );</span></span><br><span class="line"><span class="regexp">        &#125;)&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>tbody&gt;</span><br><span class="line">    &lt;<span class="regexp">/table&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Hook-Usage"><a href="#Hook-Usage" class="headerlink" title="Hook Usage"></a>Hook Usage</h3><p><code>React Table</code>은 리액트 훅은 내외부에서 사용하여 구성하고, lifecycle를 관리한다. 그리고 기본적으로 custom react hook과 호환되는 hook을 가진다.</p>
<p><code>useTable</code>은 가장 기본적으로 사용되는 훅인데, 모든 옵션과 플러그인 훅의 스타팅 포인트로 제공된다. 옵션이 <code>useTable</code>로 전달되면 제공받은 순서대로 모든 플러그인 훅으로 전달되고, 최종 instance를 만들어 결과적으로 table state와 상호작용하는 나만의 table UI를 만들 수 있다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> instance = useTable(</span><br><span class="line">  &#123;</span><br><span class="line">    data: [...],</span><br><span class="line">    columns: [...],</span><br><span class="line">  &#125;,</span><br><span class="line">  useGroupBy,</span><br><span class="line">  useFilters,</span><br><span class="line">  useSortBy,</span><br><span class="line">  useExpanded,</span><br><span class="line">  usePagination</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="The-stages-of-React-Table-and-plugins"><a href="#The-stages-of-React-Table-and-plugins" class="headerlink" title="The stages of React Table and plugins"></a>The stages of <code>React Table</code> and plugins</h3><ol>
<li>useTable이 호출되어 table instance가 만들어진다.</li>
<li>instance.state는 custom user state나 자동으로 생성된 것으로 resolve된다.</li>
<li>플러그인 포인트들의 컬렉션은 instance.hooks에 생성된다.</li>
<li>각 플러그인은 instance.hook에 hook을 추가할 수 있다.</li>
<li>useTable 로직이 실행되면서 각 플러그인 훅 type은 등록된 순서대로 개별 hook 함수가 실행되는 순서에 따라 특정 시점에서 사용된다.</li>
<li>useTable로부터 최종적인 instance 객체를 얻고, 이를 이용해 개발자가 자신만의 테이블을 만들 수 있다.</li>
</ol>
<h3 id="Plugin-Hook-Order-amp-Consistency"><a href="#Plugin-Hook-Order-amp-Consistency" class="headerlink" title="Plugin Hook Order &amp; Consistency"></a>Plugin Hook Order &amp; Consistency</h3><p>플러그인 hook의 순서와 사용은 다른 custom hooks가 그러하듯 항상 같은 순서로 호출되어야 한다는 hooks의 법칙에 따른다.</p>
<h3 id="Option-Memoization"><a href="#Option-Memoization" class="headerlink" title="Option Memoization"></a>Option Memoization</h3><p><code>React Table</code>은 state와 사이드 이펙트를 업데이트하거나 계산해야하는 타이밍을 메모제이션에 의존한다. 이 말은 모든 옵션이 useTable에 전달될 때 useMemo 또는 useCallback으로 메모제이션되어야 한다는 의미이다.</p>
<hr>
<p><em>References</em><br><a href="https://www.merrickchristensen.com/articles/headless-user-interface-components/" target="_blank" rel="noopener">HEADLESS USER INTERFACE COMPONENTS</a><br><a href="https://react-table.tanstack.com/docs/overview" target="_blank" rel="noopener">React Table - overview</a><br><a href="https://react-table.tanstack.com/docs/quick-start" target="_blank" rel="noopener">React Table - Quick Start</a><br><a href="https://react-table.tanstack.com/docs/api/overview" target="_blank" rel="noopener">React Table - Overview</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Heejin Lee</p>
  <div class="site-description" itemprop="description">Today I Learned</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">123</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Heejin Lee</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.1
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.1
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
