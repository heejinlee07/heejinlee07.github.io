<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"heejinlee07.github.io","root":"/","scheme":"Muse","version":"7.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Today I Learned">
<meta property="og:type" content="website">
<meta property="og:title" content="Heejin">
<meta property="og:url" content="https://heejinlee07.github.io/page/4/index.html">
<meta property="og:site_name" content="Heejin">
<meta property="og:description" content="Today I Learned">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Heejin Lee">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://heejinlee07.github.io/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>Heejin</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Heejin</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Front-end Developer</p>
  </div>

  <div class="site-nav-right"></div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/09/25/210926_muiCssInjectionOrder/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/25/210926_muiCssInjectionOrder/" class="post-title-link" itemprop="url">MUI CSS injection order 원문 축약</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-26 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-26T00:00:00+09:00">2021-09-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-06 10:57:52" itemprop="dateModified" datetime="2022-07-06T10:57:52+09:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문 링크: <a href="https://mui.com/styles/advanced/#string-templates" target="_blank" rel="noopener">https://mui.com/styles/advanced/#string-templates</a></p>
</blockquote>
<h2 id="CSS-injection-order"><a href="#CSS-injection-order" class="headerlink" title="CSS injection order"></a>CSS injection order</h2><blockquote>
<p>CSS가 어떻게 브라우저에 의해 계산되는지 이해하는 것은 언제 스타일 오버라이딩이 되는지 알기 위한 키포인트이기 때문에 매우 중요하다. 이와 관련하여 MDN의 <a href="https://developer.mozilla.org/ko/docs/Web/CSS/Specificity" target="_blank" rel="noopener">어떻게 계산되는가?</a>를 읽어보는 것을 추천한다.</p>
</blockquote>
<p>기본적으로 style 태그는 페이지의 <code>&lt;head&gt;</code> 엘리먼트의 가장 마지막에 주입된다. 이 style 태그는 페이지의 다른 어떤 style 태그 (e.g. CSS module, styled components) 보다도 특수함을 가진다.</p>
<h2 id="injectFirst"><a href="#injectFirst" class="headerlink" title="injectFirst"></a>injectFirst</h2><p><code>StylesProvider</code> 컴포넌트는 <code>injectFirst</code> prop를 가지고 있어서 head(낮은 우선순위)에서 가장 먼저 주입되는 style tag이다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; StylesProvider &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span></span><br><span class="line"></span><br><span class="line">;<span class="xml"><span class="tag">&lt;<span class="name">StylesProvider</span> <span class="attr">injectFirst</span>&gt;</span></span></span><br><span class="line"><span class="xml">  &#123;/* Your component tree.</span></span><br><span class="line"><span class="xml">      Styled components can override MUI's styles. */&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">StylesProvider</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h2 id="makeStyles-withStyles-styled"><a href="#makeStyles-withStyles-styled" class="headerlink" title="makeStyles / withStyles / styled"></a>makeStyles / withStyles / styled</h2><p>주입되는 style tag는 makeStyles / withStyles / styled가 발생하는 같은 순위에서 발생한다. 예를 들어 color red가 아래 예시에서 우세하다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> clsx <span class="keyword">from</span> <span class="string">'clsx'</span></span><br><span class="line"><span class="keyword">import</span> &#123; makeStyles &#125; <span class="keyword">from</span> <span class="string">'@mui/styles'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useStylesBase = makeStyles(&#123;</span><br><span class="line">  root: &#123;</span><br><span class="line">    color: <span class="string">'blue'</span> <span class="comment">// 🔵</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useStyles = makeStyles(&#123;</span><br><span class="line">  root: &#123;</span><br><span class="line">    color: <span class="string">'red'</span> <span class="comment">// 🔴</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Order doesn't matter</span></span><br><span class="line">  <span class="keyword">const</span> classes = useStyles()</span><br><span class="line">  <span class="keyword">const</span> classesBase = useStylesBase()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Order doesn't matter</span></span><br><span class="line">  <span class="keyword">const</span> className = clsx(classes.root, classesBase.root)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// color: red 🔴 wins.</span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;className&#125;</span> /&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>hook의 호출 순서와 class name의 연속적인 순서는 상관 없다.</p>
<h2 id="insertionPoint"><a href="#insertionPoint" class="headerlink" title="insertionPoint"></a>insertionPoint</h2><p>JSS는 이러한 상황을 해결할 수 있는 <a href="https://github.com/cssinjs/jss/blob/master/docs/setup.md#specify-the-dom-insertion-point" target="_blank" rel="noopener">매커니즘</a>을 제공한다. HTML내에 삽입점을 추가하는 것으로 CSS 규칙이 components에 <a href="https://cssinjs.org/jss-api/?v=v10.8.0#attach-style-sheets-in-a-specific-order" target="_blank" rel="noopener">적용되는 순서를 제어할 수 있다.</a></p>
<hr>
<p><em>References</em><br><a href="https://mui.com/styles/advanced/#string-templates" target="_blank" rel="noopener">CSS injection order</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/09/24/210925_nextjsTypescript/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/24/210925_nextjsTypescript/" class="post-title-link" itemprop="url">Next.js와 TypeScript 원문 번역</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-25 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-25T00:00:00+09:00">2021-09-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-06 10:57:52" itemprop="dateModified" datetime="2022-07-06T10:57:52+09:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문링크: <a href="https://nextjs.org/docs/basic-features/typescript#incremental-type-checking" target="_blank" rel="noopener">https://nextjs.org/docs/basic-features/typescript#incremental-type-checking</a></p>
</blockquote>
<h2 id="create-next-app-support"><a href="#create-next-app-support" class="headerlink" title="create-next-app support"></a>create-next-app support</h2><p>TypeScript project를 <code>create-next-app</code>과 함께 <code>--ts</code>, <code>--typescript</code> 를 사용하여 아래와 같이 생성할 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npx create-next-app --ts</span><br><span class="line"># or</span><br><span class="line">yarn create next-app --typescript</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Existing-projects"><a href="#Existing-projects" class="headerlink" title="Existing projects"></a>Existing projects</h2><p>이미 존재하는 project에 적용하려면 root folder에 빈 <code>tsconfig.json</code> file을 생성한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch tsconfig.json</span><br></pre></td></tr></table></figure>
<p>Next.js는 자동으로 이 파일 안에 default values를 설정한다. custom <a href="https://www.typescriptlang.org/docs/handbook/compiler-options.html" target="_blank" rel="noopener">complier options</a>로 <code>tsconfig.json</code>을 작성하는 것 또한 지원된다.</p>
<blockquote>
<p>Next.js는 TypeScript를 핸들링하기 위해 Babel을 사용하는데 몇가지 <a href="https://babeljs.io/docs/en/babel-plugin-transform-typescript#caveats" target="_blank" rel="noopener">주의사항</a>이 있고 <a href="https://babeljs.io/docs/en/babel-plugin-transform-typescript#typescript-compiler-options" target="_blank" rel="noopener">일부 컴파일러 옵션은 다르게 처리된다.</a></p>
</blockquote>
<p><code>next(npm run dev or yarn dev)</code>를 실행하면, Next.js가 setup을 완료하기 위해 설치가 필요한 패키지를 안내한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br><span class="line"></span><br><span class="line"># You&#39;ll see instructions like these:</span><br><span class="line">#</span><br><span class="line"># Please install typescript, @types&#x2F;react, and @types&#x2F;node by running:</span><br><span class="line">#</span><br><span class="line">#         yarn add --dev typescript @types&#x2F;react @types&#x2F;node</span><br><span class="line">#</span><br><span class="line"># ...</span><br></pre></td></tr></table></figure>
<p>이렇게 하면 <code>.js</code> 파일을 <code>.tsx</code>로 전환할 준비가 완료되었고, TypeScript를 사용할 수 있게 된다.</p>
<hr>
<blockquote>
<p><code>next-env.d.ts</code>라는 이름의 파일이 프로젝트의 root에 생성된다. 이 파일은 TypeScript complier가 Next.js의 type을 선택하도록 한다. 이는 매번 변경되므로 <strong>임의로 삭제하거나 편집하지 않도록 한다.</strong></p>
<p>TypeScript <code>strict</code> 모드는 기본적으로 꺼져있다. TypeScript를 편하게 사용하려면 <code>tsconfig.json</code>파일 내에 이 모드를 켜도록 한다.</p>
<p><code>next-env.d.ts</code>를 편집하는 대신 <code>additional.d.ts</code>와 같은 새 파일을 추가한 다음, <code>tsconfig.json</code> 의 <a href="https://www.typescriptlang.org/tsconfig#include" target="_blank" rel="noopener">include</a> 배열에서 참조하여 새로운 타입 유형을 추가할 수 있다.</p>
</blockquote>
<p>기본적으로 Next.js는 <code>next build</code>의 일부로 type checking를 수행한다. 개발하는 동안에는 code editior를 이용하여 type checking을 할 것을 추천한다.</p>
<p>만약 error report를 무시하고 싶다면, <a href="https://nextjs.org/docs/api-reference/next.config.js/ignoring-typescript-errors" target="_blank" rel="noopener">Ignoring TypeScript errors</a>와 관련된 문서를 확인하도록 한다.</p>
<hr>
<h2 id="Static-Generation-and-Server-side-Rendering"><a href="#Static-Generation-and-Server-side-Rendering" class="headerlink" title="Static Generation and Server-side Rendering"></a>Static Generation and Server-side Rendering</h2><p><code>getStaticProps</code>, <code>getStaticPaths</code>, <code>getServerSideProps</code>을 위해 각각 <code>getStaticProps</code>, <code>getStaticPaths</code>, <code>getServerSideProps</code> type을 사용할 수 있다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; GetStaticProps, GetStaticPaths, GetServerSideProps &#125; <span class="keyword">from</span> <span class="string">'next'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getStaticProps: GetStaticProps = <span class="keyword">async</span> (context) =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getStaticPaths: GetStaticPaths = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getServerSideProps: GetServerSideProps = <span class="keyword">async</span> (context) =&gt; &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>만약 <code>getInitialProps</code>를 사용하려면 <a href="https://nextjs.org/docs/api-reference/data-fetching/getInitialProps#typescript" target="_blank" rel="noopener">이 링크</a>를 참조한다.</p>
</blockquote>
<hr>
<h2 id="API-Routes"><a href="#API-Routes" class="headerlink" title="API Routes"></a>API Routes</h2><p>아래 예제는 API routes의 빌트인 타입을 사용하는 방법이다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> type &#123; NextApiRequest, NextApiResponse &#125; <span class="keyword">from</span> <span class="string">'next'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (req: NextApiRequest, <span class="attr">res</span>: NextApiResponse) =&gt; &#123;</span><br><span class="line">  res.status(<span class="number">200</span>).json(&#123; <span class="attr">name</span>: <span class="string">'John Doe'</span> &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>reponse data에 type을 사용할 수도 있다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> type &#123; NextApiRequest, NextApiResponse &#125; <span class="keyword">from</span> <span class="string">'next'</span>;</span><br><span class="line"></span><br><span class="line">type Data = &#123;</span><br><span class="line">  name: string,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (req: NextApiRequest, <span class="attr">res</span>: NextApiResponse&lt;Data&gt;) =&gt; &#123;</span><br><span class="line">  res.status(<span class="number">200</span>).json(&#123; <span class="attr">name</span>: <span class="string">'John Doe'</span> &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Custom-App"><a href="#Custom-App" class="headerlink" title="Custom App"></a>Custom App</h2><p>만약 <a href="https://nextjs.org/docs/advanced-features/custom-app" target="_blank" rel="noopener">custom App</a>을 사용한다면 빌트인 타입인 <code>AppProps</code>를 사용할 수 있고 파일 이름을 <code>./pages/_app.tsx</code>와 같이 변경할 수 있다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// import App from "next/app";</span></span><br><span class="line"><span class="keyword">import</span> type &#123; AppProps <span class="comment">/*, AppContext */</span> &#125; <span class="keyword">from</span> <span class="string">'next/app'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyApp</span>(<span class="params">&#123; Component, pageProps &#125;: AppProps</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...pageProps</span>&#125; /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Only uncomment this method if you have blocking data requirements for</span></span><br><span class="line"><span class="comment">// every single page in your application. This disables the ability to</span></span><br><span class="line"><span class="comment">// perform automatic static optimization, causing every page in your app to</span></span><br><span class="line"><span class="comment">// be server-side rendered.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// MyApp.getInitialProps = async (appContext: AppContext) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   // calls page's `getInitialProps` and fills `appProps.pageProps`</span></span><br><span class="line"><span class="comment">//   const appProps = await App.getInitialProps(appContext);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//   return &#123; ...appProps &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> MyApp;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Path-aliases-and-baseUrl"><a href="#Path-aliases-and-baseUrl" class="headerlink" title="Path aliases and baseUrl"></a>Path aliases and baseUrl</h2><p>Next.js는 자동으로 tsconfig.json <code>paths</code>와 <code>baseUrl</code> 옵션을 제공한다. Module Path aliases와 관련된 특징을 더 알아보고 싶다면 <a href="https://nextjs.org/docs/advanced-features/module-path-aliases" target="_blank" rel="noopener">이 링크</a>를 참조한다.</p>
<h2 id="Type-checking-next-config-js"><a href="#Type-checking-next-config-js" class="headerlink" title="Type checking next.config.js"></a>Type checking next.config.js</h2><p><code>next.config.js</code> 파일은 반드시 JavaScript 파일이어야 하고, Babel이나 TypeScript로 parse되어서는 안된다.하지만 아래와 같이 JSDoc를 이용해서 IDE에서의 몇 가지 type checking를 추가할 수는 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; @ts-check</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * @type &#123;import(&#39;next&#39;).NextConfig&#125;</span><br><span class="line"> **&#x2F;</span><br><span class="line">const nextConfig &#x3D; &#123;</span><br><span class="line">  &#x2F;* config options here *&#x2F;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; nextConfig</span><br></pre></td></tr></table></figure>
<h2 id="Incremental-type-checking"><a href="#Incremental-type-checking" class="headerlink" title="Incremental type checking"></a>Incremental type checking</h2><p><code>v10.2.1</code>부터 Next.js는 <a href="https://www.typescriptlang.org/tsconfig#incremental" target="_blank" rel="noopener">incremental type checking</a>를 <code>tsconfig.json</code>에서 사용할 수 있도록 지원한다. 이는 대규모 application에서 type checking을 빠르게 할 수 있도록 돕는다. 최소한 <code>v4.3.2</code>이상의 TypeScript를 사용하고 있다면 최고의 성능을 경험하기 위해 이를 사용하는 것이 추천된다.</p>
<hr>
<p><em>References</em><br><a href="https://nextjs.org/docs/basic-features/typescript#incremental-type-checking" target="_blank" rel="noopener">Next.js - TypeScript</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/09/01/210902_axios/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/01/210902_axios/" class="post-title-link" itemprop="url">Axios</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-02 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-02T00:00:00+09:00">2021-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-06 10:57:52" itemprop="dateModified" datetime="2022-07-06T10:57:52+09:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문링크: <a href="https://axios-http.com/" target="_blank" rel="noopener">https://axios-http.com/</a></p>
</blockquote>
<h2 id="Axios란"><a href="#Axios란" class="headerlink" title="Axios란"></a>Axios란</h2><p>node.js와 브라우저를 위한 promise 기반의 HTTP Client. 브라우저와 nodejs에서 동일한 코드가 동일하게 동작한다. server-side에서는 native 기반의 node.js httop 모듈을 사용하고, client(브라우저)에서는 XMLHttpRequests를 사용한다.</p>
<h2 id="특징"><a href="#특징" class="headerlink" title="특징"></a>특징</h2><ul>
<li>브라우저로부터 XMLHttpRequests를 만든다.</li>
<li>node.js로부터 http 요청을 만든다.</li>
<li>Promise API를 보조한다.</li>
<li>request와 response를 중간에서 가로채어 관리한다.</li>
<li>request와 response 데이터를 전송한다.</li>
<li>request를 취소한다.</li>
<li>JSON data에 대한 자동 변환.</li>
<li>XSRF로부터 보호하기 위해 client side를 보조한다.</li>
</ul>
<h2 id="설치"><a href="#설치" class="headerlink" title="설치"></a>설치</h2><p><strong>1. using npm</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install axios</span><br></pre></td></tr></table></figure>
<p><strong>2. using bower</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bower install axios</span><br></pre></td></tr></table></figure>
<p><strong>3. using yarn</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yarn add axios</span><br></pre></td></tr></table></figure>
<p><strong>4. using jsDelivr CDN</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>5. Using unpkg CDN</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/axios/dist/axios.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="예시"><a href="#예시" class="headerlink" title="예시"></a>예시</h2><h3 id="CommonJS-usage"><a href="#CommonJS-usage" class="headerlink" title="CommonJS usage"></a>CommonJS usage</h3><p>TypeScript typings (for intellisense / autocomplete)이 가능하게 하기 위해 CommonJS를 사용할 때는 아래 예시처럼 <code>require()</code>를 import한다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">'axios'</span>).default;</span><br><span class="line"></span><br><span class="line"><span class="comment">// axios.&lt;method&gt;를 쓰게 되면 autocomplete과 parameter typings의 사용이 가능해진다.</span></span><br></pre></td></tr></table></figure>
<h3 id="GET-request를-수행하는-예제"><a href="#GET-request를-수행하는-예제" class="headerlink" title="GET request를 수행하는 예제"></a>GET request를 수행하는 예제</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">'axios'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Make a request for a user with a given ID</span></span><br><span class="line">axios</span><br><span class="line">  .get(<span class="string">'/user?ID=12345'</span>)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// handle success</span></span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// handle error</span></span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 항상 실행된다.</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 선택적으로 위의 요청을 아래와 같이 수행할 수 있다.</span></span><br><span class="line">axios</span><br><span class="line">  .get(<span class="string">'/user'</span>, &#123;</span><br><span class="line">    params: &#123;</span><br><span class="line">      ID: <span class="number">12345</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 항상 실행된다.</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// async/await를 쓰고 싶다면 'async' 키워드를 function/method의 바깥쪽에 붙여준다.</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getUser</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> axios.get(<span class="string">'/user?ID=12345'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="POST-Requests"><a href="#POST-Requests" class="headerlink" title="POST Requests"></a>POST Requests</h2><p>Axios를 가지고 POST request를 요청하는 방법</p>
<h3 id="POST-request를-수행하는-예제"><a href="#POST-request를-수행하는-예제" class="headerlink" title="POST request를 수행하는 예제"></a>POST request를 수행하는 예제</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">axios</span><br><span class="line">  .post(<span class="string">'/user'</span>, &#123;</span><br><span class="line">    firstName: <span class="string">'Fred'</span>,</span><br><span class="line">    lastName: <span class="string">'Flintstone'</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="여러-요청을-동시에-수행하는-예제"><a href="#여러-요청을-동시에-수행하는-예제" class="headerlink" title="여러 요청을 동시에 수행하는 예제"></a>여러 요청을 동시에 수행하는 예제</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserAccount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/12345'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserPermissions</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/12345/permissions'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.all([getUserAccount(), getUserPermissions()]).then(<span class="function"><span class="keyword">function</span> (<span class="params">results</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> acct = results[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">const</span> perm = results[<span class="number">1</span>];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Axios-API"><a href="#Axios-API" class="headerlink" title="Axios API"></a>Axios API</h2><p>request는 관련된 config를 통해 axios로 전달된다.</p>
<h3 id="axios-config"><a href="#axios-config" class="headerlink" title="axios(config)"></a>axios(config)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// POST request를 보낸다.</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  method: <span class="string">'post'</span>,</span><br><span class="line">  url: <span class="string">'/user/12345'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    firstName: <span class="string">'Fred'</span>,</span><br><span class="line">    lastName: <span class="string">'Flintstone'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// node.js remote image에 대한 GET request</span></span><br><span class="line">axios(&#123;</span><br><span class="line">  method: <span class="string">'get'</span>,</span><br><span class="line">  url: <span class="string">'http://bit.ly/2mTM3nY'</span>,</span><br><span class="line">  responseType: <span class="string">'stream'</span>,</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">  response.data.pipe(fs.createWriteStream(<span class="string">'ada_lovelace.jpg'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="axios-url-config"><a href="#axios-url-config" class="headerlink" title="axios(url[, config])"></a>axios(url[, config])</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Send a GET request (default method)</span></span><br><span class="line">axios(<span class="string">'/user/12345'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Request-method-aliases"><a href="#Request-method-aliases" class="headerlink" title="Request method aliases"></a>Request method aliases</h3><p>편의를 위해 지원되는 모든 요청 메서드에 대한 alias가 제공된다. alias method인 url, method, data 속성을 쓸 때는 config에 작성할 필요없다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">axios.request(config)</span><br><span class="line">axios.get(url[, config])</span><br><span class="line">axios.delete(url[, config])</span><br><span class="line">axios.head(url[, config])</span><br><span class="line">axios.options(url[, config])</span><br><span class="line">axios.post(url[, data[, config]])</span><br><span class="line">axios.put(url[, data[, config]])</span><br><span class="line">axios.patch(url[, data[, config]])</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="The-Axios-Instance"><a href="#The-Axios-Instance" class="headerlink" title="The Axios Instance"></a>The Axios Instance</h2><h3 id="Creating-an-instance"><a href="#Creating-an-instance" class="headerlink" title="Creating an instance"></a>Creating an instance</h3><p>custom config를 통해 axios의 새로운 인스턴스를 생성할 수 있다.</p>
<h3 id="axios-create-config"><a href="#axios-create-config" class="headerlink" title="axios.create([config])"></a>axios.create([config])</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> instance = axios.create(&#123;</span><br><span class="line">  baseURL: <span class="string">'https://some-domain.com/api/'</span>,</span><br><span class="line">  timeout: <span class="number">1000</span>,</span><br><span class="line">  headers: &#123; <span class="string">'X-Custom-Header'</span>: <span class="string">'foobar'</span> &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Instance-methods"><a href="#Instance-methods" class="headerlink" title="Instance methods"></a>Instance methods</h3><p>사용 가능한 인스턴스 메소드는 아래와 같다. 명시된 config는 instance config와 병합된다.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">axios#request(config)</span><br><span class="line">axios#get(url[, config])</span><br><span class="line">axios#delete(url[, config])</span><br><span class="line">axios#head(url[, config])</span><br><span class="line">axios#options(url[, config])</span><br><span class="line">axios#post(url[, data[, config]])</span><br><span class="line">axios#put(url[, data[, config]])</span><br><span class="line">axios#patch(url[, data[, config]])</span><br><span class="line">axios#getUri([config])</span><br></pre></td></tr></table></figure>
<hr>
<p><em>References</em><br><a href="https://axios-http.com/" target="_blank" rel="noopener">Axios</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/08/25/210826_rtk-mutation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/25/210826_rtk-mutation/" class="post-title-link" itemprop="url">RTK Query Mutation 원문 번역</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-08-26 00:00:00" itemprop="dateCreated datePublished" datetime="2021-08-26T00:00:00+09:00">2021-08-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-06 10:57:52" itemprop="dateModified" datetime="2022-07-06T10:57:52+09:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문링크: <a href="https://redux-toolkit.js.org/rtk-query/usage/mutations" target="_blank" rel="noopener">https://redux-toolkit.js.org/rtk-query/usage/mutations</a></p>
</blockquote>
<h1 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h1><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>mutation은 서버에 데이터 업데이트를 보낼 때 사용하고, 이를 로컬 캐시에 적용하도록 한다. 또 유효하지 않은 데이터를 걸러내고, 강제로 re-fetch할 수 있도록 한다.</p>
<h2 id="Defining-Mutation-Endpoints"><a href="#Defining-Mutation-Endpoints" class="headerlink" title="Defining Mutation Endpoints"></a>Defining Mutation Endpoints</h2><p>Mutation Endpoints는 createApi의 endpoints 섹션에 return 되는 객체로 정의된다. 정의되는 곳에서는 builder.mutation() 메소드를 통해 정의한다.</p>
<p>Mutation Endpoints는 URL(URL query params를 포함하는)의 구조의 query 콜백이나 queryFn 콜백에 정의해야 되는데, queryFn callback은 임의로 async 로직을 구성하고 결과를 반환한다. query 콜백은 URL, request 메소드에 사용하는 HTTP 메소드를 포함한 객체를 반환한다.</p>
<p>query 콜백이 URL을 생성하기 위한 추가 데이터가 필요한 경우에는 단일 인수로 작성되어야 하고, 만약 여러 파라미터를 전달할 예정이라면 단일 옵션 개체(option object)의 형태로 전달되어야 한다.</p>
<p>Mutation endpoints는 결과가 캐시되기 전에 response 내용을 수정하고, tags를 정의하여 캐시 무효화를 식별하고, 캐시 항목이 추가 및 제거될 때까지 전체 라이프 사이클 콜백을 제공한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Example of all mutation endpoint options</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Post &#125; <span class="keyword">from</span> <span class="string">'./types'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> api = createApi(&#123;</span><br><span class="line">  baseQuery: fetchBaseQuery(&#123;</span><br><span class="line">    baseUrl: <span class="string">'/'</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  tagTypes: [<span class="string">'Post'</span>],</span><br><span class="line">  endpoints: <span class="function">(<span class="params">build</span>) =&gt;</span> (&#123;</span><br><span class="line">    updatePost: build.mutation&lt;Post, Partial&lt;Post&gt; &amp; Pick&lt;Post, <span class="string">'id'</span>&gt;&gt;(&#123;</span><br><span class="line">      <span class="comment">// note: an optional `queryFn` may be used in place of `query`</span></span><br><span class="line">      query: <span class="function">(<span class="params">&#123; id, ...patch &#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">        url: <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">        method: <span class="string">'PATCH'</span>,</span><br><span class="line">        body: patch,</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="comment">// Pick out data and prevent nested properties in a hook or selector</span></span><br><span class="line">      transformResponse: <span class="function">(<span class="params">response: &#123; data: Post &#125;</span>) =&gt;</span> response.data,</span><br><span class="line">      invalidatesTags: [<span class="string">'Post'</span>],</span><br><span class="line">      <span class="comment">// onQueryStarted is useful for optimistic updates</span></span><br><span class="line">      <span class="comment">// The 2nd parameter is the destructured `MutationLifecycleApi`</span></span><br><span class="line">      <span class="keyword">async</span> onQueryStarted(</span><br><span class="line">        arg,</span><br><span class="line">        &#123; dispatch, getState, queryFulfilled, requestId, extra, getCacheEntry &#125;</span><br><span class="line">      ) &#123;&#125;,</span><br><span class="line">      <span class="comment">// The 2nd parameter is the destructured `MutationCacheLifecycleApi`</span></span><br><span class="line">      <span class="keyword">async</span> onCacheEntryAdded(</span><br><span class="line">        arg,</span><br><span class="line">        &#123;</span><br><span class="line">          dispatch,</span><br><span class="line">          getState,</span><br><span class="line">          extra,</span><br><span class="line">          requestId,</span><br><span class="line">          cacheEntryRemoved,</span><br><span class="line">          cacheDataLoaded,</span><br><span class="line">          getCacheEntry,</span><br><span class="line">        &#125;</span><br><span class="line">      ) &#123;&#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>onQueryStarted는 <a href="https://redux-toolkit.js.org/rtk-query/usage/optimistic-updates" target="_blank" rel="noopener">optimistic update</a>에 사용할 수 있다.</p>
<hr>
<h2 id="Performing-Mutations-with-React-Hooks"><a href="#Performing-Mutations-with-React-Hooks" class="headerlink" title="Performing Mutations with React Hooks"></a>Performing Mutations with React Hooks</h2><h3 id="Mutation-Hook-Behavior"><a href="#Mutation-Hook-Behavior" class="headerlink" title="Mutation Hook Behavior"></a>Mutation Hook Behavior</h3><p>useQuery와 달리 useMutation는 tuple을 반환한다. tuple의 첫 번째 아이템은 ‘trigger’ 함수이고, 두 번째 아이템은 status, error, data를 포함하는 객체이다.</p>
<p>useQuery hook과 달리 useMutation은 자동으로 실행되지 않는다. mutation을 실행하기 위해서 hook의 첫 번째 tuple 값인 trigger 함수를 호출해야 한다. <a href="https://redux-toolkit.js.org/rtk-query/api/created-api/hooks#usemutation" target="_blank" rel="noopener">useMutaion</a>과 관련된 자세한 내용은 링크를 참조한다.</p>
<h3 id="Frequently-Used-Mutation-Hook-Return-Values"><a href="#Frequently-Used-Mutation-Hook-Return-Values" class="headerlink" title="Frequently Used Mutation Hook Return Values"></a>Frequently Used Mutation Hook Return Values</h3><p>useMutation hook은 mutaion trigger 함수를 포함하는 tuple과 mutation 결과와 관련된 속성을 포함하는 객체를 반환한다 하였다.</p>
<p>mutaion trigger 함수가 호출될 때 해당 엔드포인트에 대한 요청을 시작한다. mutation trigger를 호출하면 upwarp 속성이 포함된 프로미스를 반환하는데, 이 속성을 호출하는 것을 통해 mutation 호출을 풀고, raw한 reponse와 error를 제공할 수 있다. 이는 mutation의 호출되는 영역에서 성공/실패 여부를 결정하는 경우에 유용하다.</p>
<p>mutation result는 mutation 요청에 대한 가장 최신의 data와 같은 속성을 포함하는 객체인데, 이 뿐 만 아니라 현재 요청한 라이프사이클 state에 대한 boolean 속성도 포함하고 있다.</p>
<p>아래는 mutation result 객체에서 가장 자주 사용하는 속성들이다. <a href="https://redux-toolkit.js.org/rtk-query/api/created-api/hooks#usemutation" target="_blank" rel="noopener">useMutation</a>가 return하는 전체 속성에 대한 내용은 링크를 참조한다.</p>
<ul>
<li>data: 존재하는 경우에, 가장 최신의 trigger response로 부터 반환된 데이터. 만약 동일한 hook의 인스턴스에서 후속 trigger가 호출되면 새로운 데이터를 받기 전에는 undefined를 반환한다. 이전 데이터에서 새로운 데이터로의 원활한 전환을 위해서 컴포넌트 레벨의 고려해야 한다.</li>
<li>error: 존재하는 경우 에러의 결과.</li>
<li>isUninitialized: true일 때, mutation이 아직 발생하지 않았음을 나타낸다.</li>
<li>isLoading: true일 경우에 mutation이 아직 발생했고, reponse를 기다리는 중임을 나타낸다.</li>
<li>isSuccess: true일 경우에 마자믹으로 실행된 mutation에서 성공적인 요청으로 부터 얻은 데이터가 있음을 나타낸다.</li>
<li>isError: true일 때, 마지막으로 실행된 mutation에서 error 상태를 얻었음을 나타낸다.</li>
</ul>
<p>note: RTK 쿼리에서 mutation은 <a href="https://redux-toolkit.js.org/rtk-query/usage/queries#frequently-used-query-hook-return-values" target="_blank" rel="noopener">query</a>가 그런 것 처럼 ‘loading’와 ‘fetching’ 사이에 시멘틱한 구분을 포함하고 있지 않다. mutation은 후속 call이 반드시 관련이 있는 것이라고 가정하지 않기 때문에, mutation은 ‘no fetching’과 같은 컨셉이 없고, ‘loading’ 또는 ‘not loading’의 컨셉을 가진다.</p>
<hr>
<h2 id="Standard-Mutation-Example"><a href="#Standard-Mutation-Example" class="headerlink" title="Standard Mutation Example"></a>Standard Mutation Example</h2><p>페이지 하단의 updataPost mutation의 완전한 수정된 예시이다. 이 시나리오에서 post는 useQuery로 fetch되었고, post의 이름을 수정할 수 있는 EditablePostName 컴포넌트가 렌더된다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/features/posts/PostDetail.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> PostDetail = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = useParams&lt;&#123; <span class="attr">id</span>: any &#125;&gt;()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">data</span>: post &#125; = useGetPostQuery(id)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [</span><br><span class="line">    updatePost, <span class="comment">// This is the mutation trigger</span></span><br><span class="line">    &#123; <span class="attr">isLoading</span>: isUpdating &#125;, <span class="comment">// This is the destructured mutation result</span></span><br><span class="line">  ] = useUpdatePostMutation()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Box p=&#123;<span class="number">4</span>&#125;&gt;</span><br><span class="line">      &lt;EditablePostName</span><br><span class="line">        name=&#123;post.name&#125;</span><br><span class="line">        onUpdate=&#123;(name) =&gt; &#123;</span><br><span class="line">          <span class="comment">// If you want to immediately access the result of a mutation, you need to chain `.unwrap()`</span></span><br><span class="line">          <span class="comment">// if you actually want the payload or to catch the error.</span></span><br><span class="line">          <span class="comment">// Example: `updatePost().unwrap().then(fulfilled =&gt; console.log(fulfilled)).catch(rejected =&gt; console.error(rejected))</span></span><br><span class="line"></span><br><span class="line">          <span class="keyword">return</span> (</span><br><span class="line">            <span class="comment">// Execute the trigger with the `id` and updated `name`</span></span><br><span class="line">            updatePost(&#123; id, name &#125;)</span><br><span class="line">          )</span><br><span class="line">        &#125;&#125;</span><br><span class="line">        isLoading=&#123;isUpdating&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Box&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Advanced-Mutations-with-Revalidation"><a href="#Advanced-Mutations-with-Revalidation" class="headerlink" title="Advanced Mutations with Revalidation"></a>Advanced Mutations with Revalidation</h2><p>일반적으로 개발자가 mutation(revalidation)을 수행한 후 로컬 데이터 캐시를 서버와 재동기화하려는 경우가 매우 흔하다. RTK Query는 이에 대해 보다 중앙집권화 된 접근방법을 취함으로써 API 정의에서 invalidation 동작을 구성해야 한다. <a href="https://redux-toolkit.js.org/rtk-query/usage/automated-refetching#advanced-invalidation-with-abstract-tag-ids" target="_blank" rel="noopener">Advanced Invalidation with abstract tag IDs</a>를 통해 RTK Query와 Invalidation에 대한 자세한 내용을 참조하라.</p>
<h2 id="Revalidation-Example"><a href="#Revalidation-Example" class="headerlink" title="Revalidation Example"></a>Revalidation Example</h2><p>post의 <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete" target="_blank" rel="noopener">CRUD service</a> 예시이다. 이는 <a href="https://redux-toolkit.js.org/rtk-query/usage/automated-refetching#selectively-invalidating-lists" target="_blank" rel="noopener">Selectively invalidating lists</a>의 전략을 구현하고, 실제 어플리케이션을 위한 좋은 기반을 제공한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/app/services/posts.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Or from '@reduxjs/toolkit/query' if not using the auto-generated hooks</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface Post &#123;</span><br><span class="line">  id: number</span><br><span class="line">  name: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type PostsResponse = Post[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> postApi = createApi(&#123;</span><br><span class="line">  reducerPath: <span class="string">'postsApi'</span>,</span><br><span class="line">  baseQuery: fetchBaseQuery(&#123; <span class="attr">baseUrl</span>: <span class="string">'/'</span> &#125;),</span><br><span class="line">  tagTypes: [<span class="string">'Posts'</span>],</span><br><span class="line">  endpoints: <span class="function">(<span class="params">build</span>) =&gt;</span> (&#123;</span><br><span class="line">    getPosts: build.query&lt;PostsResponse, <span class="keyword">void</span>&gt;(&#123;</span><br><span class="line">      query: <span class="function"><span class="params">()</span> =&gt;</span> <span class="string">'posts'</span>,</span><br><span class="line">      <span class="comment">// Provides a list of `Posts` by `id`.</span></span><br><span class="line">      <span class="comment">// If any mutation is executed that `invalidate`s any of these tags, this query will re-run to be always up-to-date.</span></span><br><span class="line">      <span class="comment">// The `LIST` id is a "virtual id" we just made up to be able to invalidate this query specifically if a new `Posts` element was added.</span></span><br><span class="line">      providesTags: <span class="function">(<span class="params">result</span>) =&gt;</span></span><br><span class="line">        <span class="comment">// is result available?</span></span><br><span class="line">        result</span><br><span class="line">          ? <span class="comment">// successful query</span></span><br><span class="line">            [</span><br><span class="line">              ...result.map(<span class="function">(<span class="params">&#123; id &#125;</span>) =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, id &#125; <span class="keyword">as</span> <span class="keyword">const</span>)),</span><br><span class="line">              &#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, <span class="attr">id</span>: <span class="string">'LIST'</span> &#125;,</span><br><span class="line">            ]</span><br><span class="line">          : <span class="comment">// an error occurred, but we still want to refetch this query when `&#123; type: 'Posts', id: 'LIST' &#125;` is invalidated</span></span><br><span class="line">            [&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, <span class="attr">id</span>: <span class="string">'LIST'</span> &#125;],</span><br><span class="line">    &#125;),</span><br><span class="line">    addPost: build.mutation&lt;Post, Partial&lt;Post&gt;&gt;(&#123;</span><br><span class="line">      query(body) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          url: <span class="string">`post`</span>,</span><br><span class="line">          method: <span class="string">'POST'</span>,</span><br><span class="line">          body,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// Invalidates all Post-type queries providing the `LIST` id - after all, depending of the sort order,</span></span><br><span class="line">      <span class="comment">// that newly created post could show up in any lists.</span></span><br><span class="line">      invalidatesTags: [&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, <span class="attr">id</span>: <span class="string">'LIST'</span> &#125;],</span><br><span class="line">    &#125;),</span><br><span class="line">    getPost: build.query&lt;Post, number&gt;(&#123;</span><br><span class="line">      query: <span class="function">(<span class="params">id</span>) =&gt;</span> <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">      providesTags: <span class="function">(<span class="params">result, error, id</span>) =&gt;</span> [&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, id &#125;],</span><br><span class="line">    &#125;),</span><br><span class="line">    updatePost: build.mutation&lt;Post, Partial&lt;Post&gt;&gt;(&#123;</span><br><span class="line">      query(data) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; id, ...body &#125; = data</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          url: <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">          method: <span class="string">'PUT'</span>,</span><br><span class="line">          body,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// Invalidates all queries that subscribe to this Post `id` only.</span></span><br><span class="line">      <span class="comment">// In this case, `getPost` will be re-run. `getPosts` *might*  rerun, if this id was under its results.</span></span><br><span class="line">      invalidatesTags: <span class="function">(<span class="params">result, error, &#123; id &#125;</span>) =&gt;</span> [&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, id &#125;],</span><br><span class="line">    &#125;),</span><br><span class="line">    deletePost: build.mutation&lt;&#123; <span class="attr">success</span>: boolean; id: number &#125;, number&gt;(&#123;</span><br><span class="line">      query(id) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          url: <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">          method: <span class="string">'DELETE'</span>,</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// Invalidates all queries that subscribe to this Post `id` only.</span></span><br><span class="line">      invalidatesTags: <span class="function">(<span class="params">result, error, id</span>) =&gt;</span> [&#123; <span class="attr">type</span>: <span class="string">'Posts'</span>, id &#125;],</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123;</span><br><span class="line">  useGetPostsQuery,</span><br><span class="line">  useAddPostMutation,</span><br><span class="line">  useGetPostQuery,</span><br><span class="line">  useUpdatePostMutation,</span><br><span class="line">  useDeletePostMutation,</span><br><span class="line">&#125; = postApi</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Optimistic-Updates"><a href="#Optimistic-Updates" class="headerlink" title="Optimistic Updates"></a>Optimistic Updates</h1><p><a href="https://redux-toolkit.js.org/rtk-query/usage/optimistic-updates" target="_blank" rel="noopener">https://redux-toolkit.js.org/rtk-query/usage/optimistic-updates</a></p>
<p>useMutation을 통해 이미 존재하고 있는 일부 데이터에 대한 업데이트를 수행하고자 할 때 RTK Query는 optimistic 업데이트를 실행하기 위한 몇가지 tool을 제공한다. 이는 사용자에게 변경사항이 즉시 적용된다는 인상을 주고 싶을 때 유용한 패턴이다.</p>
<p>핵심 개념은 다음과 같다:</p>
<ul>
<li>quey 또는 mutation이 시작 될 때 , onQueryStarted가 실행된다.</li>
<li><code>api.util.updateQueryData</code> 를 통해 캐시된 데이터를 수동으로 업데이트한다.</li>
<li>promiseResult가 reject일 때 <code>.undo</code> 를 통해 이전 디스패치에서 반환된 객체의 속성으로 롤백한다.</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Optimistic update mutation example (async await)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Post &#125; <span class="keyword">from</span> <span class="string">'./types'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> api = createApi(&#123;</span><br><span class="line">  baseQuery: fetchBaseQuery(&#123;</span><br><span class="line">    baseUrl: <span class="string">'/'</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  tagTypes: [<span class="string">'Post'</span>],</span><br><span class="line">  endpoints: <span class="function">(<span class="params">build</span>) =&gt;</span> (&#123;</span><br><span class="line">    getPost: build.query&lt;Post, number&gt;(&#123;</span><br><span class="line">      query: <span class="function">(<span class="params">id</span>) =&gt;</span> <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">      providesTags: [<span class="string">'Post'</span>],</span><br><span class="line">    &#125;),</span><br><span class="line">    updatePost: build.mutation&lt;<span class="keyword">void</span>, Pick&lt;Post, <span class="string">'id'</span>&gt; &amp; Partial&lt;Post&gt;&gt;(&#123;</span><br><span class="line">      query: <span class="function">(<span class="params">&#123; id, ...patch &#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">        url: <span class="string">`post/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">        method: <span class="string">'PATCH'</span>,</span><br><span class="line">        body: patch,</span><br><span class="line">      &#125;),</span><br><span class="line">      invalidatesTags: [<span class="string">'Post'</span>],</span><br><span class="line">      <span class="keyword">async</span> onQueryStarted(&#123; id, ...patch &#125;, &#123; dispatch, queryFulfilled &#125;) &#123;</span><br><span class="line">        <span class="keyword">const</span> patchResult = dispatch(</span><br><span class="line">          api.util.updateQueryData(<span class="string">'getPost'</span>, id, (draft) =&gt; &#123;</span><br><span class="line">            <span class="built_in">Object</span>.assign(draft, patch)</span><br><span class="line">          &#125;)</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">await</span> queryFulfilled</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">          patchResult.undo()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<p><em>References</em><br><a href="https://redux-toolkit.js.org/rtk-query/usage/mutations" target="_blank" rel="noopener">RTK Query Mutations</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/08/18/210819_rtkQuery/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/18/210819_rtkQuery/" class="post-title-link" itemprop="url">RTK Query Overview 원문 번역</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-08-19 00:00:00" itemprop="dateCreated datePublished" datetime="2021-08-19T00:00:00+09:00">2021-08-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-06 10:57:52" itemprop="dateModified" datetime="2022-07-06T10:57:52+09:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>원문링크: <a href="https://redux-toolkit.js.org/rtk-query/overview" target="_blank" rel="noopener">https://redux-toolkit.js.org/rtk-query/overview</a></p>
</blockquote>
<p>RTK Query는 강력한 data fetching과 caching 툴이다. 웹 어플리케이션 내에서 데이터를 로딩할 때 사용되는 common case들을 단순화 하기 위해 고안되었기 때문에 data fetching과 캐싱 로직을 직접 작성할 필요가 없다. Redux Tookit 패키지에서 선택적 옵션으로 포함되어 있고, Redux Tookit 기능적으로 다른 api위에 구축된다.</p>
<h1 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h1><p>웹 어플리케이션은 보통 data를 화면에 그리기 위해 서버로부터 data를 fetch해서 가져와야 한다. 또 이 data를 업데이트 하거나 업데이트할 내용을 서버에 보내고, 서버의 데이터와 싱크를 맞추기 위해 client측에서 데이터를 캐시해서 가지고 있기도 한다. 오늘날을 어플리케이션 내에서 아래와 같은 다양한 행동이 실행되기 때문에 이 과정이 더욱 복잡하다.</p>
<ul>
<li>UI spinners를 보여주기 위해 loading 상태일 때를 추적한다.</li>
<li>같은 데이터를 사용할 때 중복 요청을 막는다</li>
<li>UI가 보다 빠르게 느끼도록 하는 updates</li>
<li>UI와 유저 인터페이스의 상호작용을 위한 캐시 수명(사이클) 매니징</li>
</ul>
<p>Redux 코어는 늘 최소화되어 왔기 때문에 실제 로직을 작성하는 것은 개발자에게 달려있다. 이는 리덕스가 위와 같은 사용 사례를 해결하기 위한 어떠한 것도 내부에 포함하고 있지 않다는 의미이다. 리덕스 도큐먼트에서는 로딩 스테이트와 요청 결과를 트래킹하기 위한 요청 수명(사이클)이 몇 가지 일반적인 패턴이 있다고 가르쳐왔다. 그리고 Redux Toolkit의 createAsyncThunk는 이러한 전형적인 패턴을 추상화하여 고안된 것이다. 그러나 유저는 아직도 상당한 리듀서 로직을 로딩 스테이트와 데이터 캐시를 위해 사용해야 한다.</p>
<p>지난 몇 년간, 리액트 커뮤니티는 “data fetching과 캐싱’이 state management와 완전히 다른 관심사라는 것을 깨달았다. Redux와 같은 상태관리 라이브러리를 사용해서 데이터를 캐시할 수 있자만, 데이터 fetching과 같은 상황에서 쓸 목적으로 만들어진 별도의 툴을 사용해도 될 만큼 의미있다.</p>
<p>RTK Query는 Apollo Client, React Query, Urql 및 SWR과 같이 data fetching을 위한 선구적인 솔루션 툴들로부터 영감을 받았지만, API 디자인에 고유한 접근 방식을 추가했다.</p>
<ul>
<li>data fetching과 캐싱 로직은 Redux toolkit의 createSlice와 createAsyncThunk api를 기반으로 구축된다.</li>
<li>왜냐하면 redux toolkit은 UI에 구애받지 않는 UI-agnostic이기 때문에, RTK 쿼리는 모든 UI layer에서 사용할 수 있다.</li>
<li>api endpoint는 인수를 통해 어떻케 쿼리 파라미터를 생성할 것인지와 캐싱을 위해 어떻게 응답을 변환할 것인지를 포함하여 미리 정의된다.</li>
<li>RTK Query는 react hook을 생성하여 전체 data fetching과정을 캡슐화하고, 컴포넌트에 data와 isLoading필드를 제공하고, 컴포넌트가 마운트되거나 언마운트될 때 캐시된 데이터의 수명을 관리한다.</li>
<li>RTK Query는 “cache entry lifecycle”옵션을 제공하는데, 이 옵션을 사용하면 초기 데이터를 fetching한 후에 웹소켓 메세지를 통해 스트리밍 캐시 업데이트 등과 같은 경우에 사용할 수 있도록 활성화 된다.</li>
<li>openAPI 또는 GraphQL 스키마에서 API slice의 코드 생성에 대한 예를 찾을 수 있다.</li>
<li>RTK Query는 완전히 TypeScript로 쓰여져 있기 때문에 TS 사용에 대한 좋은 경험을 제공할 수 있다.</li>
</ul>
<hr>
<h1 id="포함된-것"><a href="#포함된-것" class="headerlink" title="포함된 것"></a>포함된 것</h1><h2 id="APIs"><a href="#APIs" class="headerlink" title="APIs"></a>APIs</h2><p>RTK Query는 Redux Toolkit 패키지의 코어를 설치하면 그곳에 포함되어 있다. 아래 두 엔트리 포인트 중 한 가지로 사용할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* React-specific entry point that automatically generates</span></span><br><span class="line"><span class="comment">   hooks corresponding to the defined endpoints */</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span>;</span><br></pre></td></tr></table></figure>
<p>RTK Query에는 다음의 API가 포함된다.</p>
<ul>
<li>createApi(): RTK Query의 핵심기능이다. 여러 엔드포인트들로부터 데이터를 어떻게 회수할 것인지가 작성된 여러 엔드포인트들을 정의하고, 여기에는 데이터를 어떻게 fetch하거나 변환할 것인지에 대한 내용이 담긴다. 대부분의 경우 app에서 “하나의 base URL 당 하나의 API 슬라이스”를 사용하여 한 번만 작성되어야 한다.</li>
<li>fetchBaseQuery(): 요청을 단순화하는 것을 목표로 하는 fetch를 감싸는 작은 Wrapper이다. 대부분의 사용자에게는 createApi에서 baseQuery로 사용할 것이 권장된다.</li>
<li><ApiProvider/>: Redux 스토어가 없는 경우에도 Provider로써 사용할 수 있다.</li>
<li>setupListeners(): refetchOnMounte와 refetchOnReconnect를 사용할 수 있게 하는 유틸리티이다.</li>
</ul>
<h3 id="번들-크기"><a href="#번들-크기" class="headerlink" title="번들 크기"></a>번들 크기</h3><p>RTK 쿼리는 앱의 번들 사이즈에 고정된 일회성 사이즈로 추가된다. RTK Query는 Redux Toolkit과 React-Redux의 가장 상단에서 빌드되기 때문에 이렇게 추가된 사이즈는 이미 사용자가 app에서 이것을 쓰고 있는지 아닌지에 따라 다르다. 예상되는 min+gzip 번들 크기는 다음과 같다.</p>
<ul>
<li>RTK를 이미 사용하고 있는 경우: RTK 쿼리의 경우 ~9kb, hooks의 경우 ~2kb.</li>
<li>RTK를 이미 사용하지 않는 경우:<ul>
<li>React 없음: RTK+dependencies+RTK 쿼리의 경우 17kB</li>
<li>React 사용 시: 19kB + React-Redux, which is a peer dependency</li>
</ul>
</li>
</ul>
<p>endpoint들의 정의를 추가적으로 포함하고자 하면 보통 몇 바이트에 불과한 endpoints 정의 내부의 실제 코드에 근거하여 크기만 증가해야 한다</p>
<p>RTK 쿼리에 포함된 기능은 추가된 번들 크기에 대한 비용을 빠르게 지불하는 것을 포함하기 때문에 직접 작성한 data fetching 로직을 제거하면 대부분의 의미있는 응용 프로그램에서 size가 향상된다.</p>
<hr>
<h2 id="기본-사용법"><a href="#기본-사용법" class="headerlink" title="기본 사용법"></a>기본 사용법</h2><h3 id="Create-an-API-Slice"><a href="#Create-an-API-Slice" class="headerlink" title="Create an API Slice"></a>Create an API Slice</h3><p>RTK Query는 Redux Toolkit 패키지의 코어를 설치하면 그곳에 포함되어 있다. 아래 두 엔트리 포인트 중 한 가지로 사용할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* React-specific entry point that automatically generates</span></span><br><span class="line"><span class="comment">   hooks corresponding to the defined endpoints */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export hooks를 쓰려면 반드시 /react로 사용</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span>;</span><br></pre></td></tr></table></figure>
<p>React에서 일반적인 사용법은 createApi를 임포트하는 것으로 시작하여 서버의 base url을 정리하고, 접근하고자 하는 엔드포인트를 정리하기 위한 “API slice”를 정의한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Pokemon &#125; <span class="keyword">from</span> <span class="string">'./types'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Define a service using a base URL and expected endpoints</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> pokemonApi = createApi(&#123;</span><br><span class="line">  reducerPath: <span class="string">'pokemonApi'</span>,</span><br><span class="line">  baseQuery: fetchBaseQuery(&#123; <span class="attr">baseUrl</span>: <span class="string">'https://pokeapi.co/api/v2/'</span> &#125;),</span><br><span class="line">  endpoints: <span class="function">(<span class="params">builder</span>) =&gt;</span> (&#123;</span><br><span class="line">    getPokemonByName: builder.query&lt;Pokemon, string&gt;(&#123;</span><br><span class="line">      query: <span class="function">(<span class="params">name</span>) =&gt;</span> <span class="string">`pokemon/<span class="subst">$&#123;name&#125;</span>`</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Export hooks for usage in functional components, which are</span></span><br><span class="line"><span class="comment">// auto-generated based on the defined endpoints</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; useGetPokemonByNameQuery &#125; = pokemonApi</span><br></pre></td></tr></table></figure>
<h2 id="스토어-구성"><a href="#스토어-구성" class="headerlink" title="스토어 구성"></a>스토어 구성</h2><p>“API slice”에는 자동으로 생성되는 slice 리듀서와 구독 수명주기를 매니지 할 수 있는 커스텀 미들웨어를 포함하고 있다. 이 두 가지 모두 Redux 스토어에 추가해야 한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="comment">// Or from '@reduxjs/toolkit/query/react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; setupListeners &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; pokemonApi &#125; <span class="keyword">from</span> <span class="string">'./services/pokemon'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: &#123;</span><br><span class="line">    <span class="comment">// Add the generated reducer as a specific top-level slice</span></span><br><span class="line">    [pokemonApi.reducerPath]: pokemonApi.reducer,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// Adding the api middleware enables caching, invalidation, polling,</span></span><br><span class="line">  <span class="comment">// and other useful features of `rtk-query`.</span></span><br><span class="line">  middleware: <span class="function">(<span class="params">getDefaultMiddleware</span>) =&gt;</span></span><br><span class="line">    getDefaultMiddleware().concat(pokemonApi.middleware),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// optional, but required for refetchOnFocus/refetchOnReconnect behaviors</span></span><br><span class="line"><span class="comment">// see `setupListeners` docs - takes an optional callback as the 2nd arg for customization</span></span><br><span class="line">setupListeners(store.dispatch);</span><br></pre></td></tr></table></figure>
<h2 id="컴포넌트에-hooks사용"><a href="#컴포넌트에-hooks사용" class="headerlink" title="컴포넌트에 hooks사용"></a>컴포넌트에 hooks사용</h2><p>마지막으로 API slice에서 자동 생성된 react hook을 컴포넌트 파일로 임포트 하고, 컴포넌트에서 필요한 파라미터를 사용하여 hooks를 호출한다. RTK Query는 mount될 때 자동으로 data를 fetch하고, 파라미터가 변경될때 re-fetch하며, 결과에 {data, isFetching} 값을 제공한다. 그리고 이 값들이 변경되면 컴포넌트를 리렌더링한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useGetPokemonByNameQuery &#125; <span class="keyword">from</span> <span class="string">'./services/pokemon'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Using a query hook automatically fetches data and returns query values</span></span><br><span class="line">  <span class="keyword">const</span> &#123; data, error, isLoading &#125; = useGetPokemonByNameQuery(<span class="string">'bulbasaur'</span>);</span><br><span class="line">  <span class="comment">// Individual hooks are also accessible under the generated endpoints:</span></span><br><span class="line">  <span class="comment">// const &#123; data, error, isLoading &#125; = pokemonApi.endpoints.getPokemonByName.useQuery('bulbasaur')</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// render UI based on data and loading state</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="사용예시"><a href="#사용예시" class="headerlink" title="사용예시"></a>사용예시</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//dosApiSlice.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createApi, fetchBaseQuery &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> DOGS_API_KEY = <span class="string">'4902a53c-cfda-44e4-a5d7-35b9bd5b6cb9'</span>;</span><br><span class="line"></span><br><span class="line">interface Breed &#123;</span><br><span class="line">  id: string;</span><br><span class="line">  name: string;</span><br><span class="line">  image: &#123;</span><br><span class="line">    url: string;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//api slice</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> apiSlice = createApi(&#123;</span><br><span class="line">  reducerPath: <span class="string">'api'</span>,</span><br><span class="line">  baseQuery: fetchBaseQuery(&#123;</span><br><span class="line">    baseUrl: <span class="string">'https://api.thedogapi.com/v1'</span>,</span><br><span class="line">    prepareHeaders(headers) &#123;</span><br><span class="line">      headers.set(<span class="string">'x-api-key'</span>, DOGS_API_KEY);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> headers;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="comment">//builder에 의해 엔트리 포인트 생성</span></span><br><span class="line">  endpoints(builder) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      fetchBreeds: builder.query&lt;Breed[], number | <span class="keyword">void</span>&gt;(&#123;</span><br><span class="line">        query(limit = <span class="number">10</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">`/breeds?limit=<span class="subst">$&#123;limit&#125;</span>`</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; useFetchBreedsQuery &#125; = apiSlice;</span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//store.ts</span></span><br><span class="line"><span class="comment">//configureStore: basic redux create store function의 wrapper</span></span><br><span class="line"><span class="comment">//create store</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; configureStore, getDefaultMiddleware &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="keyword">import</span> counterReducer <span class="keyword">from</span> <span class="string">'../features/counter/counter-slice'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; apiSlice &#125; <span class="keyword">from</span> <span class="string">'../features/dogs/dogsApiSlice'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//combine reducer</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: &#123;</span><br><span class="line">    counter: counterReducer,</span><br><span class="line">    [apiSlice.reducerPath]: apiSlice.reducer,</span><br><span class="line">  &#125;,</span><br><span class="line">  middleware: <span class="function">(<span class="params">getDefaultMiddleware</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> getDefaultMiddleware().concat(apiSlice.middleware);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ts thing</span></span><br><span class="line"><span class="keyword">export</span> type AppDispatch = <span class="keyword">typeof</span> store.dispatch;</span><br><span class="line"><span class="keyword">export</span> type RootState = ReturnType&lt;<span class="keyword">typeof</span> store.getState&gt;;</span><br></pre></td></tr></table></figure>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//사용하고자 하는 곳에서 사용</span></span><br><span class="line"><span class="keyword">import</span> &#123; useFetchBreedsQuery &#125; <span class="keyword">from</span> <span class="string">'./features/dogs/dogsApiSlice'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//take selector function</span></span><br><span class="line">  <span class="keyword">const</span> count = useAppSelector(<span class="function">(<span class="params">state</span>) =&gt;</span> state.counter.value);</span><br><span class="line">  <span class="keyword">const</span> dispatch = useAppDispatch();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [numDogs, setNumDogs] = useState(<span class="number">10</span>);</span><br><span class="line">  <span class="keyword">const</span> &#123; data = [], isFetching &#125; = useFetchBreedsQuery(numDogs);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(useFetchBreedsQuery);</span><br></pre></td></tr></table></figure>
<hr>
<p><em>References</em><br><a href="https://redux-toolkit.js.org/rtk-query/overview" target="_blank" rel="noopener">RTK Query Overview</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/07/30/210731_reduxToolkit-Ts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/30/210731_reduxToolkit-Ts/" class="post-title-link" itemprop="url">Redux-tookit-typescript 원문 번역</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-31 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-31T00:00:00+09:00">2021-07-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-06 10:57:52" itemprop="dateModified" datetime="2022-07-06T10:57:52+09:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Redux-toolkit-typescript-원문-번역"><a href="#Redux-toolkit-typescript-원문-번역" class="headerlink" title="Redux-toolkit-typescript 원문 번역"></a>Redux-toolkit-typescript 원문 번역</h2><blockquote>
<p>원문링크: <a href="https://redux-toolkit.js.org/tutorials/typescript" target="_blank" rel="noopener">https://redux-toolkit.js.org/tutorials/typescript</a></p>
</blockquote>
<h2 id="Usage-With-TypeScript"><a href="#Usage-With-TypeScript" class="headerlink" title="Usage With TypeScript"></a>Usage With TypeScript</h2><p>Redux Toolkit은 이미 TypeScript로 작성되었으므로 TS 유형 정의가 내장되어 있다. React Redux 는 NPM 의 별도 @types/react-reduxtypedef 패키지 에 type에 대한 정의가 있다. 라이브러리 함수를 작성하는 것 외에도 type은 리덕스 스토어와 리액트 컴포넌트 사이의 인터페이스를 보다 typesage하게 작성하는 것을 쉽게 하도록 도와주는 helper를 export한다.</p>
<p>React Redux v7.2.3부터는 react-redux 패키지가 @types/react-redux에 종속되어서 type 정의는 자동으로 라이브러리와 함께 설치된다. 그렇지 않은 경우에는 직접 수동으로 설치해야 한다. (npm install @types/react-redux)</p>
<p><a href="https://github.com/reduxjs/cra-template-redux-typescript" target="_blank" rel="noopener">The Redux+TS template for Create-React-App</a> comes with a working example of these patterns already configured.</p>
<h1 id="Project-Setup"><a href="#Project-Setup" class="headerlink" title="Project Setup"></a>Project Setup</h1><p>Root State 및 Dispatch Types 정의</p>
<p>configureStore를 사용하면 추가 입력이 필요하지 않다. 하지만 추후에 필요에 따라 참조할 수 있도록 RootState type과 Dispatch type을 추출하고자 하게 된다. 스토어 자체에서 이러한 타입들을 추론한다는 것은 state slice를 추가하거나 미들웨어 세팅을 수정할 때 올바르게 업데이트 된다는 것을 의미한다.</p>
<p>이것들은 모두 type이기 때문에 app/store.ts와 같이 스토어 셋업 파일에서 직접 export하여 다른 파일로 import하는 것이 안전하다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: &#123;</span><br><span class="line">    posts: postsReducer,</span><br><span class="line">    comments: commentsReducer,</span><br><span class="line">    users: usersReducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Infer the `RootState` and `AppDispatch` types from the store itself</span></span><br><span class="line"><span class="comment">//RooteState와 AppDispatch가 스토어 자체에서 추론된다.</span></span><br><span class="line"><span class="keyword">export</span> type RootState = ReturnType&lt;<span class="keyword">typeof</span> store.getState&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 추론된 타입:</span></span><br><span class="line"><span class="comment">// Inferred type: &#123;posts: PostsState, comments: CommentsState, users: UsersState&#125;</span></span><br><span class="line"><span class="keyword">export</span> type AppDispatch = <span class="keyword">typeof</span> store.dispatch;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Define-Typed-Hooks"><a href="#Define-Typed-Hooks" class="headerlink" title="Define Typed Hooks"></a>Define Typed Hooks</h2><p>RooteState와 AppDispatch를 type들을 각각 컴포넌트로 import할 수 있지만, 어플리케이션에서 사용할 수 있도록 타입이 지정된 버전의 useDispatch, useSelector 훅을 사용하는 것이 좋다. 그 이유는 아래와 같다.</p>
<ul>
<li>useSelector를 쓰면 매번 (state:RootState)를 사용할 필요가 없다.</li>
<li>useDispatch를 쓰면 기본 dispatch 타입은 thunk에 대해 알지 못한다. thunk를 올바르게 쓰기 위해서는thunk middlewate type을 포함한 스토어의 특정하게 커스텀된 AppDispatch를 useDispatch와 함께 사용해야 한다. 미리 유형이 정의된 <strong>useDispatch 훅을 추가하고자 할 때는 사용하고자 하는 곳에 AppDispatch를 import해야 하는 것을 잊지 않도록 한다.</strong></li>
</ul>
<p>이들은 type이 아니라 실제 변수이기 때문에 store setup 파일보다는 <strong>app/hooks.ts와 같은 별도의 파일에 정의하는 것이 중요하다.</strong> 이를 통해 hook을 쓰고자 하는 어떠한 파일에서든 hook을 import할 수 있게하고, 잠재적인 import 디펜던시 이슈를 피할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app/hook.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; TypedUseSelectorHook, useDispatch, useSelector &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"><span class="keyword">import</span> type &#123; RootState, AppDispatch &#125; <span class="keyword">from</span> <span class="string">'./store'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Use throughout your app instead of plain `useDispatch` and `useSelector`</span></span><br><span class="line"><span class="comment">// 원형의 useDispatch, useSelector 대신 아래를 사용한다.</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAppDispatch = <span class="function"><span class="params">()</span> =&gt;</span> useDispatch&lt;AppDispatch&gt;()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAppSelector: TypedUseSelectorHook&lt;RootState&gt; = useSelector</span><br></pre></td></tr></table></figure>
<h2 id="Application-Usage"><a href="#Application-Usage" class="headerlink" title="Application Usage"></a>Application Usage</h2><p><code>slice state 및 액션 타입의 정의</code></p>
<p>각각의 slice file은 초기 상태값에 대한 type을 정의해야 createSlice가 각각의 case 리듀서에 있는 state type을 올바르게 추론할 수 있다.</p>
<p>생성된 모든 액션들은 action.payload를 일반적인 인수로 사용하는 Redux Toolkit의 PayloadAction<T> 타입을 사용해서 정의해야 한다.</p>
<p>여기서 store 파일로부터 RootState를 안전하게 import 할 수 있다. circular import이긴 하지만 typsScript 컴파일러가 type을 올바르게 처리할 수 있다. 이는 selector 함수를 작성할 때 필요할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSlice, PayloadAction &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="keyword">import</span> type &#123; RootState &#125; <span class="keyword">from</span> <span class="string">'../../app/store'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Define a type for the slice state</span></span><br><span class="line">interface CounterState &#123;</span><br><span class="line">  value: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Define the initial state using that type</span></span><br><span class="line"><span class="keyword">const</span> initialState: CounterState = &#123;</span><br><span class="line">  value: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> counterSlice = createSlice(&#123;</span><br><span class="line">  name: <span class="string">'counter'</span>,</span><br><span class="line">  <span class="comment">// `createSlice` will infer the state type from the `initialState` argument</span></span><br><span class="line">  initialState,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    increment: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.value += <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    decrement: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.value -= <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// Use the PayloadAction type to declare the contents of `action.payload`</span></span><br><span class="line">    incrementByAmount: <span class="function">(<span class="params">state, action: PayloadAction&lt;number&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      state.value += action.payload;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; increment, decrement, incrementByAmount &#125; = counterSlice.actions;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Other code such as selectors can use the imported `RootState` type</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> selectCount = <span class="function">(<span class="params">state: RootState</span>) =&gt;</span> state.counter.value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> counterSlice.reducer;</span><br></pre></td></tr></table></figure>
<p>생성된 action creator는 작성자가 reducer에 제공한 PayloadAction<T>의 타입 기반으로 payload의 인수를 수락하도록 올바르게 입력됩니다. 예를 들어, 위 코드에서 incrementByAmountsms 인수로 number를 필요로 한다.</p>
<p>몇몇 케이스에선 typeScript가 초기 상태의 type을 불필요하게 tigth하게 만들 수 있다. 만약 이런 일이 발생한다면 변수의 type을 선언하는 대신 <code>as</code> 를 이용해서 초기 상태를 캐스팅하는 방법으로 해결할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Workaround: cast state instead of declaring variable type</span></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  value: <span class="number">0</span>,</span><br><span class="line">&#125; <span class="keyword">as</span> CounterState</span><br></pre></td></tr></table></figure>
<h1 id="Use-Typed-Hooks-in-Components"><a href="#Use-Typed-Hooks-in-Components" class="headerlink" title="Use Typed Hooks in Components"></a>Use Typed Hooks in Components</h1><p>컴포넌트 파일에서 React-Redux의 표준 hook 대신 미리 입력된 hook을 가져온다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; useAppSelector, useAppDispatch &#125; <span class="keyword">from</span> <span class="string">'app/hooks'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; decrement, increment &#125; <span class="keyword">from</span> <span class="string">'./counterSlice'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// The `state` arg is correctly typed as `RootState` already</span></span><br><span class="line">  <span class="keyword">const</span> count = useAppSelector(<span class="function">(<span class="params">state</span>) =&gt;</span> state.counter.value);</span><br><span class="line">  <span class="keyword">const</span> dispatch = useAppDispatch();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// omit rendering logic</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Usage-With-TypeScript-1"><a href="#Usage-With-TypeScript-1" class="headerlink" title="Usage With TypeScript"></a>Usage With TypeScript</h1><blockquote>
<p><a href="https://redux-toolkit.js.org/usage/usage-with-typescript" target="_blank" rel="noopener">https://redux-toolkit.js.org/usage/usage-with-typescript</a></p>
</blockquote>
<p>리덕스 툴킷은 typeScript로 작성되었으며, 해당 API는 TypeScript 응용 프로그램과의 뛰어난 통합을 가능하게 하도록 설계되었다.</p>
<h2 id="configureStore"><a href="#configureStore" class="headerlink" title="configureStore"></a>configureStore</h2><h3 id="state-type-가져오기"><a href="#state-type-가져오기" class="headerlink" title="state type 가져오기"></a>state type 가져오기</h3><p>state type을 가져오는 가장 쉬운 방법은 roote reducer를 미리 정의하고, returnType을 추출하는 것이다. 쇼type 이름인 state는 일반적으로 남용되기 깨문에 혼동을 막기 위해 RootState와 같이 type에 다른 이름을 주는 것을 추천한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="keyword">const</span> rootReducer = combineReducers(&#123;&#125;);</span><br><span class="line"><span class="keyword">export</span> type RootState = ReturnType&lt;<span class="keyword">typeof</span> rootReducer&gt;;</span><br></pre></td></tr></table></figure>
<p>혹은 rootReducer를 직접 생성하지 않고 직접 configureStore()에 slice reducer 전달 할 수 있다. 이 경우 root reducer를 올바르게 추론하기 위해 Type을 약간 수정해야 한다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span>;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: &#123;</span><br><span class="line">    one: oneSlice.reducer,</span><br><span class="line">    two: twoSlice.reducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> type RootState = ReturnType&lt;<span class="keyword">typeof</span> store.getState&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure>
<h3 id="Dispatch-타입-가져오기"><a href="#Dispatch-타입-가져오기" class="headerlink" title="Dispatch 타입 가져오기"></a>Dispatch 타입 가져오기</h3><p>스토어에서 Dispatch 타입을 가져오려면 store를 생성한 후에 추출해야 한다. 이 역시 Dispatch는 남용되기 때문에 혼동을 막기 위해 AppDispatch처럼 다른 type 이름을 지정할 것을 추천한다. 혹은 아래처럼 useAppDispatch hook을 추출하여 useDispatch를 호출할 때 사용하는 것이 더 편할 수 도 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span></span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"><span class="keyword">import</span> rootReducer <span class="keyword">from</span> <span class="string">'./rootReducer'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: rootReducer,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type AppDispatch = <span class="keyword">typeof</span> store.dispatch</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAppDispatch = <span class="function"><span class="params">()</span> =&gt;</span> useDispatch&lt;AppDispatch&gt;()</span><br><span class="line"><span class="comment">// Export a hook that can be reused to resolve types</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>
<h3 id="Dispatch-타입에-대한-올바른-입력"><a href="#Dispatch-타입에-대한-올바른-입력" class="headerlink" title="Dispatch 타입에 대한 올바른 입력"></a>Dispatch 타입에 대한 올바른 입력</h3><p>dispatch 함수의 typedms 미들웨어 옵션에 의해 직접 추론될 수 있다. 만약 미들웨어에 올바른 타입을 추가하고 싶다면 dispatch는 이미 올바르게 입력되어 있어야 한다.</p>
<p>typeScript는 스프레드 연산자를 사용해서 배열을 합칠 때 array type을 확장하는 경우가 많기 때문에 getDefaultMiddleware()에 의해 리턴되는 MiddlewareArray 메소드에서 .concat(…) 또는 .prepend(…)를 사용하는 것이 추천된다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span></span><br><span class="line"><span class="keyword">import</span> additionalMiddleware <span class="keyword">from</span> <span class="string">'additional-middleware'</span></span><br><span class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">'redux-logger'</span></span><br><span class="line"><span class="comment">// @ts-ignore</span></span><br><span class="line"><span class="keyword">import</span> untypedMiddleware <span class="keyword">from</span> <span class="string">'untyped-middleware'</span></span><br><span class="line"><span class="keyword">import</span> rootReducer <span class="keyword">from</span> <span class="string">'./rootReducer'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type RootState = ReturnType&lt;<span class="keyword">typeof</span> rootReducer&gt;</span><br><span class="line"><span class="keyword">const</span> store = configureStore(&#123;</span><br><span class="line">  reducer: rootReducer,</span><br><span class="line">  middleware: <span class="function">(<span class="params">getDefaultMiddleware</span>) =&gt;</span></span><br><span class="line">    getDefaultMiddleware()</span><br><span class="line">      .prepend(</span><br><span class="line">        <span class="comment">// correctly typed middlewares can just be used</span></span><br><span class="line">        additionalMiddleware,</span><br><span class="line">        <span class="comment">// you can also type middlewares manually</span></span><br><span class="line">        untypedMiddleware <span class="keyword">as</span> Middleware&lt;</span><br><span class="line">          (action: Action&lt;<span class="string">'specialAction'</span>&gt;) =&gt; number,</span><br><span class="line">          RootState</span><br><span class="line">        &gt;</span><br><span class="line">      )</span><br><span class="line">      <span class="comment">// prepend and concat calls can be chained</span></span><br><span class="line">      .concat(logger),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type AppDispatch = <span class="keyword">typeof</span> store.dispatch</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>
<h3 id="getDefaultMiddleware-없이-MiddlewareArray-사용"><a href="#getDefaultMiddleware-없이-MiddlewareArray-사용" class="headerlink" title="getDefaultMiddleware 없이 MiddlewareArray 사용"></a>getDefaultMiddleware 없이 MiddlewareArray 사용</h3><p>getDefaultMiddleware의 사용을 완전히 스킵할 경우, 미들웨어 배열의 안전한 타입 연결에 MiddlewareArray를 사용할 수 있다. 이 class는 .concat(…) 및 추가적인 .prepend(…) 메서드에 대한 수정된 유형만 사용하여 기본 JavaScript 배열 유형을 확장한다.</p>
<p>하지만 const로 사용하고, 스프레드 연산자를 사용하지 않는 한 배열 유형을 확장하는 문제가 발생하지 않기 때문에 일반적으로 필요하지는 않다.</p>
<p>다음의 두 가지 호출은 동일하다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore, MiddlewareArray &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit'</span></span><br><span class="line"></span><br><span class="line">configureStore(&#123;</span><br><span class="line">  reducer: rootReducer,</span><br><span class="line">  middleware: <span class="keyword">new</span> MiddlewareArray().concat(additionalMiddleware, logger),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">configureStore(&#123;</span><br><span class="line">  reducer: rootReducer,</span><br><span class="line">  middleware: [additionalMiddleware, logger] <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="React-Redux에서-추출한-Dispatch-type-사용"><a href="#React-Redux에서-추출한-Dispatch-type-사용" class="headerlink" title="React Redux에서 추출한 Dispatch type 사용"></a>React Redux에서 추출한 Dispatch type 사용</h2><p>기본적으로 React Redux useDispatch 훅에는 미들웨어를 고려하는 type이 포함되어 있지 않다. 만약 dispatching을 할 때 dispatch 함수에 대해 더 구체적인 type이 필요한 경우에는 dispatch 함수의 type을 지정하거나, custom-type이 된 버전의 useSelector를 만들어서 사용한다. (<a href="https://react-redux.js.org/using-react-redux/usage-with-typescript#typing-the-usedispatch-hook" target="_blank" rel="noopener">자세한 내용은 이곳 참조</a>)</p>
<h3 id="createAction"><a href="#createAction" class="headerlink" title="createAction"></a>createAction</h3><p>대부분의 케이스에서 action.type에 대한 리터럴 정의는 필요하지 않기 때문에 아래와 같은 코드를 사용할 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createAction&lt;number&gt;(&#39;test&#39;);</span><br></pre></td></tr></table></figure>
<p>이렇게 하면 생성된 action이 PayloadActionCreator<number, string>의 타입이 된다.</p>
<p>일부 설정에서는 action.type에 대한 리터럴 설정이 필요할 수도 있다. 하지만 typeScript는 수동으로 정의된 타입 매개변수와 추론된 타입 매개변수의 혼합을 허용하지 않기 때문에 일반 정의와 실제 JavaScript 코드 모두에서 타입을 지정해야 합니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createAction&lt;number, &#39;test&#39;&gt;(&#39;test&#39;);</span><br></pre></td></tr></table></figure>
<p>중복 없이 이것을 작성하는 다른 방법을 찾고 있다면, callback을 준비하여 두 type 파라미터를 인수에서 추론할 수 있으므로 action type을 특정할 필요가 없다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function withPayloadType&lt;T&gt;() &#123;</span><br><span class="line">  return (t: T) &#x3D;&gt; (&#123; payload: t &#125;);</span><br><span class="line">&#125;</span><br><span class="line">createAction(&#39;test&#39;, withPayloadType&lt;string&gt;());</span><br></pre></td></tr></table></figure>
<h3 id="리터럴하게-입력된-action-type의-대안"><a href="#리터럴하게-입력된-action-type의-대안" class="headerlink" title="리터럴하게 입력된 action.type의 대안"></a>리터럴하게 입력된 action.type의 대안</h3><p>예를 들어 case문에서 payload type을 올바르게 작성하기 위해 action.type을 유니온 식별을 위한 식별자로 사용하는 경우 이 대안에 관심이 있을 수 있다.</p>
<p>생성된 action creators는 <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates" target="_blank" rel="noopener">type predicate</a>로써 match 메소드를 가진다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const increment &#x3D; createAction&lt;number&gt;(&#39;increment&#39;);</span><br><span class="line">function test(action: Action) &#123;</span><br><span class="line">  if (increment.match(action)) &#123;</span><br><span class="line">    &#x2F;&#x2F; action.payload inferred correctly here</span><br><span class="line">    action.payload;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>이 match 메소드는 redux-observable과 RxJS의 filter 메소드를 조합하여 사용하는 경우에도 유용하다.</p>
<h3 id="createReducer"><a href="#createReducer" class="headerlink" title="createReducer"></a>createReducer</h3><p>createReducer의 기본 호출방법은 아래와 같이 “lookup table” / “map object”를 사용하는 것이다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">createReducer(0, &#123;</span><br><span class="line">  increment: (state, action: PayloadAction&lt;number&gt;) &#x3D;&gt; state + action.payload,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>하지만 key는 오직 문자열이기 때문에, API TypeScript를 사용할 경우 action type을 추론하거나 validate할 수 없다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  const increment &#x3D; createAction&lt;number, &#39;increment&#39;&gt;(&#39;increment&#39;);</span><br><span class="line">  const decrement &#x3D; createAction&lt;number, &#39;decrement&#39;&gt;(&#39;decrement&#39;);</span><br><span class="line">  createReducer(0, &#123;</span><br><span class="line">    [increment.type]: (state, action) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; action is any here</span><br><span class="line">    &#125;,</span><br><span class="line">    [decrement.type]: (state, action: PayloadAction&lt;string&gt;) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; even though action should actually be PayloadAction&lt;number&gt;, TypeScript can&#39;t detect that and won&#39;t give a warning here.</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>대안으로 RTK에 type-safe reducer builder API가 포함되어 있다.</p>
<hr>
<h1 id="Building-Type-Safe-Reducer-Argument-Objects"><a href="#Building-Type-Safe-Reducer-Argument-Objects" class="headerlink" title="Building Type-Safe Reducer Argument Objects"></a>Building Type-Safe Reducer Argument Objects</h1><p>createReducer에 대한 인수로 간단한 객체를 사용하는 대신, ActionReducerMapBuilder 인스턴스를 받는 콜백을 사용할 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const increment &#x3D; createAction&lt;number, &#39;increment&#39;&gt;(&#39;increment&#39;);</span><br><span class="line">const decrement &#x3D; createAction&lt;number, &#39;decrement&#39;&gt;(&#39;decrement&#39;);</span><br><span class="line">createReducer(0, (builder) &#x3D;&gt;</span><br><span class="line">  builder</span><br><span class="line">    .addCase(increment, (state, action) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; action is inferred correctly here</span><br><span class="line">    &#125;)</span><br><span class="line">    .addCase(decrement, (state, action: PayloadAction&lt;string&gt;) &#x3D;&gt; &#123;</span><br><span class="line">      &#x2F;&#x2F; this would error out</span><br><span class="line">    &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>리듀서 인수 객체를 정의할 때 보다 엄격한 type 안정성이 필요한 경우에 사용이 추천된다.</p>
<h3 id="builder-addMatcher"><a href="#builder-addMatcher" class="headerlink" title="builder.addMatcher"></a>builder.addMatcher</h3><p>builder.addMatcher의 첫 번째 matcher에 <a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates" target="_blank" rel="noopener">type predicate</a> 함수를 사용할 수 있다. 결과적으로 두번째 reducer 인수에 대한 action 인수는 typeScript에 의해 유츄될 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function isNumberValueAction(action: AnyAction): action is PayloadAction&lt;&#123; value: number &#125;&gt; &#123;</span><br><span class="line">  return typeof action.payload.value &#x3D;&#x3D;&#x3D; &#39;number&#39;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">createReducer(&#123; value: 0 &#125;, builder &#x3D;&gt;</span><br><span class="line">   builder.addMatcher(isNumberValueAction, (state, action) &#x3D;&gt; &#123;</span><br><span class="line">      state.value +&#x3D; action.payload.value</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="createSlice"><a href="#createSlice" class="headerlink" title="createSlice"></a>createSlice</h1><p>createSlice는 action 뿐만 아니라 reducer도 만드는데 여기서 type safety에 대해 걱정할 필요는 없다. action types는 인라인으로 제공될 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const slice &#x3D; createSlice(&#123;</span><br><span class="line">  name: &#39;test&#39;,</span><br><span class="line">  initialState: 0,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    increment: (state, action: PayloadAction&lt;number&gt;) &#x3D;&gt; state + action.payload,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line">&#x2F;&#x2F; now available:</span><br><span class="line">slice.actions.increment(2);</span><br><span class="line">&#x2F;&#x2F; also available:</span><br><span class="line">slice.caseReducers.increment(0, &#123; type: &#39;increment&#39;, payload: 5 &#125;);</span><br></pre></td></tr></table></figure>
<p>케이스 리듀서가 너무 많아서 인라인으로 정의하는 것이 지저분하거나 슬라이스 전체에서 케이스 리듀서를 재사용하려는 경우 createSlice 외부에서 정의하여 호출하고 caseReducer처럼 입력할 수도 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">type State &#x3D; number;</span><br><span class="line">const increment: CaseReducer&lt;State, PayloadAction&lt;number&gt;&gt; &#x3D; (state, action) &#x3D;&gt;</span><br><span class="line">  state + action.payload;</span><br><span class="line"></span><br><span class="line">createSlice(&#123;</span><br><span class="line">  name: &#39;test&#39;,</span><br><span class="line">  initialState: 0,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    increment,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<hr>
<p><em>References</em></p>
<p><a href="https://redux-toolkit.js.org/introduction/getting-started#rtk-query" target="_blank" rel="noopener">Getting Started | Redux Toolkit</a><br><a href="https://youtu.be/9zySeP5vH9c" target="_blank" rel="noopener">Let’s Learn Modern Redux! (with Mark Erikson) - Learn With Jason</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/07/29/210730_reduxToolkit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/29/210730_reduxToolkit/" class="post-title-link" itemprop="url">Redux-tookit 원문 번역</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-30 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-30T00:00:00+09:00">2021-07-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-06 10:57:52" itemprop="dateModified" datetime="2022-07-06T10:57:52+09:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Redux-toolkit-원문-번역"><a href="#Redux-toolkit-원문-번역" class="headerlink" title="Redux-toolkit 원문 번역"></a>Redux-toolkit 원문 번역</h2><blockquote>
<p>원문링크: <a href="https://redux-toolkit.js.org/introduction/getting-started#rtk-query" target="_blank" rel="noopener">https://redux-toolkit.js.org/introduction/getting-started#rtk-query</a></p>
</blockquote>
<p>Redux toolkt은 리덕스 로직을 표준화하기 위한 패키지이다. 원래는 리덕스가 가지고 있는 세가지 문제점을 지원하기 위해 만들어졌다.</p>
<ul>
<li>리덕스 스토어를 구성하는 방법이 지나치게 복잡하다.</li>
<li>리덕스를 사용하기 위해 많은 패키지를 설치해야 한다</li>
<li>리덕스는 지나치게 많은 보일러 플레이트 코드를 필요로 한다.</li>
</ul>
<p>리덕스가 가진 이러한 문제점에 대헤 모든 것을 커버할 순 없지만 create-react-app과 appllo-boost를 근간으로 하여 보다 추상화된 셋업 프로세스와 가장 많이 사용되는 use cases를 처리하기 위한 방법을 제공할 수 있을 뿐 아니라 사용자가 어플리케이션 코드를 단순화할 수 있는 유용한 유틸리티를 제공한다.</p>
<p>리덕스 툴킷은 또한 data fetching과 캐싱을 할 수 있는 ‘RTK Query’를 포함하는데, 별도의 엔트리포인트 set로 패키지 안에 포함되어 있다. 옵셔널이지만 직접 data fetching 로직을 작성하지 않아도 된다.<br>이 툴은 리덕스 유저들에게 유용하다. 만약 당신이 프로젝트에 리덕스를 처음 적용해보는 유저거나 어플리케이션 내에 존재하는 코드를 단순화 시키고자 하는 익숙한 리덕스 유저든, 리덕스 툴킷은 당신의 리덕스 코드를 훨씬 좋게 만들 것이다.</p>
<hr>
<h2 id="설치방법"><a href="#설치방법" class="headerlink" title="설치방법"></a>설치방법</h2><h3 id="Create-React-App을-이용"><a href="#Create-React-App을-이용" class="headerlink" title="Create React App을 이용"></a>Create React App을 이용</h3><p>가장 추천되는 방법으로 official Redux + JS template 또는 create React App용 Redux + Ts template을 사용하는 것이다. 이 템플릿은 redux toolkit 및 react redux 구성 요소의 통합을 활용한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Redux + Plain JS template</span><br><span class="line">npx create-react-app my-app --template redux</span><br><span class="line"></span><br><span class="line"># Redux + TypeScript template</span><br><span class="line">npx create-react-app my-app --template redux-typescript</span><br></pre></td></tr></table></figure>
<h3 id="기존-앱"><a href="#기존-앱" class="headerlink" title="기존 앱"></a>기존 앱</h3><p>redux toolkit은 모듈 번들러용 npm 패키지로 또는 노드 어플리케이션에서 사용 가능하다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># NPM</span><br><span class="line">npm install @reduxjs&#x2F;toolkit</span><br><span class="line"></span><br><span class="line"># Yarn</span><br><span class="line">yarn add @reduxjs&#x2F;toolkit</span><br></pre></td></tr></table></figure>
<p>또는 window.RTK의 전역 변수로 정의된 precompiled UMD package로 사용가능하다. UMD package는 <code>&lt;script&gt;</code>태그로 바로 사용할 수 있다.</p>
<hr>
<h2 id="Redux-toolkit에-포함된-것"><a href="#Redux-toolkit에-포함된-것" class="headerlink" title="Redux-toolkit에 포함된 것"></a>Redux-toolkit에 포함된 것</h2><ul>
<li><code>[configureStore()](https://redux-toolkit.js.org/api/configureStore)</code>: 단순화된 구성옵션과 좋은 기본값을 제공하기 위해 <code>createStore</code> 로 감싼다. 이는 자동으로 slice reducer와 결합할 수 있고, 사용자게 제공하는 리덕스 미들웨어가 무엇이든 간에 redux-thunk를 디폴트로 제공한다. 또 redux devtools extension을 사용할 수 있다.</li>
<li><code>[createReducer()](https://redux-toolkit.js.org/api/createReducer)</code>: switch 문으로 액션 타입의 목록을 작성하는 대신, case reducer funxtion들로 액션타입의 목록을 제공한다. 추가로 자동으로 immer 라이브러리를 사용하여 immutable한 업데이트를 normal mutative 코드를 통해 단순화한다. 예를 들어 state.todos[3].completed = true.처럼.</li>
<li><code>[createAction()](https://redux-toolkit.js.org/api/createAction)</code>: 주어진 액션 타입 문자열에 대한 action creator 함수를 생성한다. 이 함수는 스스로 toString()으로 정의되기 때문에 type 상수대신 사용할 수 있다.</li>
<li><code>[createSlice()](https://redux-toolkit.js.org/api/createSlice)</code>: reducer 함수의 객체, a slice name, 초기값을 받아들여서 이와 상응하는 action creators, action types을 가진 slice reducer를 자동으로 생성한다.</li>
<li><code>[createAsyncThunk](https://redux-toolkit.js.org/api/createAsyncThunk)</code>: 액션 타입 문자열을 받아들여서 promise를 return하는 함수를 반환하고, 이 promise에 근거하여 pending/fulfilled/rejected 의 액션 타입을 디스패치하는 thunk를 생성한다.</li>
<li><code>[createEntityAdapter](https://redux-toolkit.js.org/api/createEntityAdapter)</code>: 스토어에 있는 정규화된 data(normalized date)를 관리하기 위해 재사용 가능한 리듀서와 selectors set를 생성한다.</li>
<li>The <code>[createSelector</code> utility](<a href="https://redux-toolkit.js.org/api/createSelector" target="_blank" rel="noopener">https://redux-toolkit.js.org/api/createSelector</a>) from the <a href="https://github.com/reduxjs/reselect" target="_blank" rel="noopener">Reselect</a> library, re-exported for ease of use.</li>
</ul>
<hr>
<h1 id="RTK-Query"><a href="#RTK-Query" class="headerlink" title="RTK Query"></a>RTK Query</h1><p>@reduxjs/toolkit package 에 옵셔널로 포함되어 제공되는 것이다. data fetching과 캐싱의 사용 사례를 해결하기 위해 제작되었고, app의 API 인터페이스 계틍을 정의하기 위해 작지만 강력한 툴셋을 제공한다. 웹 어플리케이션에서 데이터를 로딩하는 보통의 경우를 단순화하도록 만들어졌기 때문에 직접 data fetching과 캐싱 로직을 작성할 필요가 없다.</p>
<p>RTK 쿼리는 실행을 위해 Redux Toolkit 코어 위에 구축되는데, 아키텍처 내부에서 redux를 내부적으로 사용하기 위함이다. RTK 쿼리를 쓰기 위해서 리덕스나 RTK에 대한 지식이 필요하지는 않지만 RTK 쿼리가 제공하는 모든 추가적인 global store 관리 기능을 탐색할 필요가 있고, RTK 쿼리를 완전하게 사용하여 요청 및 캐시 동작의 타임라인을 재현하고, 횡단하기 위해 Redux DevTools 브라우저 확장 프로그램을 설치해야한다.</p>
<p>RTK 쿼리는 core Redux Toolkit package 내부에 설치되어있다. 아래 두 가지 엔트리 포인트를 통해 사용할 수 있다.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* React-specific entry point that automatically generates</span></span><br><span class="line"><span class="comment">   hooks corresponding to the defined endpoints */</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApi &#125; <span class="keyword">from</span> <span class="string">'@reduxjs/toolkit/query/react'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="RTK-쿼리안에-들어-있는-것"><a href="#RTK-쿼리안에-들어-있는-것" class="headerlink" title="RTK 쿼리안에 들어 있는 것"></a>RTK 쿼리안에 들어 있는 것</h3><p>다음의 API가 포함된다.</p>
<ul>
<li><code>[createApi()](https://redux-toolkit.js.org/rtk-query/api/createApi)</code>: RTK 쿼리 기능의 핵심. 일련의 엔드포인트로부터 데이터를 어떻게 회수해오는지와 관련된 방법, 데이터를 fetch하고 transtorm하는 방법을 설명하는 엔드리 포인트 set를 정의할 수 있다. 보통 기본 URL당 하나의 API 슬라이스를 사용하여 app에서 한 번만 쓰여야 한다.</li>
<li><code>[fetchBaseQuery()](https://redux-toolkit.js.org/rtk-query/api/fetchBaseQuery)</code>: 요청을 단순화하는 목적을 가진 작은 wrapper이다. 대부분의 사용자에게 createApi에서 권장되는 baseQuery로 사용된다.</li>
<li><code>[&lt;ApiProvider /&gt;](https://redux-toolkit.js.org/rtk-query/api/ApiProvider)</code>: 리덕스 스토어가 아직 없는 상태에서 Provider로 사용할 수 있다.</li>
<li><code>[setupListeners()](https://redux-toolkit.js.org/rtk-query/api/setupListeners)</code>: refetchOnMount, refetchOnReconnect 동작을 활성화하는 데 사용되는 유틸리티이다.</li>
</ul>
<hr>
<p><em>References</em></p>
<p><a href="https://redux-toolkit.js.org/introduction/getting-started#rtk-query" target="_blank" rel="noopener">Getting Started | Redux Toolkit</a><br><a href="https://youtu.be/9zySeP5vH9c" target="_blank" rel="noopener">Let’s Learn Modern Redux! (with Mark Erikson) - Learn With Jason</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/07/20/210721_react-table/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/20/210721_react-table/" class="post-title-link" itemprop="url">React Table</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-21 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-21T00:00:00+09:00">2021-07-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-06 10:57:52" itemprop="dateModified" datetime="2022-07-06T10:57:52+09:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="headless-UI"><a href="#headless-UI" class="headerlink" title="headless UI"></a>headless UI</h2><p>실제 UI 요소를 제공하거나 렌더하지 않지만 라이브러리가 제공하는 state와 callback hooks를 통해서 테이블 마크업을 커스텀할 수 있다.</p>
<p>headless user interface component는 아무런 인터페이스를 제공하지 않음으로써 최대의 시각적 유연성을 제공하는 컴포넌트이다. <em>유저 인터페이스가 없는 유저 인터페이스</em>라고 할 수 있다. 이는 컴포넌트의 로직과 동작을 시각적 표현에서 분리하는 것이다.</p>
<p><code>&lt;CoinFlip/&gt;</code>를 예로 들자면 이 컴포넌트를 child component의 함수로 쓰거나 prop을 렌더하는 식으로 사용한다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> flip = <span class="function"><span class="params">()</span> =&gt;</span> (&#123;</span><br><span class="line">  flipResults: <span class="built_in">Math</span>.random(),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CoinFlip</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  state = flip();</span><br><span class="line"></span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(flip);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.props.children(&#123;</span><br><span class="line">      rerun: <span class="keyword">this</span>.handleClick,</span><br><span class="line">      isHeads: <span class="keyword">this</span>.state.flipResults &lt; <span class="number">0.5</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>위 함수는 headless이다. 아무것도 렌더하지 않기 때문이다. 이 함수는 다양한 consumer들이 여러 논리적인 처리를 하면서 프레젠테이션 작업도 할 것을 기대하고 있다. 따라서 어플리케이션 코드는 다음과 같다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;CoinFlip&gt;</span><br><span class="line">  &#123;(&#123; rerun, isHeads &#125;) =&gt; (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;button onClick=&#123;rerun&#125;&gt;Reflip&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &#123;isHeads ? (</span></span><br><span class="line"><span class="regexp">        &lt;div&gt;</span></span><br><span class="line"><span class="regexp">          &lt;img src='/</span>heads.svg<span class="string">' alt='</span>Heads<span class="string">' /&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">      ) : (</span></span><br><span class="line"><span class="string">        &lt;div&gt;</span></span><br><span class="line"><span class="string">          &lt;img src='</span>/tails.svg<span class="string">' alt='</span>Tails<span class="string">' /&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">      )&#125;</span></span><br><span class="line"><span class="string">    &lt;/&gt;</span></span><br><span class="line"><span class="string">  )&#125;</span></span><br><span class="line"><span class="string">&lt;/CoinFlip&gt;</span></span><br></pre></td></tr></table></figure>
<p>여기서는 render prop을 받는 것으로 headless가 구현되었는데, HOC로 구현될 수도 있다.<br>혹은 View와 Controller, ViewModel과 View의 패턴으로 구현될 수도 있다. 여러 방법이 있겠지만 여기서 중요한 점은 동전을 뒤집는 매커니즘과 그 매커니즘의 인터페이스를 분리했다는 것이다.</p>
<h2 id="react-table"><a href="#react-table" class="headerlink" title="react-table"></a>react-table</h2><p>모든 <code>React Table</code>에서는 useTable hook과 <code>table instance 객체</code>가 리턴된다. 이 <code>table instance 객체</code>는 table을 만들고, table의 state와 상호작용할 수 있는 모든 것을 포함한다.</p>
<h3 id="getting-your-data"><a href="#getting-your-data" class="headerlink" title="getting your data"></a>getting your data</h3><p>테이블 구조를 생각해보면 보통 rows(행)과 columns(열)로 구성된 구조를 떠올린다. 그렇지만 테이블 구성이 단순히 행과 열의 조합으로 생각하기에는 중첩된 columns(열)과 행 등의 구조를 가질 수 있는 등 점점 복잡한 구조를 가지기 때문에 <strong>아래와 같은 구조로 기본 데이터 구조를 정의한다.</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = React.useMemo(</span><br><span class="line">  () =&gt; [</span><br><span class="line">    &#123;</span><br><span class="line">      col1: <span class="string">'Hello'</span>,</span><br><span class="line">      col2: <span class="string">'World'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      col1: <span class="string">'react-table'</span>,</span><br><span class="line">      col2: <span class="string">'rocks'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      col1: <span class="string">'whatever'</span>,</span><br><span class="line">      col2: <span class="string">'you want'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  []</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><u>여기서 중요한 점은 useMemo를 사용했다는 것이다.</u> 이는 데이터가 매번 렌더될 때마다 새롭게 생성되지 않음을 보장하는 것이다. 만약 useMemo를 쓰지 않는다면 table은 렌더될 때마다 새로운 데이터를 받았다고 생각하기 때문에 매번 많은 로직은 새로 계산하려고 시도하게 된다.</p>
<h3 id="Define-Columns"><a href="#Define-Columns" class="headerlink" title="Define Columns"></a>Define Columns</h3><p>useTable hook에 전달하기 위해 column에 대한 정의를 한다. 역시 마찬가지로 useMemo를 사용했기 때문에 매번 렌더될 때마다 새롭게 계산하지 않고, value를 기억해뒀다가 메모제이션된 value와 실제 value에 차이가 있을 때만 변화시킨다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> columns = React.useMemo(</span><br><span class="line">  () =&gt; [</span><br><span class="line">    &#123;</span><br><span class="line">      Header: <span class="string">'Column 1'</span>,</span><br><span class="line">      accessor: <span class="string">'col1'</span>, <span class="comment">// accessor is the "key" in the data</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      Header: <span class="string">'Column 2'</span>,</span><br><span class="line">      accessor: <span class="string">'col2'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  []</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="Using-the-useTable-hook"><a href="#Using-the-useTable-hook" class="headerlink" title="Using the useTable hook"></a>Using the useTable hook</h3><p>위에서 작성한 data와 column에 대한 정의를 가지고 useTable hook에 전달하여 새로운 table instance를 생성할 수 있다. 즉 useTable은 최소 메모제이션된 columns와 data를 포함한 객체를 제공받아야 한다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tableInstance = useTable(&#123; columns, data &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Building-a-basic-table-UI"><a href="#Building-a-basic-table-UI" class="headerlink" title="Building a basic table UI"></a>Building a basic table UI</h3><p>table instance는 만들었지만 아직 테이블 마크업과 스타일은 하지 않은 상태이므로 기본적인 테이블 구조를 작성해준다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">return (</span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="Applying-the-table-instance-to-markup"><a href="#Applying-the-table-instance-to-markup" class="headerlink" title="Applying the table instance to markup"></a>Applying the table instance to markup</h3><p>이제 기본적인 테이블 구조를 작성했으니 이를 이용해서 tableInstance를 얻을 수 있다. 이를 이용해 테이블 작성을 완료할 수 있다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tableInstance = useTable(&#123; columns, data &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; getTableProps, getTableBodyProps, headerGroups, rows, prepareRow &#125; =</span><br><span class="line">  tableInstance;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">  <span class="comment">// apply the table props</span></span><br><span class="line">  &lt;table &#123;...getTableProps()&#125;&gt;</span><br><span class="line">    &lt;thead&gt;</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// Loop over the header rows</span></span><br><span class="line">        headerGroups.map(<span class="function">(<span class="params">headerGroup</span>) =&gt;</span> (</span><br><span class="line">          <span class="comment">// Apply the header row props</span></span><br><span class="line">          &lt;tr &#123;...headerGroup.getHeaderGroupProps()&#125;&gt;</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="comment">// Loop over the headers in each row</span></span><br><span class="line">              headerGroup.headers.map(<span class="function">(<span class="params">column</span>) =&gt;</span> (</span><br><span class="line">                <span class="comment">// Apply the header cell props</span></span><br><span class="line">                &lt;th &#123;...column.getHeaderProps()&#125;&gt;</span><br><span class="line">                  &#123;</span><br><span class="line">                    <span class="comment">// Render the header</span></span><br><span class="line">                    column.render(<span class="string">'Header'</span>)</span><br><span class="line">                  &#125;</span><br><span class="line">                &lt;<span class="regexp">/th&gt;</span></span><br><span class="line"><span class="regexp">              ))</span></span><br><span class="line"><span class="regexp">            &#125;</span></span><br><span class="line"><span class="regexp">          &lt;/</span>tr&gt;</span><br><span class="line">        ))</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;<span class="regexp">/thead&gt;</span></span><br><span class="line"><span class="regexp">    &#123;/</span>* Apply the table body props *<span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">    &lt;tbody &#123;...getTableBodyProps()&#125;&gt;</span></span><br><span class="line"><span class="regexp">      &#123;</span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/ Loop over the table rows</span></span><br><span class="line"><span class="regexp">        rows.map((row) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">          /</span><span class="regexp">/ Prepare the row for display</span></span><br><span class="line"><span class="regexp">          prepareRow(row);</span></span><br><span class="line"><span class="regexp">          return (</span></span><br><span class="line"><span class="regexp">            /</span><span class="regexp">/ Apply the row props</span></span><br><span class="line"><span class="regexp">            &lt;tr &#123;...row.getRowProps()&#125;&gt;</span></span><br><span class="line"><span class="regexp">              &#123;</span></span><br><span class="line"><span class="regexp">                /</span><span class="regexp">/ Loop over the rows cells</span></span><br><span class="line"><span class="regexp">                row.cells.map((cell) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">                  /</span><span class="regexp">/ Apply the cell props</span></span><br><span class="line"><span class="regexp">                  return (</span></span><br><span class="line"><span class="regexp">                    &lt;td &#123;...cell.getCellProps()&#125;&gt;</span></span><br><span class="line"><span class="regexp">                      &#123;</span></span><br><span class="line"><span class="regexp">                        /</span><span class="regexp">/ Render the cell contents</span></span><br><span class="line"><span class="regexp">                        cell.render('Cell')</span></span><br><span class="line"><span class="regexp">                      &#125;</span></span><br><span class="line"><span class="regexp">                    &lt;/</span>td&gt;</span><br><span class="line">                  );</span><br><span class="line">                &#125;)</span><br><span class="line">              &#125;</span><br><span class="line">            &lt;<span class="regexp">/tr&gt;</span></span><br><span class="line"><span class="regexp">          );</span></span><br><span class="line"><span class="regexp">        &#125;)</span></span><br><span class="line"><span class="regexp">      &#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>tbody&gt;</span><br><span class="line">  &lt;<span class="regexp">/table&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
<h3 id="Final-Result"><a href="#Final-Result" class="headerlink" title="Final Result"></a>Final Result</h3><p>앞의 모든 과정을 한번에 표현해보면 다음과 같다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useTable &#125; <span class="keyword">from</span> <span class="string">'react-table'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> data = React.useMemo(</span><br><span class="line">    () =&gt; [</span><br><span class="line">      &#123;</span><br><span class="line">        col1: <span class="string">'Hello'</span>,</span><br><span class="line">        col2: <span class="string">'World'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        col1: <span class="string">'react-table'</span>,</span><br><span class="line">        col2: <span class="string">'rocks'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        col1: <span class="string">'whatever'</span>,</span><br><span class="line">        col2: <span class="string">'you want'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    []</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> columns = React.useMemo(</span><br><span class="line">    () =&gt; [</span><br><span class="line">      &#123;</span><br><span class="line">        Header: <span class="string">'Column 1'</span>,</span><br><span class="line">        accessor: <span class="string">'col1'</span>, <span class="comment">// accessor is the "key" in the data</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        Header: <span class="string">'Column 2'</span>,</span><br><span class="line">        accessor: <span class="string">'col2'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    []</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; getTableProps, getTableBodyProps, headerGroups, rows, prepareRow &#125; =</span><br><span class="line">    useTable(&#123; columns, data &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;table &#123;...getTableProps()&#125; style=&#123;&#123; <span class="attr">border</span>: <span class="string">'solid 1px blue'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;thead&gt;</span><br><span class="line">        &#123;headerGroups.map(<span class="function">(<span class="params">headerGroup</span>) =&gt;</span> (</span><br><span class="line">          &lt;tr &#123;...headerGroup.getHeaderGroupProps()&#125;&gt;</span><br><span class="line">            &#123;headerGroup.headers.map(<span class="function">(<span class="params">column</span>) =&gt;</span> (</span><br><span class="line">              &lt;th</span><br><span class="line">                &#123;...column.getHeaderProps()&#125;</span><br><span class="line">                style=&#123;&#123;</span><br><span class="line">                  borderBottom: <span class="string">'solid 3px red'</span>,</span><br><span class="line">                  background: <span class="string">'aliceblue'</span>,</span><br><span class="line">                  color: <span class="string">'black'</span>,</span><br><span class="line">                  fontWeight: <span class="string">'bold'</span>,</span><br><span class="line">                &#125;&#125;</span><br><span class="line">              &gt;</span><br><span class="line">                &#123;column.render(<span class="string">'Header'</span>)&#125;</span><br><span class="line">              &lt;<span class="regexp">/th&gt;</span></span><br><span class="line"><span class="regexp">            ))&#125;</span></span><br><span class="line"><span class="regexp">          &lt;/</span>tr&gt;</span><br><span class="line">        ))&#125;</span><br><span class="line">      &lt;<span class="regexp">/thead&gt;</span></span><br><span class="line"><span class="regexp">      &lt;tbody &#123;...getTableBodyProps()&#125;&gt;</span></span><br><span class="line"><span class="regexp">        &#123;rows.map((row) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">          prepareRow(row);</span></span><br><span class="line"><span class="regexp">          return (</span></span><br><span class="line"><span class="regexp">            &lt;tr &#123;...row.getRowProps()&#125;&gt;</span></span><br><span class="line"><span class="regexp">              &#123;row.cells.map((cell) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">                return (</span></span><br><span class="line"><span class="regexp">                  &lt;td</span></span><br><span class="line"><span class="regexp">                    &#123;...cell.getCellProps()&#125;</span></span><br><span class="line"><span class="regexp">                    style=&#123;&#123;</span></span><br><span class="line"><span class="regexp">                      padding: '10px',</span></span><br><span class="line"><span class="regexp">                      border: 'solid 1px gray',</span></span><br><span class="line"><span class="regexp">                      background: 'papayawhip',</span></span><br><span class="line"><span class="regexp">                    &#125;&#125;</span></span><br><span class="line"><span class="regexp">                  &gt;</span></span><br><span class="line"><span class="regexp">                    &#123;cell.render('Cell')&#125;</span></span><br><span class="line"><span class="regexp">                  &lt;/</span>td&gt;</span><br><span class="line">                );</span><br><span class="line">              &#125;)&#125;</span><br><span class="line">            &lt;<span class="regexp">/tr&gt;</span></span><br><span class="line"><span class="regexp">          );</span></span><br><span class="line"><span class="regexp">        &#125;)&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>tbody&gt;</span><br><span class="line">    &lt;<span class="regexp">/table&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Hook-Usage"><a href="#Hook-Usage" class="headerlink" title="Hook Usage"></a>Hook Usage</h3><p><code>React Table</code>은 리액트 훅은 내외부에서 사용하여 구성하고, lifecycle를 관리한다. 그리고 기본적으로 custom react hook과 호환되는 hook을 가진다.</p>
<p><code>useTable</code>은 가장 기본적으로 사용되는 훅인데, 모든 옵션과 플러그인 훅의 스타팅 포인트로 제공된다. 옵션이 <code>useTable</code>로 전달되면 제공받은 순서대로 모든 플러그인 훅으로 전달되고, 최종 instance를 만들어 결과적으로 table state와 상호작용하는 나만의 table UI를 만들 수 있다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> instance = useTable(</span><br><span class="line">  &#123;</span><br><span class="line">    data: [...],</span><br><span class="line">    columns: [...],</span><br><span class="line">  &#125;,</span><br><span class="line">  useGroupBy,</span><br><span class="line">  useFilters,</span><br><span class="line">  useSortBy,</span><br><span class="line">  useExpanded,</span><br><span class="line">  usePagination</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="The-stages-of-React-Table-and-plugins"><a href="#The-stages-of-React-Table-and-plugins" class="headerlink" title="The stages of React Table and plugins"></a>The stages of <code>React Table</code> and plugins</h3><ol>
<li>useTable이 호출되어 table instance가 만들어진다.</li>
<li>instance.state는 custom user state나 자동으로 생성된 것으로 resolve된다.</li>
<li>플러그인 포인트들의 컬렉션은 instance.hooks에 생성된다.</li>
<li>각 플러그인은 instance.hook에 hook을 추가할 수 있다.</li>
<li>useTable 로직이 실행되면서 각 플러그인 훅 type은 등록된 순서대로 개별 hook 함수가 실행되는 순서에 따라 특정 시점에서 사용된다.</li>
<li>useTable로부터 최종적인 instance 객체를 얻고, 이를 이용해 개발자가 자신만의 테이블을 만들 수 있다.</li>
</ol>
<h3 id="Plugin-Hook-Order-amp-Consistency"><a href="#Plugin-Hook-Order-amp-Consistency" class="headerlink" title="Plugin Hook Order &amp; Consistency"></a>Plugin Hook Order &amp; Consistency</h3><p>플러그인 hook의 순서와 사용은 다른 custom hooks가 그러하듯 항상 같은 순서로 호출되어야 한다는 hooks의 법칙에 따른다.</p>
<h3 id="Option-Memoization"><a href="#Option-Memoization" class="headerlink" title="Option Memoization"></a>Option Memoization</h3><p><code>React Table</code>은 state와 사이드 이펙트를 업데이트하거나 계산해야하는 타이밍을 메모제이션에 의존한다. 이 말은 모든 옵션이 useTable에 전달될 때 useMemo 또는 useCallback으로 메모제이션되어야 한다는 의미이다.</p>
<hr>
<p><em>References</em><br><a href="https://www.merrickchristensen.com/articles/headless-user-interface-components/" target="_blank" rel="noopener">HEADLESS USER INTERFACE COMPONENTS</a><br><a href="https://react-table.tanstack.com/docs/overview" target="_blank" rel="noopener">React Table - overview</a><br><a href="https://react-table.tanstack.com/docs/quick-start" target="_blank" rel="noopener">React Table - Quick Start</a><br><a href="https://react-table.tanstack.com/docs/api/overview" target="_blank" rel="noopener">React Table - Overview</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/07/19/210720_hashset/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/19/210720_hashset/" class="post-title-link" itemprop="url">컬렉션 - 해시셋, 컬렉션과 같이 쓰면 유용한 것들</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-20 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-20T00:00:00+09:00">2021-07-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-06 10:57:52" itemprop="dateModified" datetime="2022-07-06T10:57:52+09:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>딕셔너리와 매우 비슷하다. <strong>차이점은 해시셋은 키만 있다는 점이다.</strong></li>
<li>리스트와 딕셔너리를 쓰는 경우가 거의 90%이므로 거의 쓸 일이 없고, 특별할 때만 쓴다.</li>
<li>중복 데이터를 제거할 때 가장 쓰기 편하다.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HashSet&lt;T&gt; &lt;변수명&gt; &#x3D; new HastSet &lt;T&gt;(); &#x2F;&#x2F;T는 저장할 키의 자료형</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HashSet&lt;int&gt; studentIDs &#x3D; new HashSet &lt;int&gt; ();</span><br><span class="line">HastSet&lt;string&gt; studentNames &#x3D; new HashSet &lt;string&gt; ();</span><br></pre></td></tr></table></figure>
<h2 id="해시셋에-요소-추가하기"><a href="#해시셋에-요소-추가하기" class="headerlink" title="해시셋에 요소 추가하기"></a>해시셋에 요소 추가하기</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bool bSuccess &#x3D; HastSet&lt;T&gt;.Add(T data);</span><br></pre></td></tr></table></figure>
<ul>
<li><em>해시셋에 <code>없는 키</code>면</em> 새 요소로 추가한 후 참을 반환</li>
<li><em>해시셋에 <code>있는 키</code>면</em> 거짓을 반환</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HashSet&lt;int&gt; studentIDs &#x3D; new HashSet &lt;int&gt;();</span><br><span class="line">bool bSuccess1 &#x3D; studentIDs.Add(123); &#x2F;&#x2F;참</span><br><span class="line">bool bSuccess2 &#x3D; studentIDs.Add(456); &#x2F;&#x2F;참</span><br><span class="line">bool bSuccess3 &#x3D; studentIDs.Add(123); &#x2F;&#x2F;거짓</span><br></pre></td></tr></table></figure>
<h2 id="이-요소가-해시셋에-있나요"><a href="#이-요소가-해시셋에-있나요" class="headerlink" title="이 요소가 해시셋에 있나요?"></a>이 요소가 해시셋에 있나요?</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bool bConatin &#x3D; HastSet&lt;T&gt;.Contain(T data);</span><br></pre></td></tr></table></figure>
<ul>
<li><em>해시셋에 <code>있는 키</code>면</em> 참을 반환</li>
<li><em>해시셋에 <code>없는 키</code>면</em> 거짓을 반환</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HashSet&lt;int&gt; studentIDs &#x3D; new HashSet &lt;int&gt;(); &#x2F;&#x2F;&#123;123, 456&#125;</span><br><span class="line">bool bContain1 &#x3D; studentIDs.Contains(123); &#x2F;&#x2F;참</span><br><span class="line">bool bContain2 &#x3D; studentIDs.Contains(178); &#x2F;&#x2F;거짓</span><br></pre></td></tr></table></figure>
<h2 id="해시셋-요소-삭제"><a href="#해시셋-요소-삭제" class="headerlink" title="해시셋 요소 삭제"></a>해시셋 요소 삭제</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bool bRemoved &#x3D; HastSet&lt;T&gt;.Remove(T data);</span><br></pre></td></tr></table></figure>
<ul>
<li><em>해시셋에 <code>있는 키</code>면</em> 요소를 삭제한 후 참을 반환</li>
<li><em>해시셋에 <code>없는 키</code>면</em> 거짓을 반환</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HashSet&lt;int&gt; studentIDs &#x3D; new HashSet &lt;int&gt;(); &#x2F;&#x2F;&#123;123, 456&#125;</span><br><span class="line">bool bRemoved1 &#x3D; studentIDs.Remove(123); &#x2F;&#x2F;참</span><br><span class="line">bool bRemoved2 &#x3D; studentIDs.Remove(178); &#x2F;&#x2F;거짓</span><br></pre></td></tr></table></figure>
<h2 id="해시셋의-모든-요소-삭제"><a href="#해시셋의-모든-요소-삭제" class="headerlink" title="해시셋의 모든 요소 삭제"></a>해시셋의 모든 요소 삭제</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HastSet&lt;T&gt;.clear();</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HashSet&lt;int&gt; studentIDs &#x3D; new HashSet &lt;int&gt;(); &#x2F;&#x2F;&#123;123, 456&#125;</span><br><span class="line">studentID.Clear();</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="해시셋의-요소-가져오기"><a href="#해시셋의-요소-가져오기" class="headerlink" title="해시셋의 요소 가져오기"></a>해시셋의 요소 가져오기</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bool bSuccess &#x3D; HastSet&lt;T&gt;.TryGetValue(T Key, out T key);</span><br></pre></td></tr></table></figure>
<ul>
<li><em>해시셋에 <code>있는 키</code>면</em> 요소를 키에 연결된 요소를 out 매개변수에 대압하고 참을 반환</li>
<li><em>해시셋에 <code>없는 키</code>면</em> 거짓을 반환</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HashSet&lt;int&gt; studentIDs &#x3D; new HashSet &lt;int&gt;(); &#x2F;&#x2F;&#123;123, 456&#125;</span><br><span class="line">int id;</span><br><span class="line">bool bSuccess &#x3D; studentIDs.TryGetValue(456, out iff)</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="컬렉션과-같이-쓰면-유용한-것들"><a href="#컬렉션과-같이-쓰면-유용한-것들" class="headerlink" title="컬렉션과 같이 쓰면 유용한 것들"></a>컬렉션과 같이 쓰면 유용한 것들</h2><p>리스트를 예로 들어, 순차적으로 요소를 탐색할 때 i가 왜 필요한지에 대한 의문이 생긴다. 또 부등호를 잘못 쓰는 것처럼 실수할 가능성도 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;string&gt; names &#x3D; new List&lt;string&gt;(5);</span><br><span class="line"></span><br><span class="line">for (int i &#x3D; 0; i &lt; names.Count; ++i)</span><br><span class="line">&#123;</span><br><span class="line">  Console.WriteLine($&quot;Name: &#123;names[i]&#125;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h3><p>어떤 컬렉션이든 순회할 수 있는 방법이 있으면서 실수를 방지하는 좋은 방법이 바로 <code>foreach</code>이다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foreach (T&lt;변수명&gt; in List&lt;T&gt;)</span><br></pre></td></tr></table></figure>
<ul>
<li>foreach 문 안의 T는 리스트 선안할 때 사용한 자료형이다.</li>
<li>&lt;변수명&gt;은 foreach 문 범위에서만 사용된다.</li>
</ul>
<h3 id="리스트와-foreach문"><a href="#리스트와-foreach문" class="headerlink" title="리스트와 foreach문"></a>리스트와 foreach문</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;string&gt; names &#x3D; new List&lt;string&gt;(4096);</span><br><span class="line"></span><br><span class="line">foreach (string name in names)</span><br><span class="line">&#123;</span><br><span class="line">  Console.WriteLine(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="딕셔너리와-foreach문"><a href="#딕셔너리와-foreach문" class="headerlink" title="딕셔너리와 foreach문"></a>딕셔너리와 foreach문</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">foreach (KeyValuePair&lt;TKey, TValue&gt; &lt;변수명&gt; in Dictionary&lt;TKey, TValue&gt;)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>KeyValuePair<TKey, TValue>의 TKey, TValue는 각각 딕셔너리를 선언할 때 사용한 키와 값의 자료형이다.</li>
<li>&lt;변수명&gt;은 foreach 문 범위에서만 사용된다.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Dictionary&lt;string, string&gt; students &#x3D; new Dictionary&lt;string, string&gt;();</span><br><span class="line"></span><br><span class="line">foreach (KeyValuePair&lt;string, string&gt; score in students)</span><br><span class="line">&#123;</span><br><span class="line">  Console.WrtieLine($&quot;key: &#123;score.key&#125;, value: &#123;score.Value&#125;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="배열-과-foreach문"><a href="#배열-과-foreach문" class="headerlink" title="배열([])과 foreach문"></a>배열([])과 foreach문</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foreach (T &lt;변수명&gt; in T[])</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">float scores &#x3D; &#123;30.5f, 41.0f&#125;</span><br><span class="line"></span><br><span class="line">foreach (float score in scores)</span><br><span class="line">&#123;</span><br><span class="line">  Console.WriteLine(score);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="var"><a href="#var" class="headerlink" title="var"></a>var</h3><p>딕셔너리 foreach문이 작성해야하는 코드가 길고, 매번 keyValuePair<TKey, TValue>를 써야한다는 문제점을 var가 해결해준다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Dictionary&lt;string, string&gt; students &#x3D; new Dictionary&lt;string, string&gt;();</span><br><span class="line"></span><br><span class="line">foreach (var score in students)</span><br><span class="line">&#123;</span><br><span class="line">  Console.WriteLine($&quot;Key: &#123;score.key&#125;, value: &#123;score.value&#125;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>묵시적 자료형 : 컴파일러가 알아서 자료형을 추론해줌.</li>
<li><strong>지역 변수</strong>에서만 사용 가능.</li>
<li>긴 자료형을 짧게 줄여준다.</li>
<li><strong>반드시 선언과 동시에 대입해주어야 한다.</strong></li>
<li>대입하는 값을 통해 명백하게 자료형을 알 수 있을 때만 사용한다.</li>
</ul>
<hr>
<p><em>References</em><br><a href="https://www.udemy.com/share/101tfkAEYTcVxXTXQJ/" target="_blank" rel="noopener">실무 프로그래밍 입문(C#)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://heejinlee07.github.io/2021/07/19/210720_oop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Heejin Lee">
      <meta itemprop="description" content="Today I Learned">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heejin">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/19/210720_oop/" class="post-title-link" itemprop="url">개체지향 프로그래밍 (Object Oriented Programming)</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-20 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-20T00:00:00+09:00">2021-07-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-07-06 10:57:52" itemprop="dateModified" datetime="2022-07-06T10:57:52+09:00">2022-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="절차적-언어의-아쉬운-점"><a href="#절차적-언어의-아쉬운-점" class="headerlink" title="절차적 언어의 아쉬운 점"></a>절차적 언어의 아쉬운 점</h2><ul>
<li>하나의 속성으로 뭉쳐야 할 데이터가 분산되어 각 배열로 관리되게 된다. 예를 들어 <em>몸무게, 키</em>의 속성을 가지는 사람 A, B의 데이터를 관리한다고 할 때, 각각의 속성들이 A라는 사람의 몸무게, 키, B라는 사람의 몸무게, 키로 관리되지 않고, 각각 사람이름 배열, 몸무게 배열, 키 배열로 분산되어 관리된다.</li>
<li>그렇기 때문에 데이터가 많아지면 관리가 힘들어지고, 실수할 가능성이 높아진다.</li>
</ul>
<h2 id="절차적-언어에-대한-보완점"><a href="#절차적-언어에-대한-보완점" class="headerlink" title="절차적 언어에 대한 보완점"></a>절차적 언어에 대한 보완점</h2><p><u>구조체: 데이터를 그룹으로 묶는다.</u></p>
<ul>
<li>그룹을 마치 하나의 변수처럼 사용한다.</li>
<li>생성과 동시에 그룹 안의 모든 데이터는 초기화된다.</li>
<li>기계가 이해하는 데이터 형태는 아니다.</li>
<li>컴파일러가 알아서 그룹 내의 변수를 선언하는 느낌이다.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;c 언어의 의사 코드</span><br><span class="line">struct Human</span><br><span class="line">&#123;</span><br><span class="line">  int age;</span><br><span class="line">  float height;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;함수 어딘가</span><br><span class="line">Human human;</span><br><span class="line">Human.age &#x3D; 10;</span><br><span class="line">Human.height &#x3D; 170.0f;</span><br></pre></td></tr></table></figure>
<h3 id="절차적-언어-struct-의-한계"><a href="#절차적-언어-struct-의-한계" class="headerlink" title="절차적 언어(struct)의 한계"></a>절차적 언어(struct)의 한계</h3><ul>
<li>여전히 데이터와 동작이 분리되어 있다.</li>
<li>함수와 구조체가 여러 개 있다면 어떤 구조체가 어떤 함수와 연관있는지 찾기 귀찮다.</li>
</ul>
<p><em><u>그렇다면 함수도 하나로 그룹화 하면 되지 않을까?</u></em></p>
<hr>
<h2 id="클래스"><a href="#클래스" class="headerlink" title="클래스"></a>클래스</h2><blockquote>
<p>커스텀하게 만드는 자료형</p>
</blockquote>
<h3 id="1-클래스-만들기"><a href="#1-클래스-만들기" class="headerlink" title="1. 클래스 만들기"></a>1. 클래스 만들기</h3><ul>
<li>이미 있는 자료형이 아니다.</li>
<li>Car라고 하는 새로운 자료형을 직접 만든 것이다.</li>
<li><strong>보통 <code>Car.cs</code>처럼 클래스명을 파일명으로 하고, 별도의 cs파일을 만들어서 클래스를 생성한다.</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Car</span><br><span class="line">&#123;</span><br><span class="line">  &#x2F;&#x2F;Car라는 데이터 타입의 정의</span><br><span class="line">  public int Price;</span><br><span class="line">  public float Gas;</span><br><span class="line">  public string Owner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Price, Gas, Owner</em>와 같이 중괄호 안에 작성된 것을 <code>멤버 변수</code>라 한다. 멤버 변수는 클래스 안에서 자유롭게 사용 가능하다. 멤버 변수는 초기화가 되고, 기본값이 0이다. 참조형(string)의 기본값은 null이다.</p>
<h3 id="2-개체-만들기"><a href="#2-개체-만들기" class="headerlink" title="2. 개체 만들기"></a>2. 개체 만들기</h3><p>클래스를 사용한다는 것은 클래스를 데이터형으로 사용해서 그 데이터형의 변수를 만들 수 있다는 의미이다. <strong>즉 개체를 만든다는 의미이다.</strong></p>
<blockquote>
<p>&lt;클래스 이름&gt; &lt;변수명&gt; = new &lt;클래스 이름&gt;();</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;메인함수</span><br><span class="line">&#x2F;&#x2F;Program.cs</span><br><span class="line">Car car &#x3D; new Car();</span><br></pre></td></tr></table></figure>
<ul>
<li>새로운 &lt;클래스 이름&gt;형의 데이터를 만든다.</li>
<li><code>클래스로 정의된 형에 맞는 구체적인 데이터를 개체라고 한다.</code></li>
<li><strong>C#에서는 new를 통해서만 개체를 만들 수 있다.</strong></li>
</ul>
<h3 id="3-개체의-멤버에-접근하기"><a href="#3-개체의-멤버에-접근하기" class="headerlink" title="3. 개체의 멤버에 접근하기"></a>3. 개체의 멤버에 접근하기</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;메인함수</span><br><span class="line">&#x2F;&#x2F;Program.cs</span><br><span class="line">Car car &#x3D; new Car();</span><br><span class="line">car.Owner &#x3D; &quot;Alex&quot;;</span><br><span class="line">car.Price &#x3D; 2000;</span><br><span class="line">car.Gas &#x3D; 60.0f;</span><br></pre></td></tr></table></figure>
<p>여기에 동작(함수)를 추가해야 한다.</p>
<h3 id="4-메서드-동작-함수-추가"><a href="#4-메서드-동작-함수-추가" class="headerlink" title="4. 메서드 - 동작(함수) 추가"></a>4. 메서드 - 동작(함수) 추가</h3><blockquote>
<p>메서드(맴버 함수)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class Car</span><br><span class="line">&#123;</span><br><span class="line">  public int Price;</span><br><span class="line">  public float Gas;</span><br><span class="line">  public string Owner;</span><br><span class="line"></span><br><span class="line">  public void Move()</span><br><span class="line">  &#123;</span><br><span class="line">    Gas -&#x3D; 0.5f;</span><br><span class="line">    Console.WriteLine($&quot;Move! \n (Gas: &#123;Gas&#125;L left)&quot;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public void Honk()</span><br><span class="line">  &#123;</span><br><span class="line">    Console.WriteLine(&quot;honk&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>메서드는 개체의 행위들을 말한다.</strong></li>
<li>클래스 안에서 선언한 함수</li>
<li>클래스 안에서 자유롭게 사용할 수 있고, 같은 클래스의 멤버 변수에 접근 가능하다.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;메인함수</span><br><span class="line">&#x2F;&#x2F;Program.cs</span><br><span class="line">Car car &#x3D; new Car();</span><br><span class="line">car.Owner &#x3D; &quot;Alex&quot;;</span><br><span class="line">car.Price &#x3D; 2000;</span><br><span class="line">car.Gas &#x3D; 60.0f;</span><br><span class="line"></span><br><span class="line">myCar.Move();</span><br><span class="line">myCar.Honk();</span><br></pre></td></tr></table></figure>
<hr>
<p>클래스 생성 후 다음과 같은 경우 문제가 생길 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;메인 함수</span><br><span class="line">&#x2F;&#x2F;Program.cs</span><br><span class="line">Car car &#x3D; new Car();</span><br><span class="line">car.Gas &#x3D; 50.0f;</span><br><span class="line"></span><br><span class="line">Console.WriteLine($&quot;Price is &#123;car.Price&#125;&quot;);</span><br></pre></td></tr></table></figure>
<p>여기서 출력결과는 <code>Price is 0</code>이다. Price가 0이 나온 이유는 개체 생성 후 깜빡하고 데이터를 대입하지 않았기 때문이다. <em>이처럼 개체 생성 후 깜빡하고 데이터를 대입 안 할 경우 에기치 못한 문제가 발생할 수 있다.</em></p>
<p><u>생성자를 쓰면 이러한 문제를 해결할 수 있다.</u></p>
<h2 id="생성자"><a href="#생성자" class="headerlink" title="생성자"></a>생성자</h2><blockquote>
<p>개체가 만들어질 때 자동으로 호출되는 특정한 함수</p>
<blockquote>
<p>public &lt;클래스명&gt; (&lt;매개변수 리스트&gt;) {}</p>
</blockquote>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Car.cs</span><br><span class="line">public class Car</span><br><span class="line">&#123;</span><br><span class="line">  public Car(int price)</span><br><span class="line">  &#123;</span><br><span class="line">    Price &#x3D; price;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;Program.cs</span><br><span class="line">Car car1 &#x3D; new Car(200); &#x2F;&#x2F;ok</span><br><span class="line">Car car2 &#x3D; new Car() &#x2F;&#x2F;컴파일 오류</span><br></pre></td></tr></table></figure>
<ul>
<li>생성자 개체를 생성할 때(new) 반드시 호출되는 함수</li>
<li><code>함수명으로 클래스명을 쓴다.</code></li>
<li>반환형은 아예 적지 않는다.</li>
<li>생성에 필요한 매개변수를 강제할 수 있다.</li>
<li>생성자는 여러 개를 써도 된다.</li>
</ul>
<p><u>하지만 생성자를 써도 문제가 발생할 수 있다.</u><br>클래스에 있는 모든 개체가 특정한 동일한 값을 가져야 하는 경우가 있을 수 있다. 예시처럼 Car의 첫 가격이 항상 2000이어야 하는 경우. 아래 코드를 보면 모든 차의 가격이 2000이어야 하는데, 개발자가 실수로 20을 입력한다면 car3의 가격은 20이 된다. 즉 예기치 못한 결과를 얻게 된다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Car</span><br><span class="line">&#123;</span><br><span class="line">  public Car(int price)</span><br><span class="line">  &#123;</span><br><span class="line">    Price &#x3D; price;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Car car1 &#x3D; new Car(2000);</span><br><span class="line">Car car2 &#x3D; new Car(2000);</span><br><span class="line">Car car3 &#x3D; new Car(20);</span><br></pre></td></tr></table></figure>
<h3 id="생성자-안에서-상수를-바로-대입"><a href="#생성자-안에서-상수를-바로-대입" class="headerlink" title="생성자 안에서 상수를 바로 대입"></a>생성자 안에서 상수를 바로 대입</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class Car</span><br><span class="line">&#123;</span><br><span class="line">  public int Price;</span><br><span class="line">  &#x2F;&#x2F;...</span><br><span class="line"></span><br><span class="line">  public Car(int price)</span><br><span class="line">  &#123;</span><br><span class="line">    Price &#x3D; 500000;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;Program.cs</span><br><span class="line">Car car1 &#x3D; new Car();</span><br><span class="line">Car car2 &#x3D; new Car();</span><br><span class="line">Car car3 &#x3D; new Car();</span><br></pre></td></tr></table></figure>
<p>만약 생성자를 만들지 않았다면 기본적인 생성자는 있다고 가정한다. 따라서 car1, car2, car3의 값은 0이다. 이처럼 생성자를 만들지 않았다면 new Car()로 사용할 수 있고, 중간에 <code>Car(int price)</code>와 같은 값을 넣었다면 컴파일이 되지 않는다. 즉 생성자에 어떠한 값을 넣기 시작하면 기본 설정한 생성자는 사라져버린다.</p>
<p>위 방법보다 조금 더 나은 방법은 애초에 Car 클래스에서 개체를 만들 때 5000을 넣어준다. 이렇게 하면 생성자를 만들지 않아도 컴파일 에러가 나지 않고, 모든 Car의 Price는 5000이다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public class Car</span><br><span class="line">&#123;</span><br><span class="line">  public int Price &#x3D; 5000;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><em>References</em><br><a href="https://www.udemy.com/share/101tfkAEYTcVxXTXQJ/" target="_blank" rel="noopener">실무 프로그래밍 입문(C#)</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Heejin Lee</p>
  <div class="site-description" itemprop="description">Today I Learned</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">131</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Heejin Lee</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.1
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.1
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
